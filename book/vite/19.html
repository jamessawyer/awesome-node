<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>系统对Vite项目进行性能优化 | Awesome Node</title>
    <meta name="description" content="Node + Vite + Webpack + Babel">
    <link rel="preload stylesheet" href="/awesome-node/assets/style.7aaf77d9.css" as="style">
    <script type="module" src="/awesome-node/assets/app.6585a414.js"></script>
    <link rel="preload" href="/awesome-node/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/awesome-node/assets/chunks/framework.7812daa2.js">
  <link rel="modulepreload" href="/awesome-node/assets/chunks/theme.f0f59a04.js">
  <link rel="modulepreload" href="/awesome-node/assets/book_vite_19.md.899df01c.lean.js">
  <link rel="icon" href="/awesome-node/favicon.ico">
  <link rel="apple-touch-icon" href="/awesome-node/pwa-192x192.png" sizes="192x192">
  <meta name="keywords" content="Node, Vite, Webpack, Babel">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  <link rel="manifest" href="/awesome-node/manifest.webmanifest">
  <script id="vite-plugin-pwa:register-sw" src="/awesome-node/registerSW.js"></script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-49ea956c><!--[--><!--]--><!--[--><span tabindex="-1" data-v-2e416324></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-2e416324> Skip to content </a><!--]--><!----><header class="VPNav" data-v-49ea956c data-v-56b927fe><div class="VPNavBar has-sidebar" data-v-56b927fe data-v-d13d5f92><div class="container" data-v-d13d5f92><div class="title" data-v-d13d5f92><div class="VPNavBarTitle has-sidebar" data-v-d13d5f92 data-v-b63551fd><a class="title" href="/awesome-node/" data-v-b63551fd><!--[--><!--]--><!--[--><img class="VPImage logo" src="/awesome-node/logo.svg" alt data-v-85a9830b><!--]--><!--[-->Awesome Node<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-d13d5f92><div class="curtain" data-v-d13d5f92></div><div class="content-body" data-v-d13d5f92><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-d13d5f92 data-v-29f8f6a7><span id="main-nav-aria-label" class="visually-hidden" data-v-29f8f6a7>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/v18doc/File-System.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->📄Node文档<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/manager/basic.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->📦工程化<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/core/stream/index.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->💫核心概念<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/blog/first.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->🤔blog<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-29f8f6a7 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-508c46e6><span class="text" data-v-508c46e6><!----> 📚书籍 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-508c46e6><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><div class="items" data-v-a8e5986e><!--[--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/patterns/the-node-platform.html" data-v-4542e1b5 data-v-01095d06><!--[-->Node Design Patterns<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/vite/2.html" data-v-4542e1b5 data-v-01095d06><!--[-->深入理解Vite<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/webpack/1.html" data-v-4542e1b5 data-v-01095d06><!--[-->Webpack5核心原理<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/babel/2.html" data-v-4542e1b5 data-v-01095d06><!--[-->Babel插件秘籍<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-29f8f6a7 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-508c46e6><span class="text" data-v-508c46e6><!----> 🧑‍🚀框架 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-508c46e6><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><div class="items" data-v-a8e5986e><!--[--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/framework/nestjs/index.html" data-v-4542e1b5 data-v-01095d06><!--[-->NestJS<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/framework/express/index.html" data-v-4542e1b5 data-v-01095d06><!--[-->Express<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-29f8f6a7 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-508c46e6><span class="text" data-v-508c46e6><!----> 🔥常用库 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-508c46e6><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><div class="items" data-v-a8e5986e><!--[--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/lib/fs-extra/index.html" data-v-4542e1b5 data-v-01095d06><!--[-->fs-extra<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-d13d5f92 data-v-11927c9d><label title="toggle dark mode" data-v-11927c9d data-v-25ab53b0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-25ab53b0 data-v-785f9bd9><span class="check" data-v-785f9bd9><span class="icon" data-v-785f9bd9><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-25ab53b0><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-25ab53b0><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-d13d5f92 data-v-eae5c608 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-508c46e6><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-508c46e6><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><!----><!--[--><!--[--><!----><div class="group" data-v-eae5c608><div class="item appearance" data-v-eae5c608><p class="label" data-v-eae5c608>Appearance</p><div class="appearance-action" data-v-eae5c608><label title="toggle dark mode" data-v-eae5c608 data-v-25ab53b0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-25ab53b0 data-v-785f9bd9><span class="check" data-v-785f9bd9><span class="icon" data-v-785f9bd9><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-25ab53b0><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-25ab53b0><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-d13d5f92 data-v-f545931e><span class="container" data-v-f545931e><span class="top" data-v-f545931e></span><span class="middle" data-v-f545931e></span><span class="bottom" data-v-f545931e></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-49ea956c data-v-1e6acb7f><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-1e6acb7f><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-1e6acb7f><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-1e6acb7f>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-1e6acb7f data-v-8340454f><button data-v-8340454f>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-49ea956c data-v-3fbbbda7><div class="curtain" data-v-3fbbbda7></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-3fbbbda7><span class="visually-hidden" id="sidebar-aria-label" data-v-3fbbbda7> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-3fbbbda7><section class="VPSidebarItem level-0 has-active" data-v-3fbbbda7 data-v-a486264d><div class="item" role="button" tabindex="0" data-v-a486264d><div class="indicator" data-v-a486264d></div><h2 class="text" data-v-a486264d>🔧深入理解Vite</h2><!----></div><div class="items" data-v-a486264d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/1.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>1.Vite开篇</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/2.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>2.模块标准</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/3.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>3.快速上手Vite</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/4.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>4.样式方案</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/7.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>7.预构建</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/8.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>8.双引擎架构</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/9.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>9.性能推手: Esbuild</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/10.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>10.Rollup基本用法</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/11.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>11.深入理解Rollup插件机制</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/12.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>12.Vite插件开发</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/14.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>14.代码分割</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/15.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>15.Polyfill和语法降级</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/16.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>16.Vite搭建SSR工程</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/17.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>17.联邦模块以及原理</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/18.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>18.Pure ESM时代</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/book/vite/19.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>19.系统对Vite项目性能优化</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-49ea956c data-v-227c3700><div class="VPDoc has-sidebar has-aside" data-v-227c3700 data-v-e08fe318><!--[--><!--]--><div class="container" data-v-e08fe318><div class="aside" data-v-e08fe318><div class="aside-curtain" data-v-e08fe318></div><div class="aside-container" data-v-e08fe318><div class="aside-content" data-v-e08fe318><div class="VPDocAside" data-v-e08fe318 data-v-d53a0c94><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-d53a0c94 data-v-f8cf7442><div class="content" data-v-f8cf7442><div class="outline-marker" data-v-f8cf7442></div><div class="outline-title" data-v-f8cf7442>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-f8cf7442><span class="visually-hidden" id="doc-outline-aria-label" data-v-f8cf7442> Table of Contents for current page </span><ul class="root" data-v-f8cf7442 data-v-f8a0804d><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-d53a0c94></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e08fe318><div class="content-container" data-v-e08fe318><!--[--><!--]--><!----><main class="main" data-v-e08fe318><div style="position:relative;" class="vp-doc _awesome-node_book_vite_19" data-v-e08fe318><div><p>性能优化是前端工程化中老生常谈的话题，随着项目越来越庞大，稍不注意就会产生明显的性能问题。而在不同的场景中，我们对于项目性能的关注点是不一样的。在项目开发阶段，我们更关注<strong>开发体验</strong>，注重项目构建性能；而在生产环境中，我们一般更看重项目在的线上<strong>运行时性能</strong>。关于开发阶段的构建性能问题，Vite 内部已经做了相当多的优化，实现了项目秒级启动与毫秒级热更新，这部分的具体实现就不属于本文讨论的范畴了，我们会在小册的「源码精读篇」来展开分析。本文所介绍的性能优化主要指线上环境的项目加载性能优化，与页面的 FCP、TTI 这些指标息息相关。</p><p>对于项目的加载性能优化而言，常见的优化手段可以分为下面三类:</p><ol><li><strong>网络优化</strong>。包括 <code>HTTP2</code>、<code>DNS 预解析</code>、<code>Preload</code>、<code>Prefetch</code>等手段</li><li><strong>资源优化</strong>。包括<code>构建产物分析</code>、<code>资源压缩</code>、<code>产物拆包</code>、<code>按需加载</code>等优化方式</li><li><strong>预渲染优化</strong>，本文主要介绍<code>服务端渲染</code>(SSR)和<code>静态站点生成</code>(SSG)两种手段</li></ol><p>而无论是以上哪一类优化方式，都离不开构建工具的支持，也就是说，在这些性能优化的场景中，我们将高频地使用到 Vite，对 Vite 本身的构建能力进行深度地应用或者定制。那么，在接下来的内容中，我们将按照如上的三个部分来分别介绍 Vite 的性能优化知识，并进行代码实操。当然，在之前的章节中，我们已经对于其中的部分优化手段进行了详细地拆解，因此，这一节的内容你既可以当做 Vite 知识点的查漏补缺，也可以作为之前小册内容的回顾和复盘。</p><h2 id="一、网络优化" tabindex="-1">一、网络优化 <a class="header-anchor" href="#一、网络优化" aria-label="Permalink to &quot;一、网络优化&quot;">​</a></h2><h3 id="_1-http2" tabindex="-1">1. HTTP2 <a class="header-anchor" href="#_1-http2" aria-label="Permalink to &quot;1. HTTP2&quot;">​</a></h3><p>传统的 <code>HTTP 1.1</code> 存在<strong>队头阻塞</strong>的问题，同一个 TCP 管道中同一时刻只能处理一个 HTTP 请求，也就是说如果当前请求没有处理完，其它的请求都处于阻塞状态，另外浏览器对于同一域名下的并发请求数量都有限制，比如 Chrome 中只允许 <code>6</code> 个请求并发（这个数量不允许用户配置），也就是说请求数量超过 6 个时，多出来的请求只能<strong>排队</strong>、等待发送。</p><p>因此，在 HTTP 1.1 协议中，<strong>队头阻塞</strong>和<strong>请求排队</strong>问题很容易成为网络层的性能瓶颈。而 <code>HTTP2</code> 的诞生就是为了解决这些问题，它主要实现了如下的能力：</p><ul><li><strong><code>多路复用</code></strong>。将数据分为多个二进制帧，多个请求和响应的数据帧在同一个 TCP 通道进行传输，解决了之前的队头阻塞问题。而与此同时，在 HTTP2 协议下，浏览器不再有同域名的并发请求数量限制，因此请求排队问题也得到了解决</li><li><strong><code>Server Push</code></strong>，即服务端推送能力。可以让某些资源能够提前到达浏览器，比如对于一个 html 的请求，通过 HTTP2 我们可以同时将相应的 js 和 css 资源推送到浏览器，省去了后续请求的开销</li></ul><p>在 Vite 中，我们可以通过 <a href="https://github.com/liuweiGL/vite-plugin-mkcert/blob/HEAD/README-zh_CN.md" target="_blank" rel="noreferrer">vite-plugin-mkcert</a> 在本地 Dev Server 上开启 HTTP2:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vite-plugin-mkcert</span></span></code></pre></div><p>然后在 Vite 配置中进行使用:</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-EhSBR" id="tab-sQGAwz1" checked="checked"><label for="tab-sQGAwz1">vite.config.ts</label></div><div class="blocks"><div class="language-typescript active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">defineConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> react </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@vitejs/plugin-react</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> mkcert </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite-plugin-mkcert</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">defineConfig</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#82AAFF;">react</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">mkcert</span><span style="color:#A6ACCD;">()]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">server</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// https 选项需要开启</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">https</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div></div></div><p>插件的原理也比较简单，由于 HTTP2 依赖 TLS 握手，插件会帮你自动生成 TLS 证书，然后支持通过 HTTPS 的方式启动，而 Vite 会自动把 HTTPS 服务升级为 HTTP2。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>其中有一个特例，即当你使用 Vite 的 proxy 配置时，Vite 会将 HTTP2 降级为 HTTPS，不过这个问题你可以通过<a href="https://github.com/williamyorkl/vite-plugin-proxy-middleware" target="_blank" rel="noreferrer">vite-plugin-proxy-middleware</a>插件解决。</p></div><p>使用上 HTTP2 之后，在某些情况下大量并行请求的问题会得到明显的改善，这里有一个多请求的示例项目，我已经放到了小册的<a href="https://github.com/sanyuan0704/juejin-book-vite/tree/main/19-performace/multi-request" target="_blank" rel="noreferrer">Github 仓库</a>中，在仓库中执行:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">generate</span></span></code></pre></div><p>即可生成 <code>100</code> 个 jsx 文件，我们在弱网环境下测试，这样对比的效果更加明显，实际情况如下:</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>由于某些预编译后的依赖体积比较大(如 react-dom)，为了避免影响测试的准确性，这里我们在二次刷新的情况下测试，此时预编译产物会被强缓存。</p></div><p><img src="/awesome-node/assets/19-1.ca6abaa4.webp" alt="http1.1 vs http2"></p><p>以页面首屏绘制的时间(FCP)来看，在开启了 HTTP2 之后，页面性能可以优化 60% 以上。而反观 HTTP 1.1 下的表现，不难发现大部分的时间开销用用在了请求排队上面，在并发请求很多的情况下性能直线下降。</p><p>因此，对于线上的项目来说，HTTP2 对性能的提升非常可观，几乎成为了一个必选项。而刚刚演示用到的 <code>vite-plugin-mkcert</code>插件仅用于开发阶段，在生产环境中我们会对线上的服务器进行配置，从而开启 HTTP2 的能力，如 <a href="http://nginx.org/en/docs/http/ngx_http_v2_module.html" target="_blank" rel="noreferrer">Nginx 的 HTTP2 配置</a>，关于具体的运维细节，不属于本文重点，就不再展开介绍了。</p><h3 id="_2-dns-预解析" tabindex="-1">2. DNS 预解析 <a class="header-anchor" href="#_2-dns-预解析" aria-label="Permalink to &quot;2. DNS 预解析&quot;">​</a></h3><p>浏览器在向跨域的服务器发送请求时，首先会进行 DNS 解析，将服务器域名解析为对应的 IP 地址。我们通过 <code>dns-prefetch</code> 技术将这一过程提前，降低 DNS 解析的延迟时间，具体使用方式如下:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- href 为需要预解析的域名 --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">link</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">rel</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dns-prefetch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://fonts.googleapis.com/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>一般情况下 <code>dns-prefetch</code>会与<code>preconnect</code> 搭配使用，前者用来解析 DNS，而后者用来会建立与服务器的连接，建立 TCP 通道及进行 TLS 握手，进一步降低请求延迟。使用方式如下所示:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">link</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">rel</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">preconnect</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://fonts.gstatic.com/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">crossorigin</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">link</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">rel</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dns-prefetch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://fonts.gstatic.com/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>值得注意的是，对于 preconnect 的 link 标签一般需要加上 crorssorigin(跨域标识)，否则对于一些字体资源 <code>preconnect</code> 会失效。</p></div><h3 id="_3-preload-prefetch" tabindex="-1">3. Preload/Prefetch <a class="header-anchor" href="#_3-preload-prefetch" aria-label="Permalink to &quot;3. Preload/Prefetch&quot;">​</a></h3><p>对于一些比较重要的资源，我们可以通过 <code>Preload</code> 方式进行预加载，即在资源使用之前就进行加载，而不是在用到的时候才进行加载，这样可以使资源更早地到达浏览器。具体使用方式如下:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">link</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">rel</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">preload</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">style.css</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">as</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">style</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">link</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">rel</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">preload</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">main.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">as</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>其中我们一般会声明 <code>href</code> 和 <code>as</code> 属性，分别表示资源地址和资源类型。<code>Preload</code>的浏览器<a href="https://caniuse.com/?search=preload" target="_blank" rel="noreferrer">兼容性</a>也比较好，目前 90% 以上的浏览器已经支持:</p><p><img src="/awesome-node/assets/19-2.f79c4ae7.webp" alt="preload"></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>关于更多 Preload 的资源类型大家可以查阅 <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload" target="_blank" rel="noreferrer">MDN 文档</a>。</p></div><p>💡与普通 script 标签不同的是，对于原生 ESM 模块，浏览器提供了<code>modulepreload</code>来进行预加载:</p><p><img src="/awesome-node/assets/19-3.19d01128.webp" alt="modulepreload"></p><p>仅有 70% 左右的浏览器支持这个特性，不过在 Vite 中我们可以通过配置一键开启 <code>modulepreload</code> 的 Polyfill，从而在使所有支持原生 ESM 的浏览器(<a href="https://caniuse.com/?search=type%3D%22%20module%22" target="_blank" rel="noreferrer">占比 90% 以上</a>)都能使用该特性，配置方式如下: <a href="https://cn.vitejs.dev/config/build-options.html#build-modulepreload" target="_blank" rel="noreferrer">vite - build#modulepreload</a></p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-W_yz8" id="tab-oXMbCS2" checked="checked"><label for="tab-oXMbCS2">index.ts</label></div><div class="blocks"><div class="language-typescript active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 入口文件使用</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite/modulepreload-polyfill</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div></div></div><details class="details custom-block"><summary>上面是vite4.0+新版本的配置方式，老版本方式如下</summary><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite.config.ts</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">polyfillModulePreload</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></details><p>除了 <code>Preload</code>，<code>Prefetch</code> 也是一个比较常用的优化方式，它相当于告诉浏览器空闲的时候去预加载其它页面的资源，比如对于 A 页面中插入了这样的 <code>link</code> 标签:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">link</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">rel</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">prefetch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://B.com/index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">as</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>这样浏览器会在 A 页面加载完毕之后去加载<code>B</code>这个域名下的资源，如果用户跳转到了<code>B</code>页面中，浏览器会直接使用预加载好的资源，从而提升 B 页面的加载速度。而相比 Preload， <code>Prefetch</code> 的浏览器<a href="https://caniuse.com/?search=prefetch" target="_blank" rel="noreferrer">兼容性</a>不太乐观，具体数据如下图所示:</p><p><img src="/awesome-node/assets/19-4.ae830816.webp" alt="prefetch"></p><h2 id="二、资源优化" tabindex="-1">二、资源优化 <a class="header-anchor" href="#二、资源优化" aria-label="Permalink to &quot;二、资源优化&quot;">​</a></h2><h3 id="_1-产物分析报告" tabindex="-1">1. 产物分析报告 <a class="header-anchor" href="#_1-产物分析报告" aria-label="Permalink to &quot;1. 产物分析报告&quot;">​</a></h3><p>为了能可视化地感知到产物的体积情况，推荐大家用 <a href="https://github.com/btd/rollup-plugin-visualizer" target="_blank" rel="noreferrer">rollup-plugin-visualizer</a> 来进行产物分析。使用方式如下:</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-u7fte" id="tab-4lZg6r7" checked="checked"><label for="tab-4lZg6r7">vite.config.ts</label></div><div class="blocks"><div class="language-typescript active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 注: 首先需要安装 rollup-plugin-visualizer 依赖</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">defineConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> react </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@vitejs/plugin-react</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">visualizer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">rollup-plugin-visualizer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// https://vitejs.dev/config/</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">defineConfig</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">react</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">visualizer</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 打包完成后自动打开浏览器，显示产物体积报告</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">open</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div></div></div><p>当你执行<code>pnpm run build</code>之后，浏览器会自动打开产物分析页面:</p><p><img src="/awesome-node/assets/19-5.e7adc33d.webp" alt="rollup-plugin-visualizer"></p><p>从中你可以很方便地观察到产物体积的分布情况，提高排查问题的效率，比如定位到体积某些过大的包，然后针对性地进行优化。</p><h3 id="_2-资源压缩" tabindex="-1">2. 资源压缩 <a class="header-anchor" href="#_2-资源压缩" aria-label="Permalink to &quot;2. 资源压缩&quot;">​</a></h3><p>在生产环境中，为了极致的代码体积，我们一般会通过构建工具来对产物进行压缩。具体来说，有这样几类资源可以被压缩处理: <code>JavaScript 代码</code>、<code>CSS 代码</code>和<code>图片文件</code>。</p><h4 id="javascript-压缩" tabindex="-1">JavaScript 压缩 <a class="header-anchor" href="#javascript-压缩" aria-label="Permalink to &quot;JavaScript 压缩&quot;">​</a></h4><p>在 Vite 生产环境构建的过程中，JavaScript 产物代码会自动进行压缩，相关的配置参数如下:</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-kXF0l" id="tab-D7a5Rrz" checked="checked"><label for="tab-D7a5Rrz">vite.config.ts</label></div><div class="blocks"><div class="language-typescript active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 类型: boolean | &#39;esbuild&#39; | &#39;terser&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 默认为 `esbuild`</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minify</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">esbuild</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 产物目标环境</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">target</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">modules</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 如果 minify 为 terser，可以通过下面的参数配置具体行为</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// https://terser.org/docs/api-reference#minify-options</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">terserOptions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><p>值得注意的是 <a href="https://cn.vitejs.dev/config/build-options.html#build-target" target="_blank" rel="noreferrer">target</a> 参数，也就是压缩产物的目标环境。Vite 默认的参数是<code>modules</code>，即如下的 browserlist:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite4.0+</span></span>
<span class="line"><span style="color:#A6ACCD;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">es2020</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">edge88</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">firefox78</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">chrome87</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">safari14</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span></code></pre></div><p>可能你会有疑问，既然是压缩代码，为什么还跟目标环境有关系呢？</p><p>其实，对于 JS 代码压缩的理解仅仅停留在去除空行、混淆变量名的层面是不够的，为了达到极致的压缩效果，压缩器一般会根据浏览器的目标，会对代码进行语法层面的转换，比如下面这个例子:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 业务代码中</span></span>
<span class="line"><span style="color:#A6ACCD;">info </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">undefined</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span></span></code></pre></div><p>如果你将 <code>target</code> 配置为<code>exnext</code>，也就是最新的 JS 语法，会发现压缩后的代码变成了下面这样:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">info</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">name</span></span></code></pre></div><p>这就是压缩工具在背后所做的事情，将某些语句识别之后转换成更高级的语法，从而达到更优的代码体积。</p><p>因此，设置合适的 <code>target</code> 就显得特别重要了，一旦目标环境的设置不能覆盖所有的用户群体，那么极有可能在某些低端浏览器中出现语法不兼容问题，从而发生<strong>线上事故</strong>。</p><p>笔者曾在生产环境中就见过这种情况，由于 Vite 默认的 target 无法覆盖所有支持原生 ESM 的浏览器，经过压缩器的语法转换后，在某些 iOS 机型(iOS 11.2)上出现白屏事故，最后通过指定 target 为 <code>es2015</code> 或者<code>es6</code> 解决了这个问题。</p><p>因此，为了线上的稳定性，推荐大家最好还是将 target 参数设置为<code>ECMA</code>语法的最低版本<code>es2015</code>/<code>es6</code>。</p><h4 id="css-压缩" tabindex="-1">CSS 压缩 <a class="header-anchor" href="#css-压缩" aria-label="Permalink to &quot;CSS 压缩&quot;">​</a></h4><p>对于 CSS 代码的压缩，Vite 中的相关配置如下:</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-98-u3" id="tab-zGoUa30" checked="checked"><label for="tab-zGoUa30">vite.config.ts</label></div><div class="blocks"><div class="language-typescript active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 设置 CSS 的目标环境</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">cssTarget</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><p>默认情况下 Vite 会使用 Esbuild 对 CSS 代码进行压缩，一般不需要我们对 <code>cssTarget</code> 进行配置。</p><p>不过在需要兼容安卓端微信的 webview 时，我们需要将 <a href="https://cn.vitejs.dev/config/build-options.html#build-csstarget" target="_blank" rel="noreferrer">build.cssTarget</a> 设置为 <code>chrome61</code>，以防止 vite 将 <code>rgba()</code> 颜色转化为 <code>#RGBA</code> 十六进制符号的形式，出现样式问题。</p><h4 id="图片压缩" tabindex="-1">图片压缩 <a class="header-anchor" href="#图片压缩" aria-label="Permalink to &quot;图片压缩&quot;">​</a></h4><p>图片资源是一般是产物体积的大头，如果能有效地压缩图片体积，那么对项目体积来说会得到不小的优化。而在 Vite 中我们一般使用 <code>vite-plugin-imagemin</code>来进行图片压缩，你可以去 <a href="https://juejin.cn/book/7050063811973218341/section/7058854154738860066" target="_blank" rel="noreferrer">静态资源小节</a> 查看使用方式和效果。</p><h3 id="_3-产物拆包" tabindex="-1">3. 产物拆包 <a class="header-anchor" href="#_3-产物拆包" aria-label="Permalink to &quot;3. 产物拆包&quot;">​</a></h3><p>一般来说，如果不对产物进行<code>代码分割</code>(或者<code>拆包</code>)，全部打包到一个 chunk 中，会产生如下的问题:</p><ol><li>首屏加载的代码体积过大，即使是当前页面不需要的代码也会进行加载。</li><li>线上<strong>缓存复用率</strong>极低，改动一行代码即可导致整个 bundle 产物缓存失效。</li></ol><p>而 Vite 中内置如下的代码拆包能力:</p><ol><li>CSS 代码分割，即实现一个 chunk 对应一个 css 文件。</li><li>默认有一套拆包策略，将应用的代码和第三方库的代码分别打包成两份产物，并对于动态 import 的模块单独打包成一个 chunk。</li></ol><p>当然，我们也可以通过 <a href="https://rollupjs.org/configuration-options/#output-manualchunks" target="_blank" rel="noreferrer">manualChunks</a> 参数进行自定义配置：</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-BQbtO" id="tab-JjEFSoJ" checked="checked"><label for="tab-JjEFSoJ">vite.config.ts</label></div><div class="blocks"><div class="language-typescript active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">rollupOptions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 1. 对象配置</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">manualChunks</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// 将 React 相关库打包成单独的 chunk 中</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">react-vendor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react-dom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// 将 Lodash 库的代码单独打包</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">lodash</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lodash-es</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// 将组件库的代码打包</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">library</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">antd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 2. 函数配置</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">id.includes(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">antd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> || id.</span><span style="color:#F07178;">includes</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@arco-design/web-react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">library</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">id.includes(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lodash</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lodash</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">id.includes(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div></div></div><p>当然，在函数配置中，我们还需要注意循环引用的问题，具体细节你可以参考 <a href="./14.html">代码分割小节</a> 的内容。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>可直接使用 <a href="https://github.com/sanyuan0704/vite-plugin-chunk-split/blob/master/README-CN.md" target="_blank" rel="noreferrer">vite-plugin-chunk-split</a> 插件处理</p></div><h3 id="_4-按需加载" tabindex="-1">4. 按需加载 <a class="header-anchor" href="#_4-按需加载" aria-label="Permalink to &quot;4. 按需加载&quot;">​</a></h3><p>在一个完整的 Web 应用中，对于某些模块当前页面可能并不需要，如果浏览器在加载当前页面的同时也需要加载这些不必要的模块，那么可能会带来严重的性能问题。一个比较好的方式是对路由组件进行动态引入，比如在 React 应用中使用 <code>@loadable/component</code> 进行组件异步加载:</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> ReactDOM </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">react-dom</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line highlighted"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> loadable </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@loadable/component</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">BrowserRouter</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Routes</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Route</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">react-router-dom</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Foo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">loadable</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./routes/Foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Bar </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">loadable</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./routes/Bar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">render</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">React.StrictMode</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">BrowserRouter</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Routes</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Route</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">path</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">element</span><span style="color:#89DDFF;">={&lt;</span><span style="color:#FFCB6B;">Foo</span><span style="color:#89DDFF;"> /&gt;} /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Route</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">path</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/bar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">element</span><span style="color:#89DDFF;">={&lt;</span><span style="color:#FFCB6B;">Bar</span><span style="color:#89DDFF;"> /&gt;} /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#FFCB6B;">Routes</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#FFCB6B;">BrowserRouter</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#FFCB6B;">React.StrictMode</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>这样在生产环境中，Vite 也会将动态引入的组件单独打包成一个 chunk。</p><p>当然，对于组件内部的逻辑，我们也可以通过动态 import 的方式来延迟执行，进一步优化首屏的加载性能，如下代码所示:</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">App</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">computeFunc</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 延迟加载第三方库</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 需要注意 Tree Shaking 问题</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 如果直接引入包名，无法做到 Tree-Shaking，因此尽量导入具体的子路径</span></span>
<span class="line highlighted"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> default</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">merge</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">import</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lodash-es/merge</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">c</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">merge</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> a</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> b</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">c</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">className</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">App</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">button</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">onClick</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">computeFunc</span><span style="color:#89DDFF;">}&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">          Click me</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h2 id="三、预渲染优化" tabindex="-1">三、预渲染优化 <a class="header-anchor" href="#三、预渲染优化" aria-label="Permalink to &quot;三、预渲染优化&quot;">​</a></h2><p>预渲染是当今比较主流的优化手段，主要包括服务端渲染(SSR)和静态站点生成(SSG)这两种技术。</p><p>在 SSR 的场景下，服务端生成好<strong>完整的 HTML 内容</strong>，直接返回给浏览器，浏览器能够根据 HTML 渲染出完整的首屏内容，而不需要依赖 JS 的加载，从而降低浏览器的渲染压力；而另一方面，由于服务端的网络环境更优，可以更快地获取到页面所需的数据，也能节省浏览器请求数据的时间。</p><p>而 SSG 可以在构建阶段生成完整的 HTML 内容，它与 SSR 最大的不同在于 HTML 的生成在构建阶段完成，而不是在服务器的运行时。SSG 同样可以给浏览器完整的 HTML 内容，不依赖于 JS 的加载，可以有效提高页面加载性能。不过相比 SSR，SSG 的内容往往动态性不够，适合比较静态的站点，比如文档、博客等场景。</p><p>关于 SSR 和 SSG 的具体实现，在小册的 <a href="https://juejin.cn/book/7050063811973218341/section/7066612265536978981" target="_blank" rel="noreferrer">预渲染小节</a> 已经有了详细的拆解，这里主要以复习和回顾为主，实现细节就不再展开了。</p><h2 id="小结" tabindex="-1">小结 <a class="header-anchor" href="#小结" aria-label="Permalink to &quot;小结&quot;">​</a></h2><p>恭喜你，学习完了性能优化小节的内容，同时这也是本小册「高级应用篇」的最后一个小节。在本小节，你需要重点掌握 Vite 项目中的<strong>常见性能优化思路</strong>和<strong>实践方法</strong>。</p><p>本文主要围绕 Vite 项目的性能优化主题，从<code>网络优化</code>、<code>资源优化</code>及<code>预渲染优化</code>三个维度带你了解了项目常用的一些优化手段:</p><ul><li>在<code>网络优化</code>层面，我给你介绍了<code>HTTP2</code>、<code>DNS 预解析</code>、<code>Preconenct</code>、<code>Preload</code>和<code>Prefetch</code>这些优化措施；</li><li>在<code>资源优化</code>层面，介绍了<code>构建产物分析</code>、<code>资源压缩</code>、<code>产物拆包</code>、<code>按需加载</code>等手段；</li><li>最后，在<code>预渲染优化</code>方面，我带你重新回顾了 <code>SSR</code> 和 <code>SSG</code> 的相关内容。其中不乏一些之前课程中重点介绍过的优化手段，希望你能回过头来好好复习，彻底掌握它们。</li></ul><p><img src="/awesome-node/assets/19-6.f6550417.webp" alt="mindmap"></p><p>当然，由于篇幅所限，本文并不能覆盖所有的性能优化场景和手段，对于 Vite 项目的性能优化，你还能想到其它的方式吗？欢迎把你的想法分享到评论区，大家一起讨论讨论，也欢迎你在评论区记录本小节的学习心得，我们下一章再见~</p><p>2023年02月21日11:21:54</p></div></div></main><footer class="VPDocFooter" data-v-e08fe318 data-v-39c03cd7><!--[--><!--]--><div class="edit-info" data-v-39c03cd7><div class="edit-link" data-v-39c03cd7><a class="VPLink link edit-link-button" href="https://github.com/jamessawyer/awesome-node/edit/main/docs/book/vite/19.md" target="_blank" rel="noreferrer" data-v-39c03cd7 data-v-01095d06><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-39c03cd7><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> 在GitHub编辑此页<!--]--><!----></a></div><div class="last-updated" data-v-39c03cd7><p class="VPLastUpdated" data-v-39c03cd7 data-v-c0d1d2d4>Last updated: <time datetime="2023-04-11T10:14:49.000Z" data-v-c0d1d2d4></time></p></div></div><div class="prev-next" data-v-39c03cd7><div class="pager" data-v-39c03cd7><a class="pager-link prev" href="/awesome-node/book/vite/18.html" data-v-39c03cd7><span class="desc" data-v-39c03cd7>Previous page</span><span class="title" data-v-39c03cd7>18.Pure ESM时代</span></a></div><div class="has-prev pager" data-v-39c03cd7><!----></div></div></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"book_babel_5.md\":\"43c8e800\",\"book_babel_index.md\":\"1f554027\",\"book_patterns_callback-and-events.md\":\"1b22b856\",\"book_babel_4.md\":\"196442e1\",\"book_patterns_module-system_esm-cjs-interoperability.md\":\"5e9d639a\",\"book_patterns_module-system_commonjs-modules.md\":\"2e6aadbf\",\"book_babel_6.md\":\"2bb3cc9f\",\"book_vite_10.md\":\"1b7d95a3\",\"book_patterns_module-system_esm.md\":\"33e58a9d\",\"book_patterns_module-system_index.md\":\"7baf8d47\",\"book_patterns_module-system_module-define-patterns.md\":\"63cab2e2\",\"book_patterns_module-system_module-system-in-js-and-node.md\":\"da0ffd0d\",\"book_patterns_module-system_the-module-system-and-its-patterns.md\":\"fc0c0e7f\",\"book_patterns_module-system_the-need-for-modules.md\":\"5714d308\",\"book_patterns_the-module-system.md\":\"4f6c68b3\",\"book_patterns_the-node-platform.md\":\"e4eaa778\",\"book_vite_1.md\":\"d1accfdb\",\"book_vite_11.md\":\"fc3e3242\",\"book_patterns_module-system_summary.md\":\"6388e17f\",\"book_babel_3.md\":\"954a2ff3\",\"blog_dive_index.md\":\"9f591673\",\"blog_first.md\":\"161f91bb\",\"blog_misc_module.md\":\"57299e1e\",\"blog_resource_advanced.md\":\"8c64ef67\",\"blog_resource_basic.md\":\"0603c27e\",\"blog_translate_fs-in-node.md\":\"92d98167\",\"book_babel_2.md\":\"d39da118\",\"blog_translate_file-system-paths.md\":\"44045f04\",\"blog_translate_web-streams-on-node.md\":\"5851a151\",\"book_vite_12.md\":\"7224a8fb\",\"blog_misc_ts-and-express.md\":\"96afcc85\",\"book_babel_1.md\":\"79f8311a\",\"book_vite_14.md\":\"d35890b1\",\"book_vite_15.md\":\"59f18391\",\"book_vite_2.md\":\"5e9ccb16\",\"book_vite_3.md\":\"9130fb0f\",\"book_vite_4.md\":\"52018cef\",\"book_vite_19.md\":\"899df01c\",\"book_vite_7.md\":\"baf63994\",\"book_vite_16.md\":\"6162cff7\",\"book_webpack_1.md\":\"f65a6bc0\",\"book_vite_17.md\":\"5e211667\",\"book_vite_18.md\":\"e818a5fc\",\"book_vite_8.md\":\"43cb95e3\",\"lib_fs-extra_readjson.md\":\"bc79ed74\",\"manager_webpack.md\":\"674742e3\",\"book_webpack_11.md\":\"3b73b975\",\"book_webpack_2.md\":\"8f85707b\",\"core_stream_index.md\":\"c6c4c853\",\"core_stream_stream-in-practice.md\":\"9308a63e\",\"core_stream_stream-visulization.md\":\"88687fa1\",\"framework_express_index.md\":\"3393a51a\",\"framework_nestjs_index.md\":\"14eff85b\",\"index.md\":\"47b5de03\",\"lib_fs-extra_copy.md\":\"4669628c\",\"lib_fs-extra_emptydir.md\":\"19fad7e7\",\"lib_fs-extra_ensuredir.md\":\"9fbfd681\",\"lib_fs-extra_ensurefile.md\":\"e28bd787\",\"lib_fs-extra_ensurelink.md\":\"f9b9fbc3\",\"lib_fs-extra_ensuresymlink.md\":\"2828ad91\",\"lib_fs-extra_fs-write-read-writev.md\":\"878d59fb\",\"lib_fs-extra_index.md\":\"8b685dab\",\"lib_fs-extra_move.md\":\"5131bb02\",\"lib_fs-extra_outputfile.md\":\"9b0c7499\",\"lib_fs-extra_outputjson.md\":\"ae7f089b\",\"lib_fs-extra_pathexists.md\":\"361cb7fb\",\"lib_fs-extra_remove.md\":\"6f0dfab3\",\"lib_fs-extra_writejson.md\":\"7b1f9aac\",\"manager_basic.md\":\"f9a58bde\",\"manager_recipe.md\":\"49e04817\",\"manager_vite.md\":\"bbba705d\",\"v18doc_file-system.md\":\"3fc8fe2d\",\"v18doc_path.md\":\"1d46803a\",\"manager_babel.md\":\"6f6fce30\",\"core_events_index.md\":\"3178b47b\",\"book_vite_9.md\":\"e1b94719\",\"book_webpack_10.md\":\"ca0c2abc\",\"book_webpack_3.md\":\"575082db\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Awesome Node\",\"description\":\"Node + Vite + Webpack + Babel\",\"base\":\"/awesome-node/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"outlineTitle\":\"目录\",\"outline\":[2,3],\"editLink\":{\"text\":\"在GitHub编辑此页\",\"pattern\":\"https://github.com/jamessawyer/awesome-node/edit/main/docs/:path\"},\"nav\":[{\"text\":\"📄Node文档\",\"activeMatch\":\"^/v18doc/\",\"link\":\"/v18doc/File-System\"},{\"text\":\"📦工程化\",\"link\":\"/manager/basic\"},{\"text\":\"💫核心概念\",\"link\":\"/core/stream/index\"},{\"text\":\"🤔blog\",\"link\":\"/blog/first\"},{\"text\":\"📚书籍\",\"items\":[{\"text\":\"Node Design Patterns\",\"link\":\"/book/patterns/the-node-platform\"},{\"text\":\"深入理解Vite\",\"link\":\"/book/vite/2\"},{\"text\":\"Webpack5核心原理\",\"link\":\"/book/webpack/1\"},{\"text\":\"Babel插件秘籍\",\"link\":\"/book/babel/2\"}]},{\"text\":\"🧑‍🚀框架\",\"items\":[{\"text\":\"NestJS\",\"link\":\"/framework/nestjs/index\"},{\"text\":\"Express\",\"link\":\"/framework/express/index\"}]},{\"text\":\"🔥常用库\",\"items\":[{\"text\":\"fs-extra\",\"link\":\"/lib/fs-extra/index\"}]}],\"sidebar\":{\"/v18doc/\":[{\"text\":\"Node v18.x 中文文档\",\"items\":[{\"text\":\"File System\",\"link\":\"/v18doc/File-System\"},{\"text\":\"Path\",\"link\":\"/v18doc/Path\"}]}],\"/manager/\":[{\"text\":\"基础知识\",\"items\":[{\"text\":\"package.json\",\"link\":\"/manager/basic\"},{\"text\":\"Vite学习\",\"link\":\"/manager/vite\"},{\"text\":\"Webpack学习\",\"link\":\"/manager/webpack\"},{\"text\":\"babel生态\",\"link\":\"/manager/babel\"}]},{\"text\":\"Recipe\",\"items\":[{\"text\":\"Node资源\",\"link\":\"/manager/recipe\"}]}],\"/core/\":[{\"text\":\"EventEmitter\",\"collapsible\":true,\"items\":[{\"text\":\"资源\",\"link\":\"/core/events/index\"}]},{\"text\":\"Streams\",\"collapsible\":true,\"items\":[{\"text\":\"资源\",\"link\":\"/core/stream/index\"},{\"text\":\"⚡Stream图解\",\"link\":\"/core/stream/stream-visulization\"},{\"text\":\"⚡Stream实战\",\"link\":\"/core/stream/stream-in-practice\"}]}],\"/blog/\":[{\"text\":\"资源\",\"items\":[{\"text\":\"Advanced\",\"link\":\"/blog/resource/advanced\"}]},{\"text\":\"🚀 好文翻译\",\"collapsible\":true,\"items\":[{\"text\":\"Path & URL的用法\",\"link\":\"/blog/translate/file-system-paths\"},{\"text\":\"FS in Node\",\"link\":\"/blog/translate/fs-in-node\"},{\"text\":\"Web Streams on Node\",\"link\":\"/blog/translate/web-streams-on-node\"}]},{\"text\":\"MISC\",\"collapsible\":true,\"items\":[{\"text\":\"ESM & CJS模块\",\"link\":\"/blog/misc/module\"},{\"text\":\"Express + typescript设置\",\"link\":\"/blog/misc/ts-and-express\"}]}],\"/book/patterns\":[{\"text\":\"Node设计模式\",\"items\":[{\"text\":\"the node platform\",\"link\":\"/book/patterns/the-node-platform\"},{\"text\":\"callback and events\",\"link\":\"/book/patterns/callback-and-events\"}]},{\"text\":\"Ⅱ.模块系统\",\"collapsible\":true,\"items\":[{\"text\":\"介绍\",\"link\":\"/book/patterns/module-system/index\"},{\"text\":\"模块系统的必要性\",\"link\":\"/book/patterns/module-system/the-need-for-modules\"},{\"text\":\"JS和Node中的模块系统\",\"link\":\"/book/patterns/module-system/module-system-in-js-and-node\"},{\"text\":\"模块系统和其模式\",\"link\":\"/book/patterns/module-system/the-module-system-and-its-patterns\"},{\"text\":\"⚡CommonJS模块\",\"link\":\"/book/patterns/module-system/commonjs-modules\"},{\"text\":\"🙆‍♀️CommonJS模块常用模式定义\",\"link\":\"/book/patterns/module-system/module-define-patterns\"},{\"text\":\"🚀ESM\",\"link\":\"/book/patterns/module-system/esm\"},{\"text\":\"🚀ESM和CJS差异和互操性\",\"link\":\"/book/patterns/module-system/esm-cjs-interoperability\"},{\"text\":\"总结\",\"link\":\"/book/patterns/module-system/summary\"}]}],\"/book/vite\":[{\"text\":\"🔧深入理解Vite\",\"items\":[{\"text\":\"1.Vite开篇\",\"link\":\"/book/vite/1\"},{\"text\":\"2.模块标准\",\"link\":\"/book/vite/2\"},{\"text\":\"3.快速上手Vite\",\"link\":\"/book/vite/3\"},{\"text\":\"4.样式方案\",\"link\":\"/book/vite/4\"},{\"text\":\"7.预构建\",\"link\":\"/book/vite/7\"},{\"text\":\"8.双引擎架构\",\"link\":\"/book/vite/8\"},{\"text\":\"9.性能推手: Esbuild\",\"link\":\"/book/vite/9\"},{\"text\":\"10.Rollup基本用法\",\"link\":\"/book/vite/10\"},{\"text\":\"11.深入理解Rollup插件机制\",\"link\":\"/book/vite/11\"},{\"text\":\"12.Vite插件开发\",\"link\":\"/book/vite/12\"},{\"text\":\"14.代码分割\",\"link\":\"/book/vite/14\"},{\"text\":\"15.Polyfill和语法降级\",\"link\":\"/book/vite/15\"},{\"text\":\"16.Vite搭建SSR工程\",\"link\":\"/book/vite/16\"},{\"text\":\"17.联邦模块以及原理\",\"link\":\"/book/vite/17\"},{\"text\":\"18.Pure ESM时代\",\"link\":\"/book/vite/18\"},{\"text\":\"19.系统对Vite项目性能优化\",\"link\":\"/book/vite/19\"}]}],\"/book/webpack\":[{\"text\":\"Webpack5核心原理与实践\",\"items\":[{\"text\":\"1.重新认识Webpack\",\"link\":\"/book/webpack/1\"},{\"text\":\"2.如何理解Webpack配置底层结构逻辑？\",\"link\":\"/book/webpack/2\"},{\"text\":\"3.配置Babel+TS+ESLint？\",\"link\":\"/book/webpack/3\"},{\"text\":\"10.深入理解图像加载原理和最佳实践\",\"link\":\"/book/webpack/10\"},{\"text\":\"11.深入理解webpack核心配置📚\",\"link\":\"/book/webpack/11\"}]}],\"/book/babel\":[{\"text\":\"Babel插件秘籍\",\"items\":[{\"text\":\"1.Babel的介绍\",\"link\":\"/book/babel/1\"},{\"text\":\"2.Babel的编译流程\",\"link\":\"/book/babel/2\"},{\"text\":\"3.Babel的AST\",\"link\":\"/book/babel/3\"},{\"text\":\"4.Babel的API\",\"link\":\"/book/babel/4\"},{\"text\":\"5.实战：插入函数调用参数\",\"link\":\"/book/babel/5\"},{\"text\":\"6.JS Parser的历史\",\"link\":\"/book/babel/6\"}]}],\"/lib/fs-extra\":[{\"text\":\"fs-extra\",\"items\":[{\"text\":\"README\",\"link\":\"/lib/fs-extra/index\"},{\"text\":\"copy\",\"link\":\"/lib/fs-extra/copy\"},{\"text\":\"emptyDir\",\"link\":\"/lib/fs-extra/emptyDir\"},{\"text\":\"ensureFile\",\"link\":\"/lib/fs-extra/ensureFile\"},{\"text\":\"ensureDir\",\"link\":\"/lib/fs-extra/ensureDir\"},{\"text\":\"ensureLink\",\"link\":\"/lib/fs-extra/ensureLink\"},{\"text\":\"ensureSymlink\",\"link\":\"/lib/fs-extra/ensureSymlink\"},{\"text\":\"move\",\"link\":\"/lib/fs-extra/move\"},{\"text\":\"outputFile\",\"link\":\"/lib/fs-extra/outputFile\"},{\"text\":\"pathExists\",\"link\":\"/lib/fs-extra/pathExists\"},{\"text\":\"readJson\",\"link\":\"/lib/fs-extra/readJson\"},{\"text\":\"remove\",\"link\":\"/lib/fs-extra/remove\"},{\"text\":\"outputJson\",\"link\":\"/lib/fs-extra/outputJson\"},{\"text\":\"writeJson\",\"link\":\"/lib/fs-extra/writeJson\"},{\"text\":\"fs-write-read-writev\",\"link\":\"/lib/fs-extra/fs-write-read-writev\"}]}],\"/framework/nestjs\":[{\"text\":\"学习NestJS\",\"items\":[{\"text\":\"资源\",\"link\":\"/framework/nestjs/index\"}]}],\"/framework/express\":[{\"text\":\"Learn ExpressJS\",\"items\":[{\"text\":\"资源\",\"link\":\"/framework/express/index\"}]}]}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>