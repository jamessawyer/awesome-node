<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node Path的用法 | Awesome Node</title>
    <meta name="description" content="Node + Vite + Webpack + Babel">
    <link rel="preload stylesheet" href="/awesome-node/assets/style.7aaf77d9.css" as="style">
    <script type="module" src="/awesome-node/assets/app.6585a414.js"></script>
    <link rel="preload" href="/awesome-node/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/awesome-node/assets/chunks/framework.7812daa2.js">
  <link rel="modulepreload" href="/awesome-node/assets/chunks/theme.f0f59a04.js">
  <link rel="modulepreload" href="/awesome-node/assets/blog_translate_file-system-paths.md.44045f04.lean.js">
  <link rel="icon" href="/awesome-node/favicon.ico">
  <link rel="apple-touch-icon" href="/awesome-node/pwa-192x192.png" sizes="192x192">
  <meta name="keywords" content="Node, Vite, Webpack, Babel">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  <link rel="manifest" href="/awesome-node/manifest.webmanifest">
  <script id="vite-plugin-pwa:register-sw" src="/awesome-node/registerSW.js"></script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-49ea956c><!--[--><!--]--><!--[--><span tabindex="-1" data-v-2e416324></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-2e416324> Skip to content </a><!--]--><!----><header class="VPNav" data-v-49ea956c data-v-56b927fe><div class="VPNavBar has-sidebar" data-v-56b927fe data-v-d13d5f92><div class="container" data-v-d13d5f92><div class="title" data-v-d13d5f92><div class="VPNavBarTitle has-sidebar" data-v-d13d5f92 data-v-b63551fd><a class="title" href="/awesome-node/" data-v-b63551fd><!--[--><!--]--><!--[--><img class="VPImage logo" src="/awesome-node/logo.svg" alt data-v-85a9830b><!--]--><!--[-->Awesome Node<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-d13d5f92><div class="curtain" data-v-d13d5f92></div><div class="content-body" data-v-d13d5f92><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-d13d5f92 data-v-29f8f6a7><span id="main-nav-aria-label" class="visually-hidden" data-v-29f8f6a7>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/v18doc/File-System.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->📄Node文档<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/manager/basic.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->📦工程化<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/core/stream/index.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->💫核心概念<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/awesome-node/blog/first.html" tabindex="0" data-v-29f8f6a7 data-v-06a499ed data-v-01095d06><!--[-->🤔blog<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-29f8f6a7 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-508c46e6><span class="text" data-v-508c46e6><!----> 📚书籍 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-508c46e6><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><div class="items" data-v-a8e5986e><!--[--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/patterns/the-node-platform.html" data-v-4542e1b5 data-v-01095d06><!--[-->Node Design Patterns<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/vite/2.html" data-v-4542e1b5 data-v-01095d06><!--[-->深入理解Vite<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/webpack/1.html" data-v-4542e1b5 data-v-01095d06><!--[-->Webpack5核心原理<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/book/babel/2.html" data-v-4542e1b5 data-v-01095d06><!--[-->Babel插件秘籍<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-29f8f6a7 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-508c46e6><span class="text" data-v-508c46e6><!----> 🧑‍🚀框架 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-508c46e6><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><div class="items" data-v-a8e5986e><!--[--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/framework/nestjs/index.html" data-v-4542e1b5 data-v-01095d06><!--[-->NestJS<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/framework/express/index.html" data-v-4542e1b5 data-v-01095d06><!--[-->Express<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-29f8f6a7 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-508c46e6><span class="text" data-v-508c46e6><!----> 🔥常用库 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-508c46e6><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><div class="items" data-v-a8e5986e><!--[--><!--[--><div class="VPMenuLink" data-v-a8e5986e data-v-4542e1b5><a class="VPLink link" href="/awesome-node/lib/fs-extra/index.html" data-v-4542e1b5 data-v-01095d06><!--[-->fs-extra<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-d13d5f92 data-v-11927c9d><label title="toggle dark mode" data-v-11927c9d data-v-25ab53b0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-25ab53b0 data-v-785f9bd9><span class="check" data-v-785f9bd9><span class="icon" data-v-785f9bd9><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-25ab53b0><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-25ab53b0><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-d13d5f92 data-v-eae5c608 data-v-508c46e6><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-508c46e6><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-508c46e6><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-508c46e6><div class="VPMenu" data-v-508c46e6 data-v-a8e5986e><!----><!--[--><!--[--><!----><div class="group" data-v-eae5c608><div class="item appearance" data-v-eae5c608><p class="label" data-v-eae5c608>Appearance</p><div class="appearance-action" data-v-eae5c608><label title="toggle dark mode" data-v-eae5c608 data-v-25ab53b0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-25ab53b0 data-v-785f9bd9><span class="check" data-v-785f9bd9><span class="icon" data-v-785f9bd9><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-25ab53b0><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-25ab53b0><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-d13d5f92 data-v-f545931e><span class="container" data-v-f545931e><span class="top" data-v-f545931e></span><span class="middle" data-v-f545931e></span><span class="bottom" data-v-f545931e></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-49ea956c data-v-1e6acb7f><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-1e6acb7f><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-1e6acb7f><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-1e6acb7f>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-1e6acb7f data-v-8340454f><button data-v-8340454f>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-49ea956c data-v-3fbbbda7><div class="curtain" data-v-3fbbbda7></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-3fbbbda7><span class="visually-hidden" id="sidebar-aria-label" data-v-3fbbbda7> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-3fbbbda7><section class="VPSidebarItem level-0" data-v-3fbbbda7 data-v-a486264d><div class="item" role="button" tabindex="0" data-v-a486264d><div class="indicator" data-v-a486264d></div><h2 class="text" data-v-a486264d>资源</h2><!----></div><div class="items" data-v-a486264d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/blog/resource/advanced.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>Advanced</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-3fbbbda7><section class="VPSidebarItem level-0 has-active" data-v-3fbbbda7 data-v-a486264d><div class="item" role="button" tabindex="0" data-v-a486264d><div class="indicator" data-v-a486264d></div><h2 class="text" data-v-a486264d>🚀 好文翻译</h2><!----></div><div class="items" data-v-a486264d><!--[--><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/blog/translate/file-system-paths.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>Path & URL的用法</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/blog/translate/fs-in-node.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>FS in Node</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/blog/translate/web-streams-on-node.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>Web Streams on Node</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-3fbbbda7><section class="VPSidebarItem level-0" data-v-3fbbbda7 data-v-a486264d><div class="item" role="button" tabindex="0" data-v-a486264d><div class="indicator" data-v-a486264d></div><h2 class="text" data-v-a486264d>MISC</h2><!----></div><div class="items" data-v-a486264d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/blog/misc/module.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>ESM & CJS模块</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a486264d data-v-a486264d><div class="item" data-v-a486264d><div class="indicator" data-v-a486264d></div><a class="VPLink link link" href="/awesome-node/blog/misc/ts-and-express.html" data-v-a486264d data-v-01095d06><!--[--><p class="text" data-v-a486264d>Express + typescript设置</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-49ea956c data-v-227c3700><div class="VPDoc has-sidebar has-aside" data-v-227c3700 data-v-e08fe318><!--[--><!--]--><div class="container" data-v-e08fe318><div class="aside" data-v-e08fe318><div class="aside-curtain" data-v-e08fe318></div><div class="aside-container" data-v-e08fe318><div class="aside-content" data-v-e08fe318><div class="VPDocAside" data-v-e08fe318 data-v-d53a0c94><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-d53a0c94 data-v-f8cf7442><div class="content" data-v-f8cf7442><div class="outline-marker" data-v-f8cf7442></div><div class="outline-title" data-v-f8cf7442>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-f8cf7442><span class="visually-hidden" id="doc-outline-aria-label" data-v-f8cf7442> Table of Contents for current page </span><ul class="root" data-v-f8cf7442 data-v-f8a0804d><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-d53a0c94></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e08fe318><div class="content-container" data-v-e08fe318><!--[--><!--]--><!----><main class="main" data-v-e08fe318><div style="position:relative;" class="vp-doc _awesome-node_blog_translate_file-system-paths" data-v-e08fe318><div><nav class="table-of-contents"><ul><li><a href="#_1️⃣-path相关的功能">1️⃣ Path相关的功能</a><ul><li><a href="#_1-1-访问-node-path-api的3种方式">1.1 访问 node:path API的3种方式</a></li></ul></li><li><a href="#_2️⃣-path的基本概念">2️⃣ Path的基本概念</a><ul><li><a href="#_2-1-path-segments-path-separators-path-delimiters">2.1 Path segments, path separators, path delimiters</a></li><li><a href="#_2-3-全限定-vs-部分限定路径-解析路径">2.3 全限定 vs 部分限定路径，解析路径</a></li></ul></li><li><a href="#_3️⃣-通过-node-os-获取重要目录路径">3️⃣ 通过 &#39;node:os&#39; 获取重要目录路径</a></li><li><a href="#_4️⃣-⭐-拼接路径">4️⃣ ⭐ 拼接路径</a><ul><li><a href="#_4-1-path-resolve-拼接并创建全限定路径">4.1 path.resolve()：拼接并创建全限定路径</a></li><li><a href="#_4-2-path-join-拼接路径-同时保留相对路径">4.2 path.join()：拼接路径，同时保留相对路径</a></li></ul></li><li><a href="#_5️⃣-确保路径是标准化的、完全限定的或相对的">5️⃣ 确保路径是标准化的、完全限定的或相对的</a><ul><li><a href="#_5-1-path-normalize-确保路径标准化">5.1 path.normalize()：确保路径标准化</a></li><li><a href="#_5-2-path-resolve-一个参数-确保路径标准化和完全限定">5.2 path.resolve()（一个参数）：确保路径标准化和完全限定</a></li><li><a href="#_5-3-⭐-path-relative-创建相对路径">5.3 ⭐ path.relative()：创建相对路径</a></li></ul></li><li><a href="#_6️⃣-⭐-解析路径-提取路径的各个部分-文件名扩展等">6️⃣ ⭐ 解析路径：提取路径的各个部分（文件名扩展等）</a><ul><li><a href="#_6-1-path-parse-创建包含path各部分的对象">6.1 path.parse(): 创建包含path各部分的对象</a></li><li><a href="#_6-2-path-basename-提取路径的base部分">6.2 path.basename(): 提取路径的base部分</a></li><li><a href="#_6-3-path-dirname-提取路径的父目录">6.3 path.dirname()：提取路径的父目录</a></li><li><a href="#_6-4-path-extname-提取路径的扩展">6.4 path.extname()：提取路径的扩展</a></li></ul></li><li><a href="#_7️⃣-path-isabsolute-是否为绝对路径">7️⃣ path.isAbsolute() ：是否为绝对路径？</a></li><li><a href="#_8️⃣-path-format-使用path-parts创建路径">8️⃣ path.format()：使用path parts创建路径</a><ul><li><a href="#_8-1-例子-改变文件扩展">8.1 例子：改变文件扩展</a></li></ul></li><li><a href="#_9️⃣-在不同平台使用相同路径">9️⃣ 在不同平台使用相同路径</a><ul><li><a href="#_9-1-相对平台独立的路径">9.1 相对平台独立的路径</a></li></ul></li><li><a href="#🔟-使用第三方库匹配路径-通过globs">🔟 使用第三方库匹配路径，通过globs</a><ul><li><a href="#_10-1-minimatch-api">10.1 minimatch API</a></li><li><a href="#_10-2-glob表达式语法">10.2 glob表达式语法</a></li></ul></li><li><a href="#_1️⃣1️⃣-使用-file-urls-引用文件">1️⃣1️⃣ 使用 file:URLs 引用文件</a><ul><li><a href="#_11-1-url类">11.1 URL类</a></li><li><a href="#_11-2-⭐-urls和文件路径间转换">11.2 ⭐ URLs和文件路径间转换</a></li><li><a href="#_11-3-⭐-urls使用场景-相对于当前模块访问文件">11.3 ⭐ URLs使用场景：相对于当前模块访问文件</a></li><li><a href="#_11-4-urls使用场景-检测当前模块是否以脚本形式运行">11.4 URLs使用场景：检测当前模块是否以脚本形式运行</a></li><li><a href="#_11-5-paths-vs-file-urls">11.5 Paths vs file:URLs</a></li></ul></li></ul></nav><h2 id="_1️⃣-path相关的功能" tabindex="-1">1️⃣ Path相关的功能 <a class="header-anchor" href="#_1️⃣-path相关的功能" aria-label="Permalink to &quot;1️⃣ Path相关的功能&quot;">​</a></h2><p>本文将探索Node中和Path相关的功能：</p><ul><li>大多数和path相关的功能都在 <code>node:path</code> 模块中</li><li>全局变量 <code>process</code> 上存在 <em>改变当前工作路径（<code>current working directory</code>）</em> 的方法</li><li>模块 <code>node:os</code> 存在返回重要目录路径的函数</li></ul><h3 id="_1-1-访问-node-path-api的3种方式" tabindex="-1">1.1 访问 <code>node:path</code> API的3种方式 <a class="header-anchor" href="#_1-1-访问-node-path-api的3种方式" aria-label="Permalink to &quot;1.1 访问 `node:path` API的3种方式&quot;">​</a></h3><p>模块 <code>node:path</code> 通常通过下面方式导入：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><p>本文示例中一般会忽略上面的导入，另外还被忽略的有：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> assert </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:assert/strict</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><p>我们有3种方式访问Node的path API：</p><ol><li><p>我们可以访问 <strong><code>平台相关</code></strong> 的版本API:</p><ul><li><code>path.posix</code> 支持Unixes，包括macOS</li><li><code>path.win32</code> 支持Windows</li></ul></li><li><p><code>path</code> 自身总是支持当前平台，比如，下面是macOS 下的REPL交互</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">path.parse</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">===</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">path.posix.parse</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># true</span></span></code></pre></div></li></ol><p>让我们看看函数 <code>path.parse()</code> （用于解析文件系统路径）在不同平台的差异：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#676E95;font-style:italic;">// 1.Window平台</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">String</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">raw</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\U</span><span style="color:#C3E88D;">sers</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">ane</span><span style="color:#A6ACCD;">\f</span><span style="color:#C3E88D;">ile.txt</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 输出</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">dir</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">root</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">base</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">ext</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// 2.Unixes平台</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">String</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">raw</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\U</span><span style="color:#C3E88D;">sers</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">ane</span><span style="color:#A6ACCD;">\f</span><span style="color:#C3E88D;">ile.txt</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 输出</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">dir</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">root</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">base</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">ext</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>我们解析一个Window路径，通过 <code>path.win32</code> 正确解析，而Unix的 <code>path.posix</code> 对window路径解析不正确，比如，文件的basename应该是 <code>file.txt</code>。</p><h2 id="_2️⃣-path的基本概念" tabindex="-1">2️⃣ Path的基本概念 <a class="header-anchor" href="#_2️⃣-path的基本概念" aria-label="Permalink to &quot;2️⃣ Path的基本概念&quot;">​</a></h2><h3 id="_2-1-path-segments-path-separators-path-delimiters" tabindex="-1">2.1 Path segments, path separators, path delimiters <a class="header-anchor" href="#_2-1-path-segments-path-separators-path-delimiters" aria-label="Permalink to &quot;2.1 Path segments, path separators, path delimiters&quot;">​</a></h3><p>术语：</p><ul><li><p>一个非空的路径由一个或多个 <code>path segments</code>（路径片段） - 通常是目录名或文件名</p></li><li><p><code>path separator</code> 用于分割某个路径中2个相连的 <code>path segments</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">sep</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;/&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">sep</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;\\&#39;</span></span></code></pre></div></li><li><p><code>path deliimiter</code> 用于分开paths列表中的元素</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">delimiter</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;:&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">delimiter</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;;&#39;</span></span></code></pre></div><p>当我们查看 <code>PATH shell</code> 变量时，我们可以看到 <code>path separators</code> 和 <code>path delimitors</code> - 其中包含在 shell 中输入命令时操作系统查找可执行文件的路径。</p><p>🌰下面是macOS <code>PATH</code> 例子（shell变量 <code>$PATH</code>）:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">env</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">PATH</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">/(?&lt;=</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">)/</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/opt/homebrew/bin:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/opt/homebrew/sbin:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local/bin:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/bin:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/bin:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/sbin:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/sbin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span></span></code></pre></div><p>Split separtor长度为0，因为 <a href="https://jamessawyer.github.io/deep-javascript-cn/6/Regular-expressions-lookaround-assertions-by-example.html" target="_blank" rel="noreferrer">lookbehind assertion</a> 在给定位置匹配，但是不进行捕获。因此path delimiter <code>:</code> 在上面路径中被包含。</p><p>🌰 下面是Windows PATH例子（shell变量是 <code>%Path%</code>）:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">env</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">PATH</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">/(?&lt;=</span><span style="color:#C3E88D;">;</span><span style="color:#89DDFF;">)/</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">system32;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">System32</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Wbem;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">System32</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">WindowsPowerShell</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">v1.0</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">System32</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">OpenSSH</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">ProgramData</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">chocolatey</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">bin;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Program Files</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">nodejs</span><span style="color:#A6ACCD;">\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span></span></code></pre></div><h3 id="_2-2-当前工作目录-cwd" tabindex="-1">2.2 当前工作目录(CWD) <a class="header-anchor" href="#_2-2-当前工作目录-cwd" aria-label="Permalink to &quot;2.2 当前工作目录(CWD)&quot;">​</a></h3><p>很多shell都有 <em>当前工作目录（<code>CWD</code>）</em> 的概念 - <code>我当前所在的目录</code>：</p><ul><li>如果我们使用部分限定路径（<code>partially qualified path</code>），则该路径会依据CWD进行解析</li><li>如果一个命令期望一个路径，但我们忽略了该路径，则CWD会默认被使用</li><li>Unixes和windowsa平台，改变CWD的命令都是 <code>cd</code></li></ul></li></ul><p><code>process</code> 这个Node全局变量提供了获取和改变CWD的方法：</p><ol><li><a href="https://nodejs.org/api/process.html#processcwd" target="_blank" rel="noreferrer">process.cwd()</a> 返回CWD</li><li><a href="https://nodejs.org/api/process.html#processchdirdirectory" target="_blank" rel="noreferrer">process.chdir(dirPath)</a> 将CWD改为 <code>dirPath</code><ul><li><code>dirPath</code> 必须是一个文件夹</li><li>这个改变不会影响shell，只会影响当前运行的Node进程</li></ul></li></ol><p>👩🏻‍🏫 当一个路径不是 <em>完整路径（<code>fully qualified(complete)</code>）</em> 时，Node会利用CWD补充缺失的部分。这使得我们可以在很多函数中使用部分限定路径🤩，比如：<code>fs.readFileSync()</code></p><h4 id="unix中的cwd" tabindex="-1">Unix中的CWD <a class="header-anchor" href="#unix中的cwd" aria-label="Permalink to &quot;Unix中的CWD&quot;">​</a></h4><p>下面代码展示了Unix中的 <code>process.chdir()</code> &amp; <code>process.cwd()</code>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">chdir</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cwd</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="windows中的cwd" tabindex="-1">Windows中的CWD <a class="header-anchor" href="#windows中的cwd" aria-label="Permalink to &quot;Windows中的CWD&quot;">​</a></h4><p>Windows和Unix工作效果不一样😅：</p><ul><li>每个驱动（<code>drive</code>） 都有一个 <em>当前目录（<code>current directory</code>）</em></li><li>存在一个 <em>当前驱动（<code>current drive</code>）</em></li></ul><p>我们可以使用 <code>path.chdir()</code> 同时设定2个：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">chdir</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// C盘</span></span>
<span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">chdir</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">tmp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// Z盘</span></span></code></pre></div><p>当我们访问一个驱动时，Node会记住该驱动的当前目录：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cwd</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">tmp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">chdir</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// 改变驱动，即从Z盘切到C盘</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cwd</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="_2-3-全限定-vs-部分限定路径-解析路径" tabindex="-1">2.3 全限定 vs 部分限定路径，解析路径 <a class="header-anchor" href="#_2-3-全限定-vs-部分限定路径-解析路径" aria-label="Permalink to &quot;2.3 全限定 vs 部分限定路径，解析路径&quot;">​</a></h3><ul><li>全限定路径（<code>fully quallified path</code>） 不需要依赖其它信息，可直接使用（译者注：全限定即完整路径，绝对路径）</li><li>部分限定路径（<code>partially qualified path</code>） 缺失信息：在使用前，我们需要将其转换为全限定路径。这是通过针对完全限定的路径来解析（<code>resolve</code>）的（译者注：部分限定即相对路径）</li></ul><h4 id="_2-3-1-unix中的全限定和部分限定" tabindex="-1">2.3.1 Unix中的全限定和部分限定 <a class="header-anchor" href="#_2-3-1-unix中的全限定和部分限定" aria-label="Permalink to &quot;2.3.1 Unix中的全限定和部分限定&quot;">​</a></h4><p>Unix只能识别2类路径：</p><ul><li><p><code>绝对路径（Absolute paths）</code> 是全限定的，以 <code>/</code> 开头</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">/home/john/proj</span></span></code></pre></div></li><li><p><code>相对路径（Relative paths）</code> 是部分限定的，以文件名或点（<code>dot</code>）开头</p><ul><li><code>.</code> 当前目录</li><li><code>..</code> 父目录</li><li><code>dir</code></li><li><code>../dir</code></li><li><code>../../dir/subdir</code></li></ul></li></ul><p>🚀让我们使用 <code>path.resolve()</code> 将相对路径解析为绝对路径：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> abs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/proj</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(abs</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/join/proj&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(abs</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/join&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(abs</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/john/proj/dir&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(abs</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/john/dir&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(abs</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../../dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/dir/subdir&#39;</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>👆🏻上面例子对理解 <code>path.resolve()</code> 用法，提供了直白的示例</p></div><h4 id="_2-3-2-windows中的全限定和部分限定" tabindex="-1">2.3.2 Windows中的全限定和部分限定 <a class="header-anchor" href="#_2-3-2-windows中的全限定和部分限定" aria-label="Permalink to &quot;2.3.2 Windows中的全限定和部分限定&quot;">​</a></h4><p>WIndows秋分4种路径：（可参考 <a href="https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file#fully-qualified-vs-relative-paths" target="_blank" rel="noreferrer">Microsoft docs</a>）</p><ul><li>绝对路径和相对路径</li><li>上面的2种路径都可以有或没有驱动字符（<code>drive letter</code>）</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>📚 <strong>绝对路径 + 驱动字符 = 全限定路径；其余的均为部分限定路径</strong>。</p></div><p>1.<strong>解析没有驱动字符的绝对路径</strong>，绝对路径会使用全限定路径的驱动字符：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#676E95;font-style:italic;">// 💡 全限定路径 `C:` 为驱动字符；</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// `\\Users\\jane\\proj` 为绝对路径</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> full </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// 绝对路径，没有驱动字符</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> absolute </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> absolute)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Windows&#39;</span></span></code></pre></div><p>2.<strong>解析没有驱动字符的相对路径</strong>：视作为更新</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> full </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\jane\\proj&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\jane&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\jane\\proj\\dir&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\jane\\proj\\dir&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\jane\\dir&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">..</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">ddir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\dir&#39;</span></span></code></pre></div><p>3.<strong>解析带有驱动字符的相对路径</strong>：解析结果取决于驱动字符</p><ul><li>相对路径的驱动字符 <code>rel</code> 和全限定驱动字符 <code>full</code> 相同？</li><li>不同的驱动器号而不是 <code>full</code>？根据 <code>rel</code> 驱动器的当前目录解析 <code>rel</code></li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 配置当前目录为 C: 和 Z:</span></span>
<span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">chdir</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Windows</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Systm</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">chdir</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">tmp:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> full </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 相同驱动字符 都为 `C:`</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// cwd变为 &#39;C:\\Users\\jane\\proj&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 不同驱动字符 一个是 `C:` 一个是 `Z:`</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// cwd变为 &#39;Z:\\tmp:&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">tmp</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(full</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">tmp</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h2 id="_3️⃣-通过-node-os-获取重要目录路径" tabindex="-1">3️⃣ 通过 &#39;node:os&#39; 获取重要目录路径 <a class="header-anchor" href="#_3️⃣-通过-node-os-获取重要目录路径" aria-label="Permalink to &quot;3️⃣ 通过 &#39;node:os&#39; 获取重要目录路径&quot;">​</a></h2><p>模块 <code>node:os</code> 给我们提供了2个重要的目录路径：</p><ol><li><p><a href="https://nodejs.org/api/os.html#oshomedir" target="_blank" rel="noreferrer">os.homedir()</a> 返回当前用户的home目录</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">homeddir</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// macOS</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/Users/rauschma&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">homedir</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// Windows</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\axel&#39;</span></span></code></pre></div></li><li><p><code>os.tmpdir()</code> 返回操作系统临时文件目录：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tmpdir</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// macOS</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/var/folders/ph/sz0384m11vxf5byk12fzjms40000gn/T&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tmpdir</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// Windows</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\axel\\AppData\\Local\\Temp&#39;</span></span></code></pre></div></li></ol><h2 id="_4️⃣-⭐-拼接路径" tabindex="-1">4️⃣ ⭐ 拼接路径 <a class="header-anchor" href="#_4️⃣-⭐-拼接路径" aria-label="Permalink to &quot;4️⃣ ⭐ 拼接路径&quot;">​</a></h2><p>🚀 有2个函数用于拼接路径：</p><ol><li><code>path.resolve()</code>： 总是返回全限定路径</li><li><code>path.join()</code>： <strong>保留</strong>相对路径</li></ol><h3 id="_4-1-path-resolve-拼接并创建全限定路径" tabindex="-1">4.1 path.resolve()：拼接并创建全限定路径 <a class="header-anchor" href="#_4-1-path-resolve-拼接并创建全限定路径" aria-label="Permalink to &quot;4.1 path.resolve()：拼接并创建全限定路径&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">paths: Array</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">): string</span></span></code></pre></div><p>拼接 <code>paths</code>， 并返回全限定路径。它使用如下算法：</p><ul><li>以当前工作路径（CWD）开始</li><li>在之前的结果基础上解析 <code>path[0]</code></li><li>再在之前的结果基础上解析 <code>path[1]</code></li><li>对其余路径依此类推</li><li>返回最终的结果</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>💡 不传参数时，<code>path.resolve()</code> 返回当前工作路径，相当于 <code>process.cwd()</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cwd</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// &#39;/usr/local&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// &#39;/usr/local&#39;</span></span></code></pre></div></div><p>🤩🌰一个或多个相对路径用于解析,以CWD作为开始：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr/local&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">bin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr/local/bin&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./bin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr/local/bin/sub&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../lib</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">log</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;&#39;/usr/lib/log&#39;&#39;</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>🚨<strong>任何全限定路径都会替代先前的结果</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home&#39; 是全限定路径</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">bin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home&#39;</span></span></code></pre></div></div><p>这使我们能够根据完全限定路径解析部分限定路径：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;/home/john&#39; 全限定路径</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;proj&#39; &amp; &#39;src&#39; 部分限定路径</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">proj</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">src</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/john/proj/src&#39;</span></span></code></pre></div><h3 id="_4-2-path-join-拼接路径-同时保留相对路径" tabindex="-1">4.2 path.join()：拼接路径，同时保留相对路径 <a class="header-anchor" href="#_4-2-path-join-拼接路径-同时保留相对路径" aria-label="Permalink to &quot;4.2 path.join()：拼接路径，同时保留相对路径&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">path: Array</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">): string</span></span></code></pre></div><p>从 <code>paths[0]</code> 开始，并将剩余的路径解释为升序（<code>Ascending</code>）或降序（<code>Descending</code>）指令。相比于 <code>path.resolve()</code>，这个函数 <strong>保留部分限定路径</strong>。</p><ul><li>如果 <code>paths[0]</code> 是一个部分限定路径，则其结果为部分限定路径</li><li>如果 <code>path[0]</code> 是一个完全限定路径，其结果为完全限定路径</li></ul><p>🤩🌰：(降序)</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#676E95;font-style:italic;">// paths[0] 为 &#39;/usr/local&#39;，它是一个完全限定路径，其结果也为完全限定</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">subsub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr/local/sub/subsub&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// paths[0] 为 &#39;relative/dir&#39;，它是一个部分限定路径，其结果也为部分限定</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">relative/dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">subsub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;relative/dir/sub/subsub&#39;</span></span></code></pre></div><p><code>..</code> 升序：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">relative/dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">..</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;relative&#39;</span></span></code></pre></div><p><code>.</code> 没有效果：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr/local&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">relative/dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;relative/dir&#39;</span></span></code></pre></div><p>🚨 <strong>如果第2个或之后的参数为完全限定路径，则它们会被翻译为相对路径</strong>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;dir/tmp&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;dir\\C:\\Users&#39;</span></span></code></pre></div><p>多余2个参数：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../lib</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">log</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr/lib/log&#39;</span></span></code></pre></div><h2 id="_5️⃣-确保路径是标准化的、完全限定的或相对的" tabindex="-1">5️⃣ 确保路径是标准化的、完全限定的或相对的 <a class="header-anchor" href="#_5️⃣-确保路径是标准化的、完全限定的或相对的" aria-label="Permalink to &quot;5️⃣ 确保路径是标准化的、完全限定的或相对的&quot;">​</a></h2><h3 id="_5-1-path-normalize-确保路径标准化" tabindex="-1">5.1 path.normalize()：确保路径标准化 <a class="header-anchor" href="#_5-1-path-normalize-确保路径标准化" aria-label="Permalink to &quot;5.1 path.normalize()：确保路径标准化&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(path: string): string</span></span></code></pre></div><p><code>Unix</code>中 <code>path.normalize()</code>:</p><ul><li>移除一个点（<code>.</code>）的 path segments</li><li>解析2个点（<code>..</code>）的path segments</li><li>将多个 path separators（<code>/</code>） 转换为一个 path separators</li></ul><p>🌰:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 完全限定路径</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/./john/lib/../photos//pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/photos/pet</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 部分限定路径</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./john/lib/../photos//pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./john/photos/pet</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><code>Windows</code> 中 <code>path.normalize()</code>:</p><ul><li>移除一个点（<code>.</code>）的 path segments</li><li>解析2个点（<code>..</code>）的path segments</li><li>将每个path separator slash（<code>/</code>）- 这是合法的 - 转换为更偏好的path separator（<code>\</code>）</li><li>将超过1个的path separator转换为一个blackslash</li></ul><p>🌰:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 完全限定路径</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users/jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">doc</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">..</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">src</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">src</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 部分限定路径</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">doc</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">..</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">src</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">src</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>🚨 <code>path.join()</code> 传入一个参数也会标准化，效果和 <code>path.normalize()</code> 一样：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/./join/lib/../photos///pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/join/photos/pet&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/./join/lib/../photos///pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/join/photos/pet&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./join/lib/../photos///pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;join/photos/pet&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./join/lib/../photos///pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;join/photos/pet&#39;</span></span></code></pre></div></div><h3 id="_5-2-path-resolve-一个参数-确保路径标准化和完全限定" tabindex="-1">5.2 path.resolve()（一个参数）：确保路径标准化和完全限定 <a class="header-anchor" href="#_5-2-path-resolve-一个参数-确保路径标准化和完全限定" aria-label="Permalink to &quot;5.2 path.resolve()（一个参数）：确保路径标准化和完全限定&quot;">​</a></h3><p><code>path.resolve()</code> 只传一个参数时，它标准化路径的同时，也会确保其完全限定。</p><p>Unix中使用 <code>path.resolve()</code>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cwd</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/usr/local&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/./john/lib/../photos///pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/join/photos/pet&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./join/lib/../photos///pet</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;/usr/local/join/photos/pet&#39;  // 💡 标准化 + 完全限定</span></span></code></pre></div><p>Windows中使用 <code>path.resolve()</code>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cwd</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Windows\\System&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users/jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">doc</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">..</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">src</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\jane\\proj\\src&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">doc</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">..</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">proj</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">src</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Windows\\System\\jane\\proj\\src&#39;</span></span></code></pre></div><h3 id="_5-3-⭐-path-relative-创建相对路径" tabindex="-1">5.3 ⭐ path.relative()：创建相对路径 <a class="header-anchor" href="#_5-3-⭐-path-relative-创建相对路径" aria-label="Permalink to &quot;5.3 ⭐ path.relative()：创建相对路径&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relative</span><span style="color:#A6ACCD;">(sourcePath: string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> destinationPath: string): string</span></span></code></pre></div><p>从 <code>sourcePath</code> 到 <code>destinationPath</code> 得到一个相对路径：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relative</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/join/proj/my-lib/README.md</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;proj/my-lib/README.md&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relative</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/proj/my-lib/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/doc/zsh.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;../../doc/zsh.txt&#39;</span></span></code></pre></div><p>在windows上，如果 <code>sourcePath</code> 和 <code>destinationPath</code> 的驱动字符不一样，则返回一个完全限定的路径：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relative</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Z:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">tmp</span><span style="color:#A6ACCD;">\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\Jane\\&#39;</span></span></code></pre></div><p>对相对路径也一样：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relative</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">proj/my-lib/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">doc/zsh.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;../../doc/zsh.txt&#39;</span></span></code></pre></div><h2 id="_6️⃣-⭐-解析路径-提取路径的各个部分-文件名扩展等" tabindex="-1">6️⃣ ⭐ 解析路径：提取路径的各个部分（文件名扩展等） <a class="header-anchor" href="#_6️⃣-⭐-解析路径-提取路径的各个部分-文件名扩展等" aria-label="Permalink to &quot;6️⃣ ⭐ 解析路径：提取路径的各个部分（文件名扩展等）&quot;">​</a></h2><h3 id="_6-1-path-parse-创建包含path各部分的对象" tabindex="-1">6.1 path.parse(): 创建包含path各部分的对象 <a class="header-anchor" href="#_6-1-path-parse-创建包含path各部分的对象" aria-label="Permalink to &quot;6.1 path.parse(): 创建包含path各部分的对象&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PathObject</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">dir</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  	</span><span style="color:#F07178;">root</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">base</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  	</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  	</span><span style="color:#F07178;">ext</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">path</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">parse</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PathObject</span></span></code></pre></div><p>提取 <code>path</code> 的各个部分，返回对象形式：</p><ul><li><code>.base</code>：路径的最后一段 <ul><li><code>.ext</code>: base的文件名扩展</li><li><code>.name</code>: 没有扩展的base。这部分也称为路径的茎（<code>stem</code>）</li></ul></li><li><code>root</code>： 路径的开始（在第一段前的部分）</li><li><code>.dir</code>：base所在的目录 - 不包含base部分的路径</li></ul><h4 id="_6-1-1-path-parse-unix例子" tabindex="-1">6.1.1 path.parse() Unix例子 <a class="header-anchor" href="#_6-1-1-path-parse-unix例子" aria-label="Permalink to &quot;6.1.1 path.parse() Unix例子&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 得到如下对象</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">dir</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#FFCB6B;">root</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">base</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">ext</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>🚀🚀 下图可视化各部分：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">/</span><span style="color:#A6ACCD;">      </span><span style="color:#C3E88D;">home/jane</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">file</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">.txt</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">root</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ext</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">dir</span><span style="color:#A6ACCD;">              </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">base</span><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">|</span></span></code></pre></div><p>可以看出，<code>.dir</code> 是不包含 <code>base</code> 部分，而 <code>base = name + ext</code>。</p><h4 id="_6-1-2-path-parse-windows例子" tabindex="-1">6.1.2 path.parse() Windows例子 <a class="header-anchor" href="#_6-1-2-path-parse-windows例子" aria-label="Permalink to &quot;6.1.2 path.parse() Windows例子&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">String</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">raw</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\U</span><span style="color:#C3E88D;">sers</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">ohn</span><span style="color:#A6ACCD;">\f</span><span style="color:#C3E88D;">ile.txt</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 得到如下对象</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">dir</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">john</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">root</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">base</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">ext</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>下图可视化各部分：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\</span><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">ohn</span><span style="color:#A6ACCD;"> \ </span><span style="color:#C3E88D;">file</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">.txt</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">root</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ext</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">dir</span><span style="color:#A6ACCD;">               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">base</span><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">|</span></span></code></pre></div><h3 id="_6-2-path-basename-提取路径的base部分" tabindex="-1">6.2 path.basename(): 提取路径的base部分 <a class="header-anchor" href="#_6-2-path-basename-提取路径的base部分" aria-label="Permalink to &quot;6.2 path.basename(): 提取路径的base部分&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(path</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ext</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>返回路径的base部分：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// file.txt</span></span></code></pre></div><p>可选的，这个函数可以移除后缀：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;file&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;file.&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;file.t&#39;</span></span></code></pre></div><h3 id="_6-3-path-dirname-提取路径的父目录" tabindex="-1">6.3 path.dirname()：提取路径的父目录 <a class="header-anchor" href="#_6-3-path-dirname-提取路径的父目录" aria-label="Permalink to &quot;6.3 path.dirname()：提取路径的父目录&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#A6ACCD;">(path)</span></span></code></pre></div><p>返回文件或者目录的父目录：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">String</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">raw</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\U</span><span style="color:#C3E88D;">sers</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">ohn</span><span style="color:#A6ACCD;">\f</span><span style="color:#C3E88D;">ile.txt</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\john&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">john</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">dir</span><span style="color:#A6ACCD;">\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;C:\\Users\\john&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/jane&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/jane&#39;</span></span></code></pre></div><h3 id="_6-4-path-extname-提取路径的扩展" tabindex="-1">6.4 path.extname()：提取路径的扩展 <a class="header-anchor" href="#_6-4-path-extname-提取路径的扩展" aria-label="Permalink to &quot;6.4 path.extname()：提取路径的扩展&quot;">​</a></h3><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extname</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;.txt&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extname</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// &#39;.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extname</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extname</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;&#39;</span></span></code></pre></div><h2 id="_7️⃣-path-isabsolute-是否为绝对路径" tabindex="-1">7️⃣ <code>path.isAbsolute()</code> ：是否为绝对路径？ <a class="header-anchor" href="#_7️⃣-path-isabsolute-是否为绝对路径" aria-label="Permalink to &quot;7️⃣ `path.isAbsolute()` ：是否为绝对路径？&quot;">​</a></h2><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#A6ACCD;">(path: string): boolean</span></span></code></pre></div><p>如果为绝对路径，返回 <code>true</code>，否则返回 <code>false</code>。</p><p>Unix上的结果很直白：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">john</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><p>Windows上，<code>绝对</code> 不意味着必须是 <code>完全限定的</code>（只需要第一路径时完全限定）：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">ane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><h2 id="_8️⃣-path-format-使用path-parts创建路径" tabindex="-1">8️⃣ <code>path.format()</code>：使用path parts创建路径 <a class="header-anchor" href="#_8️⃣-path-format-使用path-parts创建路径" aria-label="Permalink to &quot;8️⃣ `path.format()`：使用path parts创建路径&quot;">​</a></h2><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PathObject</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">dir</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  	</span><span style="color:#F07178;">root</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">base</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  	</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  	</span><span style="color:#F07178;">ext</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">path</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">format</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">pathObject</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PathObject</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sring</span></span></code></pre></div><p>依据路径对象创建路径：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">format</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">dir</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">base</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/home/jane/file.txt&#39;</span></span></code></pre></div><h3 id="_8-1-例子-改变文件扩展" tabindex="-1">8.1 例子：改变文件扩展 <a class="header-anchor" href="#_8-1-例子-改变文件扩展" aria-label="Permalink to &quot;8.1 例子：改变文件扩展&quot;">​</a></h3><p>我们可以使用 <code>path.format()</code> 改变路径的扩展：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">changeFilenameExtension</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">pathstr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">newExtension</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">newExtension</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">startsWith</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Extension must start with a dot: </span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">                    </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">newExtension</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parts</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">pathstr</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 先解析为PathObject对象</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">format</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">              </span><span style="color:#676E95;font-style:italic;">// 然后再创建路径</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">parts</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    base</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">undefined,</span><span style="color:#F07178;">                </span><span style="color:#676E95;font-style:italic;">// 阻止 .base 覆盖 .name &amp; .ext</span></span>
<span class="line"><span style="color:#F07178;">    ext</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newExtension</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">changeFilenameExtension</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file.md</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">changeFilenameExtension</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">changeFilenameExtension</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>💡如果我们已经知道了文件扩展，可以使用正则直接替换：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file.md</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">\.</span><span style="color:#C3E88D;">md</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">i</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/tmp/file.html&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file.MD</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">\.</span><span style="color:#C3E88D;">md</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">i</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;/tmp/file.html</span></span></code></pre></div><h2 id="_9️⃣-在不同平台使用相同路径" tabindex="-1">9️⃣ 在不同平台使用相同路径 <a class="header-anchor" href="#_9️⃣-在不同平台使用相同路径" aria-label="Permalink to &quot;9️⃣ 在不同平台使用相同路径&quot;">​</a></h2><p>有时我们想在不同平台使用相同路径。因此我们将面临2个问题：</p><ol><li>path separtor可能不相同</li><li>文件结构可能不相同：home目录和临时目录可能在不同位置等</li></ol><p>比如，一个Node应用操作data目录。我们假设应用可以配置2种类型路径：</p><ol><li>系统中任意位置的完全限定路径</li><li>在data目录下的路径</li></ol><p>因为前面的问题：</p><ul><li>我们不能在不同平台复用完全限定目录： <ul><li>有时我们需要绝对路径。它们必须在每个data目录实例进行配置，并且存储在外部（或在内部然后通过git忽略它们）。这些路径不随data目录移动</li></ul></li><li>我们可以重用指向data目录的路径。此类路径可能存储在配置文件中（是否在data目录中）和应用程序代码的常量中。为了这样： <ul><li>我们必须以相对路径的形式进行存储</li><li>我们必须确保path separator在各个平台是正确的</li></ul></li></ul><p>下面解释如何实现。</p><h3 id="_9-1-相对平台独立的路径" tabindex="-1">9.1 相对平台独立的路径 <a class="header-anchor" href="#_9-1-相对平台独立的路径" aria-label="Permalink to &quot;9.1 相对平台独立的路径&quot;">​</a></h3><p>😎相对平台独立的路径可以以path segments数组的形式进行存储，然后转换为完全限定平台指定的路径，如下：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> universalRelativePath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">static</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">img</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">logo.jpg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> dataDirUnix </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/data-dir</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">posix</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(dataDirUnix</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">universalRelativePath)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/data-dir/static/img/logo.png</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> dataDirWindows </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">data-dir</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">win32</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(dataDirWindows</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">universalRelativePath)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">Users</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">jane</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">data-dir</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">static</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">img</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">logo.jpg</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>为了创建相对平台指定路径，我们可以使用：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> dataDir </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/data-dir</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> pathInDataDir </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/data-dir/static/img/logo.jpg</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">relative</span><span style="color:#A6ACCD;">(dataDir</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> pathInDataDir)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">static/img/logo.jpg</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>🔥以下函数将特定于平台的相对路径转换为独立于平台的路径：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">splitRelativePathIntoSegments</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">relPath</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isAbsolute</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">relPath</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">路径不是相对的：</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">relPath</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">relPath</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">relPath</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 标准化路径</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> []</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">base</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">relPath</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// base部分</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">base</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">unshift</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">base</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dir</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">relPath</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 目录部分</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">dir</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">relPath</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dir</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>Unix上使用 <code>splitRelativePathIntoSegments()</code>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">splitRelativePathIntoSegments</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">static/img/logo.jpg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [&#39;static&#39;, &#39;img&#39;, &#39;logo.jpg&#39;]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">splitRelativePathIntoSegments</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [&#39;file.txt&#39;]</span></span></code></pre></div><p>Windows上使用 <code>splitRelativePathIntoSegments()</code>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">splitRelativePathIntoSegments</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">static/img/logo.jpg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [ &#39;static&#39;, &#39;img&#39;, &#39;logo.jpg&#39; ]</span></span>
<span class="line"><span style="color:#82AAFF;">splitRelativePathIntoSegments</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:static/img/logo.jpg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [ &#39;static&#39;, &#39;img&#39;, &#39;logo.jpg&#39; ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">splitRelativePathIntoSegments</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [ &#39;file.txt&#39; ]</span></span>
<span class="line"><span style="color:#82AAFF;">splitRelativePathIntoSegments</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [ &#39;file.txt&#39; ]</span></span></code></pre></div><h2 id="🔟-使用第三方库匹配路径-通过globs" tabindex="-1">🔟 使用第三方库匹配路径，通过globs <a class="header-anchor" href="#🔟-使用第三方库匹配路径-通过globs" aria-label="Permalink to &quot;🔟 使用第三方库匹配路径，通过globs&quot;">​</a></h2><p><a href="https://github.com/isaacs/minimatch" target="_blank" rel="noreferrer">minimatch</a> 允许我们通过模式匹配路径，称之为 <code>glob expressions | glob patterns | globs</code>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> monimatch </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">minimatch</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/sub/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/sub/*.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/sub/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/**/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>globs的使用场景：</p><ul><li>指定目录中的哪些文件可以被脚本处理</li><li>指定哪些文件被忽略</li></ul><p>更多globs库：</p><ul><li><a href="https://github.com/sindresorhus/multimatch" target="_blank" rel="noreferrer">multimatch</a> 扩展了minimatch，并支持多个模式</li><li><a href="https://github.com/micromatch/micromatch" target="_blank" rel="noreferrer">micromatch</a> 是minimatch &amp; multimatch的替代品，拥有相似的API</li><li><a href="https://github.com/sindresorhus/globby" target="_blank" rel="noreferrer">globby</a> 基于 <a href="https://github.com/mrmlnc/fast-glob" target="_blank" rel="noreferrer">fast-glob</a>，并增加了便利的功能</li></ul><h3 id="_10-1-minimatch-api" tabindex="-1">10.1 minimatch API <a class="header-anchor" href="#_10-1-minimatch-api" aria-label="Permalink to &quot;10.1 minimatch API&quot;">​</a></h3><p>完整API可阅读其 <a href="https://github.com/isaacs/minimatch" target="_blank" rel="noreferrer">readme</a>。后面看看其最重要的功能。</p><p>📚 <strong>minimatch将globs编译为正则对象，并使用它进行匹配</strong>。</p><h4 id="_10-1-1-minimatch-编译和匹配一次" tabindex="-1">10.1.1 minimatch()：编译和匹配一次 <a class="header-anchor" href="#_10-1-1-minimatch-编译和匹配一次" aria-label="Permalink to &quot;10.1.1 minimatch()：编译和匹配一次&quot;">​</a></h4><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  path: string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  glob: string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  options</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> MinimatchOptions</span></span>
<span class="line"><span style="color:#A6ACCD;">): boolean</span></span></code></pre></div><p>如果 <code>glob</code> 匹配上了 <code>path</code>，则返回 <code>true</code>，否则返回 <code>false</code>。</p><p>2个有趣的配置项：</p><ul><li><p><code>dot: boolean</code> (默认 <code>false</code>): 如果为 <code>true</code>，通配符号 <code>*</code> &amp; <code>**</code> 能匹配不可见的路径片段（以点开头的）</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local/.tmp/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/**/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local/.tmp/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/**/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">dot</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/.log/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/*/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/.log/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/*/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">dot</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div></li><li><p><code>matchBase: boolean</code> (默认 <code>false</code>)： 如果为 <code>true</code>，没有slashes的模式能匹配路径basename</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">matchBase</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div></li></ul><h4 id="_10-1-2-new-minimatch-minimatch-编译一次-匹配多次" tabindex="-1">10.1.2 new minimatch.Minimatch()：编译一次，匹配多次 <a class="header-anchor" href="#_10-1-2-new-minimatch-minimatch-编译一次-匹配多次" aria-label="Permalink to &quot;10.1.2 new minimatch.Minimatch()：编译一次，匹配多次&quot;">​</a></h4><p>类 <code>minimatch.Minimatch</code> 使我们只将glob编译为正则一次，然后可以匹配多:</p><p>📒：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Minimatch</span><span style="color:#A6ACCD;">(pattern: string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> options</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> MinimatchOptions)</span></span></code></pre></div><p>下面是用法：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> minimatch </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">minimatch</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> Minimatch </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> minimatch</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> glob </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/sub/*txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  glob</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">match</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/sub/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  glob</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">match</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/sub/notes.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="_10-2-glob表达式语法" tabindex="-1">10.2 glob表达式语法 <a class="header-anchor" href="#_10-2-glob表达式语法" aria-label="Permalink to &quot;10.2 glob表达式语法&quot;">​</a></h3><p>后面小节覆盖基本语法。更多功能可查看文档：</p><ul><li><a href="https://github.com/isaacs/minimatch/tree/main/test" target="_blank" rel="noreferrer">minimatch单元测试</a> 有很多globs示例</li><li>Bash手册有个<a href="https://www.gnu.org/software/bash/manual/bash.html#Filename-Expansion" target="_blank" rel="noreferrer">文件名扩展</a> 小节</li></ul><h4 id="_10-2-1-匹配windows路径" tabindex="-1">10.2.1 匹配Windows路径 <a class="header-anchor" href="#_10-2-1-匹配windows路径" aria-label="Permalink to &quot;10.2.1 匹配Windows路径&quot;">​</a></h4><p>即使在windows上，glob片段也是通过 <code>/</code> 分割的 - 但它同时匹配 <code>\</code> 和 <code>/</code>(在Windows上也是合法的路径separators)</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">sub/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><h4 id="_10-2-2-minimatch不会标准化路径" tabindex="-1">10.2.2 Minimatch不会标准化路径 <a class="header-anchor" href="#_10-2-2-minimatch不会标准化路径" aria-label="Permalink to &quot;10.2.2 Minimatch不会标准化路径&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><p>因此我们没有自己创建路径时，必须标准化路径：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">normalize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;file.txt&#39;</span></span></code></pre></div><h4 id="_10-2-3-没有通配符的模式-path-separators必须是一条线" tabindex="-1">10.2.3 没有通配符的模式：path separators必须是一条线 <a class="header-anchor" href="#_10-2-3-没有通配符的模式-path-separators必须是一条线" aria-label="Permalink to &quot;10.2.3 没有通配符的模式：path separators必须是一条线&quot;">​</a></h4><p>没有通配符的模式必须精确匹配。特别是path separators必须是一条线：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 💡 语法：minimatch(path, glob)</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><p>即，我们必须决定要么是绝对路径，要么是相对路径。</p><p>使用配置 <code>.matchBase</code>，我们可以对路径的basenames上匹配不带斜杠的模式:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">matchBase</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><h4 id="_10-2-4-⭐-匹配任意单一片段" tabindex="-1">10.2.4 ⭐ <code>*</code> 匹配任意单一片段 <a class="header-anchor" href="#_10-2-4-⭐-匹配任意单一片段" aria-label="Permalink to &quot;10.2.4 ⭐ `*` 匹配任意单一片段&quot;">​</a></h4><p>通配符 <code>*</code> 匹配任意路径片段或片段的任意部分：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 匹配任意路径片段</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/*/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/*/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 匹配片段任意部分</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/*t.xt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/data.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/*.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><code>*</code> 并不会匹配 <em>不可见文件</em>，即以 <code>.</code> 开头名字。如果我们像匹配，则必须在 <code>*</code> 添加 <code>.</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.gitignore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.gitignore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/.log/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/*/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><p>或者使用 <code>.dot</code> 配置关闭这种行为：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.gitignore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">dot</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/.log/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/*/events.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">dot</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div></div><h4 id="_10-2-5-⭐-匹配0或多个片段" tabindex="-1">10.2.5 ⭐ <code>**</code> 匹配0或多个片段 <a class="header-anchor" href="#_10-2-5-⭐-匹配0或多个片段" aria-label="Permalink to &quot;10.2.5 ⭐ `**` 匹配0或多个片段&quot;">​</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 匹配0或多个片段😎</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/**/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/**/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/dir/sub/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/**/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><p>如果我们想匹配相对路径，模式不能以path separator开头：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/**/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><p><code>**</code> 也不匹配 <strong>不可见</strong> 路径片段（以点开头的）</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local/.tmp/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/**/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><p>可以使用 <code>.dot</code> 配置：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/local/.tmp/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/usr/**/data.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">dot</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><h4 id="_10-2-6-⭐-否定globs" tabindex="-1">10.2.6 ⭐ 否定globs <a class="header-anchor" href="#_10-2-6-⭐-否定globs" aria-label="Permalink to &quot;10.2.6 ⭐ 否定globs&quot;">​</a></h4><p>如果glob以 <code>!</code> 开头，只有感叹号后面的模式没有匹配上时才能匹配：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">!**/*.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">!**/*.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><h4 id="_10-2-7-可选匹配" tabindex="-1">10.2.7 可选匹配 <a class="header-anchor" href="#_10-2-7-可选匹配" aria-label="Permalink to &quot;10.2.7 可选匹配&quot;">​</a></h4><p>使用在大括号用逗号分割多个模式，只许某个模式匹配了即可：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.{txt,js}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file.{txt,js}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><h4 id="_10-2-8-整数区间" tabindex="-1">10.2.8 整数区间 <a class="header-anchor" href="#_10-2-8-整数区间" aria-label="Permalink to &quot;10.2.8 整数区间&quot;">​</a></h4><p>一组被 <code>..</code> 分割的整数定义证书秋季，匹配其中任意元素：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file1.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{1..3}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file2.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{1..3}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file3.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{1..3}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line highlighted"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file4.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{1..3}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// false</span></span></code></pre></div><p>也支持填充 <code>0</code>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file1.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{01..12}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// false</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file01.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{01..12}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file02.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{01..12}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#82AAFF;">minimatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file12.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file{01..12}.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// true</span></span></code></pre></div><h2 id="_1️⃣1️⃣-使用-file-urls-引用文件" tabindex="-1">1️⃣1️⃣ 使用 file:URLs 引用文件 <a class="header-anchor" href="#_1️⃣1️⃣-使用-file-urls-引用文件" aria-label="Permalink to &quot;1️⃣1️⃣ 使用 file:URLs 引用文件&quot;">​</a></h2><p>在Node.js中有2种常见方式引用文件：</p><ol><li>字符串路径</li><li>URL实例，使用 <code>file:</code> 协议</li></ol><p>🌰：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/data.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  )</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file:///tmp/data.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  )</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="_11-1-url类" tabindex="-1">11.1 URL类 <a class="header-anchor" href="#_11-1-url类" aria-label="Permalink to &quot;11.1 URL类&quot;">​</a></h3><p>这一小节我们仔细看看URL类，更多：</p><ul><li>Node文档 <a href="https://nodejs.org/api/url.html#the-whatwg-url-api" target="_blank" rel="noreferrer">The WHATWG URL API</a></li><li>WHATWG URL标准 <a href="https://url.spec.whatwg.org/#api" target="_blank" rel="noreferrer">API</a></li></ul><p>这篇文章中，我们通过全局变量的形式使用URL类，因为这就是Web平台的使用方式，但你也可以导入：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">URL</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:url</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><h4 id="_11-1-1-uris-vs-相对引用" tabindex="-1">11.1.1 URIs vs. 相对引用 <a class="header-anchor" href="#_11-1-1-uris-vs-相对引用" aria-label="Permalink to &quot;11.1.1 URIs vs. 相对引用&quot;">​</a></h4><p>👩🏻‍🏫 URLs是URIs子集：</p><ul><li>URI以 <a href="https://datatracker.ietf.org/doc/html/rfc3986#section-3.1" target="_blank" rel="noreferrer">scheme</a> 开头，后面跟着 <code>:</code></li><li>所有其它URl引用都是 <em>相对引用</em></li></ul><h4 id="_11-1-2-url构造器" tabindex="-1">11.1.2 URL构造器 <a class="header-anchor" href="#_11-1-2-url构造器" aria-label="Permalink to &quot;11.1.2 URL构造器&quot;">​</a></h4><p>URL类有2种实例化方式：</p><ul><li><code>new URL(uri: string)</code>: uri必须是一个 URI。它指定新实例的URI。</li><li><code>new URL(uriRef: string, baseUri: string)</code>:<code>baseUri </code>必须是一个 URI。如果 <code>uriRef</code> 是一个相对引用，它会针对 <code>baseUri</code> 进行解析，结果将成为新实例的 URI。如果 <code>uriRef</code> 是一个 URI，它将完全取代 <code>baseUri</code> 作为实例所基于的数据。</li></ul><p>🌰：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 如果只有一个参数，则必须是一个合适的URI</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/public/page.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/public/page.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">throws</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../book/toc.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;font-style:italic;">^</span><span style="color:#C3E88D;">TypeError </span><span style="color:#A6ACCD;">\[</span><span style="color:#C3E88D;">ERR_INVALID_URL</span><span style="color:#A6ACCD;">\]</span><span style="color:#C3E88D;">: Invalid URL</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 解析针对 baseURI 的相对引用</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../book/toc.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/public/page.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  )</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/book/toc.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="_11-1-3-对url实例解析相对引用" tabindex="-1">11.1.3 对URL实例解析相对引用 <a class="header-anchor" href="#_11-1-3-对url实例解析相对引用" aria-label="Permalink to &quot;11.1.3 对URL实例解析相对引用&quot;">​</a></h4><p>我们先回顾一下URL下面的这个构造器：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(uriRef: string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> baseUri: string)</span></span></code></pre></div><p>参数 <code>baseUri</code> 会强转为字符串。因此任何强转为字符串后仍有些的URL的对象都可被使用：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> obj </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">toString</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 返回一个合法的URL字符串</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">index.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> obj)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/index.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>这使我们能够解析针对 URL 实例的相对引用：😎</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/dir/file1.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../file2.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> url)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/file2.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>这种使用方式，构造器和 <code>path.resolve()</code> 很相似。</p><h4 id="_11-1-4-⭐-url实例属性" tabindex="-1">11.1.4 ⭐ URL实例属性 <a class="header-anchor" href="#_11-1-4-⭐-url实例属性" aria-label="Permalink to &quot;11.1.4 ⭐ URL实例属性&quot;">​</a></h4><p>URL实例有如下属性:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">URL</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">protocol</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">username</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">host</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">readonly</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">origin</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pathname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">search</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">readonly</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">searchParams</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">URLSearchParams</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">hash</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">href</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">toString</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">toJSON</span><span style="color:#89DDFF;">():</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="_11-1-5-将urls转换为字符串" tabindex="-1">11.1.5 将URLs转换为字符串 <a class="header-anchor" href="#_11-1-5-将urls转换为字符串" aria-label="Permalink to &quot;11.1.5 将URLs转换为字符串&quot;">​</a></h4><p>3种常用方式转换URL -&gt; 字符串：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/about.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/about.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/about.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toJSON</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/about.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><code>.toJSON()</code> 方法使我们能在JSON数据中使用URLs：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> jsonStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pageUrl</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://2ality.com/p/subscribe.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  jsonStr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;pageUrl&quot;:&quot;https://2ality.com/p/subscribe.html&quot;}</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="_11-1-6-获取url属性" tabindex="-1">11.1.6 获取URL属性 <a class="header-anchor" href="#_11-1-6-获取url属性" aria-label="Permalink to &quot;11.1.6 获取URL属性&quot;">​</a></h4><p>👩‍🏫 <strong>URL实例没有数据属性，它们都是访问器属性。</strong></p><p>下例中，我们使用 <code>pickProps()</code> 工具函数将getters返回值拷贝到普通对象中：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> props </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">pickProps</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://jane:pw@example.com:80/news.html?date=today#misc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">protocol</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">username</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">password</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hostname</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">port</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">host</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">origin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pathname</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">search</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hash</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">href</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  props</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">protocol</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">username</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">jane</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pw</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">example.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">80</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">host</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">example.com:80</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">origin</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com:80</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">pathname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/news.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">search</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">?date=today</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">hash</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#misc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">href</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://jane:pw@example.com:80/news.html?date=today#misc</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">pickProps</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">input</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;font-style:italic;">keys</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">output</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">keys</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">output</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">input</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">output</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>注意，<code>pathname</code> 是一个单一的原子单元。即，不能使用类URL访问其部分（base, extension等）。</p><h4 id="_11-1-7-设置url部分" tabindex="-1">11.1.7 设置URL部分 <a class="header-anchor" href="#_11-1-7-设置url部分" aria-label="Permalink to &quot;11.1.7 设置URL部分&quot;">​</a></h4><p>我们可以通过设置属性的方式改变URL的部分，比如 <code>.hostname</code>：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hostname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2ality.com</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://2ality.com/</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>我们可以使用setter从部分创建url：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Object.assign() 调用setters，当转移属性值时</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> urlFromParts </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">parts</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> Object</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">assign</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// minimal dummy URL</span></span>
<span class="line"><span style="color:#A6ACCD;">  parts </span><span style="color:#676E95;font-style:italic;">// assigned to the dummy</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">urlFromParts</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">protocol</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">hostname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2ality.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pathname</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/p/about.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://2ality.com/p/about.html</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="_11-1-8-通过-searchparams-管理搜索参数" tabindex="-1">11.1.8 通过 .searchParams 管理搜索参数 <a class="header-anchor" href="#_11-1-8-通过-searchparams-管理搜索参数" aria-label="Permalink to &quot;11.1.8 通过 .searchParams  管理搜索参数&quot;">​</a></h4><p>可以使用 <code>.searchParams</code> 属性管理URLs的搜索参数。它的值是 <a href="https://nodejs.org/api/url.html#class-urlsearchparams" target="_blank" rel="noreferrer">URLSearchParams</a> 实例。</p><p>我们可以用它读取搜索参数：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/?topic=js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">searchParams</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">topic</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">searchParams</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">has</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">topic</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>我们也可通过它改变搜索参数：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">searchParams</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">5</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/?topic=js&amp;page=5</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">searchParams</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">topic</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">css</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://example.com/?topic=css&amp;page=5</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="_11-2-⭐-urls和文件路径间转换" tabindex="-1">11.2 ⭐ URLs和文件路径间转换 <a class="header-anchor" href="#_11-2-⭐-urls和文件路径间转换" aria-label="Permalink to &quot;11.2 ⭐ URLs和文件路径间转换&quot;">​</a></h3><p>手动在文件路径和URLs之间转换很常见。比如，将URL实例 <code>myUrl</code>通过 <code>myUrl.pathname</code> 转换为文件路径。但是这并不是总生效 - 最好使用 <a href="https://nodejs.org/api/url.html#urlfileurltopathurl" target="_blank" rel="noreferrer">fileURLToPath</a> 这个函数：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fileURLToPath</span><span style="color:#A6ACCD;">(url: URL </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> string): string</span></span></code></pre></div><p>下面代码比较这个函数的结果和 <code>.pathname</code>值：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> assert </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">assert</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:url</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// Unix</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file:///tmp/with%20space.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url1</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">pathname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/with%20space.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fileURLToPath</span><span style="color:#A6ACCD;">(url1)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/with space.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file:///home/thor/Mj%C3%B6lnir.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url2</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">pathname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/thor/Mj%C3%B6lnir.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fileURLToPath</span><span style="color:#A6ACCD;">(url2)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/thor/Mjölnir.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// Windows</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> url3 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file:///C:/dir/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url3</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">pathname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/C:/dir/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fileURLToPath</span><span style="color:#A6ACCD;">(url3)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">dir</span><span style="color:#A6ACCD;">\\</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><a href="https://nodejs.org/api/url.html#url_url_pathtofileurl_path" target="_blank" rel="noreferrer">pathToFileURL</a> 则是 <code>url.fileURLToPath()</code> 的反向过程</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">pathToFileURL</span><span style="color:#A6ACCD;">(path: string): URL</span></span></code></pre></div><p>它将路径转换为文件URL：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">pathToFileURL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home/john/Work Files</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;file:///home/john/Work%20Files&#39;</span></span></code></pre></div><h3 id="_11-3-⭐-urls使用场景-相对于当前模块访问文件" tabindex="-1">11.3 ⭐ URLs使用场景：相对于当前模块访问文件 <a class="header-anchor" href="#_11-3-⭐-urls使用场景-相对于当前模块访问文件" aria-label="Permalink to &quot;11.3 ⭐ URLs使用场景：相对于当前模块访问文件&quot;">​</a></h3><p>📚多用于 <code>EMS</code>模块中。</p><p>URL 的一个重要场景是访问与当前模块同级的文件：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">readData</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">data.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><a href="https://exploringjs.com/impatient-js/ch_modules.html#import%2Emeta.url-on-node.js" target="_blank" rel="noreferrer">i<wbr>mport.meta.url</a> 包含当前模块的URL，在Node中它使用文件URL。</p><p>使用 <code>fetch()</code> 可使上面代码更加跨平台。但是，Node18.5，<code>fetch()</code> 还不支持 文件URL:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">fetch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file:///tmp/file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// TypeError: fetch failed</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//  cause: Error: not implemented... yet...</span></span></code></pre></div><h3 id="_11-4-urls使用场景-检测当前模块是否以脚本形式运行" tabindex="-1">11.4 URLs使用场景：检测当前模块是否以脚本形式运行 <a class="header-anchor" href="#_11-4-urls使用场景-检测当前模块是否以脚本形式运行" aria-label="Permalink to &quot;11.4 URLs使用场景：检测当前模块是否以脚本形式运行&quot;">​</a></h3><p>可查看：</p><ul><li><a href="https://2ality.com/2022/07/nodejs-esm-main.html" target="_blank" rel="noreferrer">blog: Node.js: checking if an ESM module is &#39;main&#39;</a></li></ul><h3 id="_11-5-paths-vs-file-urls" tabindex="-1">11.5 Paths vs file:URLs <a class="header-anchor" href="#_11-5-paths-vs-file-urls" aria-label="Permalink to &quot;11.5 Paths vs file:URLs&quot;">​</a></h3><p>当shell脚本接收对文件的引用或者导出对文件的引用（比如：通过在屏幕上打印它们），它们实际上总是路径。然而，有两种情况下我们需要url(在前面的小节中讨论过):</p><ul><li>访问相对于当前模块的文件</li><li>来检测当前模块是否作为脚本运行</li></ul><p>原文链接：</p><ul><li><a href="https://2ality.com/2022/07/nodejs-path.html#path.format()%3A-creating-paths-out-of-parts" target="_blank" rel="noreferrer">Working with file system paths on Node.js - Dr.Axel Rauschmayer</a></li></ul><p>2022年08月10日21:46:33</p></div></div></main><footer class="VPDocFooter" data-v-e08fe318 data-v-39c03cd7><!--[--><!--]--><div class="edit-info" data-v-39c03cd7><div class="edit-link" data-v-39c03cd7><a class="VPLink link edit-link-button" href="https://github.com/jamessawyer/awesome-node/edit/main/docs/blog/translate/file-system-paths.md" target="_blank" rel="noreferrer" data-v-39c03cd7 data-v-01095d06><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-39c03cd7><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> 在GitHub编辑此页<!--]--><!----></a></div><div class="last-updated" data-v-39c03cd7><p class="VPLastUpdated" data-v-39c03cd7 data-v-c0d1d2d4>Last updated: <time datetime="2023-04-11T10:14:49.000Z" data-v-c0d1d2d4></time></p></div></div><div class="prev-next" data-v-39c03cd7><div class="pager" data-v-39c03cd7><a class="pager-link prev" href="/awesome-node/blog/resource/advanced.html" data-v-39c03cd7><span class="desc" data-v-39c03cd7>Previous page</span><span class="title" data-v-39c03cd7>Advanced</span></a></div><div class="has-prev pager" data-v-39c03cd7><a class="pager-link next" href="/awesome-node/blog/translate/fs-in-node.html" data-v-39c03cd7><span class="desc" data-v-39c03cd7>Next page</span><span class="title" data-v-39c03cd7>FS in Node</span></a></div></div></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"book_babel_5.md\":\"43c8e800\",\"book_babel_index.md\":\"1f554027\",\"book_patterns_callback-and-events.md\":\"1b22b856\",\"book_babel_4.md\":\"196442e1\",\"book_patterns_module-system_esm-cjs-interoperability.md\":\"5e9d639a\",\"book_patterns_module-system_commonjs-modules.md\":\"2e6aadbf\",\"book_babel_6.md\":\"2bb3cc9f\",\"book_vite_10.md\":\"1b7d95a3\",\"book_patterns_module-system_esm.md\":\"33e58a9d\",\"book_patterns_module-system_index.md\":\"7baf8d47\",\"book_patterns_module-system_module-define-patterns.md\":\"63cab2e2\",\"book_patterns_module-system_module-system-in-js-and-node.md\":\"da0ffd0d\",\"book_patterns_module-system_the-module-system-and-its-patterns.md\":\"fc0c0e7f\",\"book_patterns_module-system_the-need-for-modules.md\":\"5714d308\",\"book_patterns_the-module-system.md\":\"4f6c68b3\",\"book_patterns_the-node-platform.md\":\"e4eaa778\",\"book_vite_1.md\":\"d1accfdb\",\"book_vite_11.md\":\"fc3e3242\",\"book_patterns_module-system_summary.md\":\"6388e17f\",\"book_babel_3.md\":\"954a2ff3\",\"blog_dive_index.md\":\"9f591673\",\"blog_first.md\":\"161f91bb\",\"blog_misc_module.md\":\"57299e1e\",\"blog_resource_advanced.md\":\"8c64ef67\",\"blog_resource_basic.md\":\"0603c27e\",\"blog_translate_fs-in-node.md\":\"92d98167\",\"book_babel_2.md\":\"d39da118\",\"blog_translate_file-system-paths.md\":\"44045f04\",\"blog_translate_web-streams-on-node.md\":\"5851a151\",\"book_vite_12.md\":\"7224a8fb\",\"blog_misc_ts-and-express.md\":\"96afcc85\",\"book_babel_1.md\":\"79f8311a\",\"book_vite_14.md\":\"d35890b1\",\"book_vite_15.md\":\"59f18391\",\"book_vite_2.md\":\"5e9ccb16\",\"book_vite_3.md\":\"9130fb0f\",\"book_vite_4.md\":\"52018cef\",\"book_vite_19.md\":\"899df01c\",\"book_vite_7.md\":\"baf63994\",\"book_vite_16.md\":\"6162cff7\",\"book_webpack_1.md\":\"f65a6bc0\",\"book_vite_17.md\":\"5e211667\",\"book_vite_18.md\":\"e818a5fc\",\"book_vite_8.md\":\"43cb95e3\",\"lib_fs-extra_readjson.md\":\"bc79ed74\",\"manager_webpack.md\":\"674742e3\",\"book_webpack_11.md\":\"3b73b975\",\"book_webpack_2.md\":\"8f85707b\",\"core_stream_index.md\":\"c6c4c853\",\"core_stream_stream-in-practice.md\":\"9308a63e\",\"core_stream_stream-visulization.md\":\"88687fa1\",\"framework_express_index.md\":\"3393a51a\",\"framework_nestjs_index.md\":\"14eff85b\",\"index.md\":\"47b5de03\",\"lib_fs-extra_copy.md\":\"4669628c\",\"lib_fs-extra_emptydir.md\":\"19fad7e7\",\"lib_fs-extra_ensuredir.md\":\"9fbfd681\",\"lib_fs-extra_ensurefile.md\":\"e28bd787\",\"lib_fs-extra_ensurelink.md\":\"f9b9fbc3\",\"lib_fs-extra_ensuresymlink.md\":\"2828ad91\",\"lib_fs-extra_fs-write-read-writev.md\":\"878d59fb\",\"lib_fs-extra_index.md\":\"8b685dab\",\"lib_fs-extra_move.md\":\"5131bb02\",\"lib_fs-extra_outputfile.md\":\"9b0c7499\",\"lib_fs-extra_outputjson.md\":\"ae7f089b\",\"lib_fs-extra_pathexists.md\":\"361cb7fb\",\"lib_fs-extra_remove.md\":\"6f0dfab3\",\"lib_fs-extra_writejson.md\":\"7b1f9aac\",\"manager_basic.md\":\"f9a58bde\",\"manager_recipe.md\":\"49e04817\",\"manager_vite.md\":\"bbba705d\",\"v18doc_file-system.md\":\"3fc8fe2d\",\"v18doc_path.md\":\"1d46803a\",\"manager_babel.md\":\"6f6fce30\",\"core_events_index.md\":\"3178b47b\",\"book_vite_9.md\":\"e1b94719\",\"book_webpack_10.md\":\"ca0c2abc\",\"book_webpack_3.md\":\"575082db\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Awesome Node\",\"description\":\"Node + Vite + Webpack + Babel\",\"base\":\"/awesome-node/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"outlineTitle\":\"目录\",\"outline\":[2,3],\"editLink\":{\"text\":\"在GitHub编辑此页\",\"pattern\":\"https://github.com/jamessawyer/awesome-node/edit/main/docs/:path\"},\"nav\":[{\"text\":\"📄Node文档\",\"activeMatch\":\"^/v18doc/\",\"link\":\"/v18doc/File-System\"},{\"text\":\"📦工程化\",\"link\":\"/manager/basic\"},{\"text\":\"💫核心概念\",\"link\":\"/core/stream/index\"},{\"text\":\"🤔blog\",\"link\":\"/blog/first\"},{\"text\":\"📚书籍\",\"items\":[{\"text\":\"Node Design Patterns\",\"link\":\"/book/patterns/the-node-platform\"},{\"text\":\"深入理解Vite\",\"link\":\"/book/vite/2\"},{\"text\":\"Webpack5核心原理\",\"link\":\"/book/webpack/1\"},{\"text\":\"Babel插件秘籍\",\"link\":\"/book/babel/2\"}]},{\"text\":\"🧑‍🚀框架\",\"items\":[{\"text\":\"NestJS\",\"link\":\"/framework/nestjs/index\"},{\"text\":\"Express\",\"link\":\"/framework/express/index\"}]},{\"text\":\"🔥常用库\",\"items\":[{\"text\":\"fs-extra\",\"link\":\"/lib/fs-extra/index\"}]}],\"sidebar\":{\"/v18doc/\":[{\"text\":\"Node v18.x 中文文档\",\"items\":[{\"text\":\"File System\",\"link\":\"/v18doc/File-System\"},{\"text\":\"Path\",\"link\":\"/v18doc/Path\"}]}],\"/manager/\":[{\"text\":\"基础知识\",\"items\":[{\"text\":\"package.json\",\"link\":\"/manager/basic\"},{\"text\":\"Vite学习\",\"link\":\"/manager/vite\"},{\"text\":\"Webpack学习\",\"link\":\"/manager/webpack\"},{\"text\":\"babel生态\",\"link\":\"/manager/babel\"}]},{\"text\":\"Recipe\",\"items\":[{\"text\":\"Node资源\",\"link\":\"/manager/recipe\"}]}],\"/core/\":[{\"text\":\"EventEmitter\",\"collapsible\":true,\"items\":[{\"text\":\"资源\",\"link\":\"/core/events/index\"}]},{\"text\":\"Streams\",\"collapsible\":true,\"items\":[{\"text\":\"资源\",\"link\":\"/core/stream/index\"},{\"text\":\"⚡Stream图解\",\"link\":\"/core/stream/stream-visulization\"},{\"text\":\"⚡Stream实战\",\"link\":\"/core/stream/stream-in-practice\"}]}],\"/blog/\":[{\"text\":\"资源\",\"items\":[{\"text\":\"Advanced\",\"link\":\"/blog/resource/advanced\"}]},{\"text\":\"🚀 好文翻译\",\"collapsible\":true,\"items\":[{\"text\":\"Path & URL的用法\",\"link\":\"/blog/translate/file-system-paths\"},{\"text\":\"FS in Node\",\"link\":\"/blog/translate/fs-in-node\"},{\"text\":\"Web Streams on Node\",\"link\":\"/blog/translate/web-streams-on-node\"}]},{\"text\":\"MISC\",\"collapsible\":true,\"items\":[{\"text\":\"ESM & CJS模块\",\"link\":\"/blog/misc/module\"},{\"text\":\"Express + typescript设置\",\"link\":\"/blog/misc/ts-and-express\"}]}],\"/book/patterns\":[{\"text\":\"Node设计模式\",\"items\":[{\"text\":\"the node platform\",\"link\":\"/book/patterns/the-node-platform\"},{\"text\":\"callback and events\",\"link\":\"/book/patterns/callback-and-events\"}]},{\"text\":\"Ⅱ.模块系统\",\"collapsible\":true,\"items\":[{\"text\":\"介绍\",\"link\":\"/book/patterns/module-system/index\"},{\"text\":\"模块系统的必要性\",\"link\":\"/book/patterns/module-system/the-need-for-modules\"},{\"text\":\"JS和Node中的模块系统\",\"link\":\"/book/patterns/module-system/module-system-in-js-and-node\"},{\"text\":\"模块系统和其模式\",\"link\":\"/book/patterns/module-system/the-module-system-and-its-patterns\"},{\"text\":\"⚡CommonJS模块\",\"link\":\"/book/patterns/module-system/commonjs-modules\"},{\"text\":\"🙆‍♀️CommonJS模块常用模式定义\",\"link\":\"/book/patterns/module-system/module-define-patterns\"},{\"text\":\"🚀ESM\",\"link\":\"/book/patterns/module-system/esm\"},{\"text\":\"🚀ESM和CJS差异和互操性\",\"link\":\"/book/patterns/module-system/esm-cjs-interoperability\"},{\"text\":\"总结\",\"link\":\"/book/patterns/module-system/summary\"}]}],\"/book/vite\":[{\"text\":\"🔧深入理解Vite\",\"items\":[{\"text\":\"1.Vite开篇\",\"link\":\"/book/vite/1\"},{\"text\":\"2.模块标准\",\"link\":\"/book/vite/2\"},{\"text\":\"3.快速上手Vite\",\"link\":\"/book/vite/3\"},{\"text\":\"4.样式方案\",\"link\":\"/book/vite/4\"},{\"text\":\"7.预构建\",\"link\":\"/book/vite/7\"},{\"text\":\"8.双引擎架构\",\"link\":\"/book/vite/8\"},{\"text\":\"9.性能推手: Esbuild\",\"link\":\"/book/vite/9\"},{\"text\":\"10.Rollup基本用法\",\"link\":\"/book/vite/10\"},{\"text\":\"11.深入理解Rollup插件机制\",\"link\":\"/book/vite/11\"},{\"text\":\"12.Vite插件开发\",\"link\":\"/book/vite/12\"},{\"text\":\"14.代码分割\",\"link\":\"/book/vite/14\"},{\"text\":\"15.Polyfill和语法降级\",\"link\":\"/book/vite/15\"},{\"text\":\"16.Vite搭建SSR工程\",\"link\":\"/book/vite/16\"},{\"text\":\"17.联邦模块以及原理\",\"link\":\"/book/vite/17\"},{\"text\":\"18.Pure ESM时代\",\"link\":\"/book/vite/18\"},{\"text\":\"19.系统对Vite项目性能优化\",\"link\":\"/book/vite/19\"}]}],\"/book/webpack\":[{\"text\":\"Webpack5核心原理与实践\",\"items\":[{\"text\":\"1.重新认识Webpack\",\"link\":\"/book/webpack/1\"},{\"text\":\"2.如何理解Webpack配置底层结构逻辑？\",\"link\":\"/book/webpack/2\"},{\"text\":\"3.配置Babel+TS+ESLint？\",\"link\":\"/book/webpack/3\"},{\"text\":\"10.深入理解图像加载原理和最佳实践\",\"link\":\"/book/webpack/10\"},{\"text\":\"11.深入理解webpack核心配置📚\",\"link\":\"/book/webpack/11\"}]}],\"/book/babel\":[{\"text\":\"Babel插件秘籍\",\"items\":[{\"text\":\"1.Babel的介绍\",\"link\":\"/book/babel/1\"},{\"text\":\"2.Babel的编译流程\",\"link\":\"/book/babel/2\"},{\"text\":\"3.Babel的AST\",\"link\":\"/book/babel/3\"},{\"text\":\"4.Babel的API\",\"link\":\"/book/babel/4\"},{\"text\":\"5.实战：插入函数调用参数\",\"link\":\"/book/babel/5\"},{\"text\":\"6.JS Parser的历史\",\"link\":\"/book/babel/6\"}]}],\"/lib/fs-extra\":[{\"text\":\"fs-extra\",\"items\":[{\"text\":\"README\",\"link\":\"/lib/fs-extra/index\"},{\"text\":\"copy\",\"link\":\"/lib/fs-extra/copy\"},{\"text\":\"emptyDir\",\"link\":\"/lib/fs-extra/emptyDir\"},{\"text\":\"ensureFile\",\"link\":\"/lib/fs-extra/ensureFile\"},{\"text\":\"ensureDir\",\"link\":\"/lib/fs-extra/ensureDir\"},{\"text\":\"ensureLink\",\"link\":\"/lib/fs-extra/ensureLink\"},{\"text\":\"ensureSymlink\",\"link\":\"/lib/fs-extra/ensureSymlink\"},{\"text\":\"move\",\"link\":\"/lib/fs-extra/move\"},{\"text\":\"outputFile\",\"link\":\"/lib/fs-extra/outputFile\"},{\"text\":\"pathExists\",\"link\":\"/lib/fs-extra/pathExists\"},{\"text\":\"readJson\",\"link\":\"/lib/fs-extra/readJson\"},{\"text\":\"remove\",\"link\":\"/lib/fs-extra/remove\"},{\"text\":\"outputJson\",\"link\":\"/lib/fs-extra/outputJson\"},{\"text\":\"writeJson\",\"link\":\"/lib/fs-extra/writeJson\"},{\"text\":\"fs-write-read-writev\",\"link\":\"/lib/fs-extra/fs-write-read-writev\"}]}],\"/framework/nestjs\":[{\"text\":\"学习NestJS\",\"items\":[{\"text\":\"资源\",\"link\":\"/framework/nestjs/index\"}]}],\"/framework/express\":[{\"text\":\"Learn ExpressJS\",\"items\":[{\"text\":\"资源\",\"link\":\"/framework/express/index\"}]}]}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>