import{_ as s,c as n,o as a,V as l}from"./chunks/framework.478efc10.js";const p="/awesome-node/assets/17-1.1ee482a8.webp",o="/awesome-node/assets/17-2.10aaacb5.webp",e="/awesome-node/assets/17-3.3cafb3f9.webp",t="/awesome-node/assets/17-4.968f909b.webp",c="/awesome-node/assets/17-5.6c1c121f.webp",h=JSON.parse('{"title":"ä»£ç å‹ç¼©","description":"","frontmatter":{"title":"ä»£ç å‹ç¼©"},"headers":[],"relativePath":"book/webpack/17.md","lastUpdated":1681969587000}'),r={name:"book/webpack/17.md"},i=l(`<p><strong>ä»£ç å‹ç¼©</strong> æ˜¯æŒ‡åœ¨ä¸æ”¹å˜ä»£ç åŠŸèƒ½çš„å‰æä¸‹ï¼Œä»å£°æ˜å¼ï¼ˆHTMLã€CSSï¼‰æˆ–å‘½ä»¤å¼ï¼ˆJavaScriptï¼‰è¯­è¨€ä¸­åˆ é™¤æ‰€æœ‰ä¸å¿…è¦çš„å­—ç¬¦ï¼ˆå¤‡æ³¨ã€å˜é‡åå‹ç¼©ã€é€»è¾‘è¯­å¥åˆå¹¶ç­‰ï¼‰ï¼Œå‡å°‘ä»£ç ä½“ç§¯çš„è¿‡ç¨‹ï¼Œè¿™åœ¨ Web åœºæ™¯ä¸­èƒ½å¤Ÿæœ‰æ•ˆå‡å°‘æµè§ˆå™¨ä»æœåŠ¡å™¨è·å–ä»£ç èµ„æºæ‰€éœ€è¦æ¶ˆè€—çš„ä¼ è¾“é‡ï¼Œé™ä½ç½‘ç»œé€šè®¯è€—æ—¶ï¼Œæå‡é¡µé¢å¯åŠ¨é€Ÿåº¦ï¼Œæ˜¯ä¸€ç§éå¸¸åŸºç¡€ä¸”æ€§ä»·æ¯”ç‰¹åˆ«é«˜çš„åº”ç”¨æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆã€‚</p><p>åœ¨ Webpack ç”Ÿæ€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©å„ç§æ’ä»¶è½»æ¾å®ç°åº”ç”¨ä»£ç å‹ç¼©ï¼Œæœ¬æ–‡å°†ä»ä»£ç å‹ç¼©çš„åŸºæœ¬åŸç†å¼€å§‹è®²èµ·ï¼Œä¹‹åä»‹ç»è‹¥å¹²é€‚ç”¨äº JavaScriptã€CSSã€HTML çš„ä»£ç å‹ç¼©å·¥å…·ã€‚</p><h2 id="ä»£ç å‹ç¼©åŸç†" tabindex="-1">ä»£ç å‹ç¼©åŸç† <a class="header-anchor" href="#ä»£ç å‹ç¼©åŸç†" aria-label="Permalink to &quot;ä»£ç å‹ç¼©åŸç†&quot;">â€‹</a></h2><p>â€œä»£ç å‹ç¼©â€æœ€å…³é”®çš„é—®é¢˜æ˜¯ï¼šå¦‚ä½•ç”¨â€œ<strong>æ›´ç²¾ç®€</strong>â€çš„ä»£ç è¡¨è¾¾â€œ<strong>åŒä¸€å¥—</strong>â€ç¨‹åºé€»è¾‘ï¼Ÿè¿™å¹¶ä¸æ˜¯ä»€ä¹ˆé»‘é­”æ³•ï¼Œåº•å±‚é€»è¾‘ç®€å•çš„ç”šè‡³æœ‰ç‚¹ç²—æš´ï¼Œæ‹†å¼€æ¥çœ‹ï¼š</p><p>â€œ<strong>æ›´ç²¾ç®€</strong>â€æ„å‘³ç€å¯ä»¥é€‚å½“ â€”â€” ç”šè‡³å®Œå…¨ç‰ºç‰²å¯è¯»æ€§ã€è¯­ä¹‰ã€ä¼˜é›…åº¦è€ŒåŠ›æ±‚ç”¨æœ€å°‘å­—ç¬¦æ•°çš„æ–¹å¼ä¹¦å†™ä»£ç ã€‚æ¯”å¦‚è¯´ <code>const name = &#39;tecvan&#39;;</code>ï¼Œè¿™ä¸ªçœ‹èµ·æ¥éå¸¸ç®€å•çš„èµ‹å€¼è¯­å¥å°±æœ‰ä¸å°‘å¯ä»¥ç²¾ç®€çš„å­—ç¬¦ï¼š</p><ul><li>å˜é‡å <code>name</code> è¯­ä¹‰å¾ˆæ˜ç¡®ï¼Œå¤§å¤šæ•°â€œäººâ€çœ‹åˆ°å°±åŸºæœ¬æ˜ç™½æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Œä½†è¿™å¯¹è®¡ç®—æœºå¹¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å°† <code>name</code> ä¿®æ”¹ä¸º <code>a</code> â€”â€” ä» 4 ä¸ªå­—ç¬¦ç²¾ç®€ä¸º 1 ä¸ªå­—ç¬¦ï¼Œä½†ä»ä¿æŒæ”¹åŠ¨å‰åé€»è¾‘ã€åŠŸèƒ½æ•ˆæœå®Œå…¨ä¸€è‡´ï¼›</li><li>èµ‹å€¼æ“ä½œç¬¦ <code>=</code> å‰åéƒ½æœ‰ç©ºæ ¼ï¼Œè¿™ç§æ ¼å¼å¯¹é˜…è¯»ä»£ç çš„â€œäººâ€å¾ˆå‹å¥½ï¼Œè§†è§‰æ•ˆæœéå¸¸èˆ’é€‚ã€æ•´é½ï¼Œä½†å¯¹è®¡ç®—æœºè€Œè¨€åŒæ ·æ¯«æ— æ„ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™å‰åä¸¤ä¸ªç©ºæ ¼åˆ æ‰ â€”â€” ç²¾ç®€äº†ä¸¤ä¸ªå­—ç¬¦ï¼›</li><li>è™½ç„¶ <code>const</code> ä¸ <code>let</code> å…³é”®è¯çš„åŠŸèƒ½ä¸åŒï¼Œä½†ç‰¹å®šæƒ…å†µä¸‹æˆ‘ä»¬åŒæ ·èƒ½ç‰ºç‰²ä¸€éƒ¨åˆ†åŠŸèƒ½æ€§ï¼Œç”¨ <code>let</code> æ›¿æ¢ <code>const</code>ï¼Œä» 5 ä¸ªå­—ç¬¦ç²¾ç®€ä¸º 1 ä¸ªå­—ç¬¦ã€‚</li></ul><p>ç»è¿‡ä¸Šé¢ä¸‰ä¸ªæ­¥éª¤ä¹‹åï¼Œä»£ç ä» <code>const name = &#39;tecvan&#39;;</code> â€”â€” 22 ä¸ªå­—ç¬¦ï¼Œç²¾ç®€ä¸º <code>let a=&#39;tecvan&#39;;</code> â€”â€” 18 ä¸ªå­—ç¬¦ï¼Œå¾€å¤§äº†è¯´æ˜¯èŠ‚çœäº† <strong>18%</strong> çš„ä»£ç ä½“ç§¯ã€‚å…¶å®ƒè¯­è¨€çš„ä»£ç å‹ç¼©è§„åˆ™ä¹ŸåŸºæœ¬éƒ½æ˜¯æŒ‰ç…§ä¸Šé¢è¿™ç§å¥—è·¯å®ç°çš„ã€‚</p><p>å…¶æ¬¡ï¼Œâ€œ<strong>åŒä¸€å¥—</strong>â€æ„å‘³ç€ä¿®æ”¹å‰åå¿…é¡»ä¿æŒä¸€è‡´çš„ä»£ç é€»è¾‘ã€æ‰§è¡Œæµç¨‹ã€åŠŸèƒ½æ•ˆæœç­‰ï¼Œä¾‹å¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> a </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> b </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> c </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> a </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> b</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>ä»£ç ä¸­ï¼Œ<code>a/b</code> éƒ½æ˜¯å­—é¢é‡å¸¸é‡ï¼Œé‚£ä¹ˆæ•´æ®µä»£ç å®Œå…¨å¯ä»¥ç²¾ç®€ä¸º <code>const c = 3</code> ï¼Œçœç•¥æ‰ <code>a/b</code> å˜é‡çš„å£°æ˜è¯­å¥ï¼Œå‰åè¿˜èƒ½ä¿æŒåŠŸèƒ½å®Œå…¨ä¸€è‡´ã€‚</p><p>ä¸ºäº†åº”å¯¹è¿™ä¸¤ä¸ªæŒ‘æˆ˜ï¼Œå¾ˆè‡ªç„¶çš„æˆ‘ä»¬å¯ä»¥å…ˆå°†å­—ç¬¦ä¸²å½¢æ€çš„ä»£ç è½¬æ¢ä¸ºç»“æ„åŒ–ã€å®¹æ˜“åˆ†æå¤„ç†çš„ <code>AST</code>ï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰å½¢æ€ï¼Œä¹‹ååœ¨ AST ä¸Šåº”ç”¨ä¸Šé¢çš„è§„åˆ™åšå„ç§è¯­æ³•ã€è¯­ä¹‰ã€é€»è¾‘æ¨ç†ä¸ç®€åŒ–æ›¿æ¢ï¼Œæœ€åæŒ‰ç²¾ç®€è¿‡çš„ AST ç”Ÿæˆç»“æœä»£ç ã€‚</p><p><img src="`+p+'" alt="AST"></p><p>ç¤¾åŒºæ›¾ç»å‡ºç°è¿‡éå¸¸éå¸¸å¤š JavaScriptã€HTMLã€CSS ä»£ç å‹ç¼©å·¥å…·ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æŒ‰ç…§ä¸Šé¢è¿™ç§å¥—è·¯å®ç°çš„ï¼ŒåŒ…æ‹¬ï¼š<a href="https://github.com/terser/terser" target="_blank" rel="noreferrer">Terser</a>ã€<a href="https://esbuild.github.io/" target="_blank" rel="noreferrer">ESBuild</a>ã€<a href="https://cssnano.co/" target="_blank" rel="noreferrer">CSS-Nano</a>ã€<a href="https://github.com/babel/minify" target="_blank" rel="noreferrer">babel-minify</a>ã€<a href="https://github.com/terser/html-minifier-terser" target="_blank" rel="noreferrer">htmlMinifierTerser</a> ç­‰ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Webpack ä¸­è½»æ¾æ¥å…¥è¿™äº›å·¥å…·ï¼Œå®ç°ä»£ç å‹ç¼©ã€‚</p><h2 id="å‹ç¼©js-terserwebpackplugin" tabindex="-1">å‹ç¼©JS - TerserWebpackPlugin <a class="header-anchor" href="#å‹ç¼©js-terserwebpackplugin" aria-label="Permalink to &quot;å‹ç¼©JS - TerserWebpackPlugin&quot;">â€‹</a></h2><p><a href="https://github.com/terser/terser" target="_blank" rel="noreferrer">Terser</a> æ˜¯å½“ä¸‹ <a href="https://npmtrends.com/babel-minify-vs-terser-vs-uglify-js" target="_blank" rel="noreferrer">æœ€ä¸ºæµè¡Œ</a> çš„ ES6 ä»£ç å‹ç¼©å·¥å…·ä¹‹ä¸€ï¼Œæ”¯æŒ <a href="https://en.wikipedia.org/wiki/Dead-code_elimination" target="_blank" rel="noreferrer">Dead-Code Eliminate</a>ã€åˆ é™¤æ³¨é‡Šã€åˆ é™¤ç©ºæ ¼ã€ä»£ç åˆå¹¶ã€å˜é‡åç®€åŒ–ç­‰ç­‰<a href="https://github.com/terser/terser#compress-options" target="_blank" rel="noreferrer">ä¸€ç³»åˆ—</a>ä»£ç å‹ç¼©åŠŸèƒ½ã€‚Terser çš„å‰èº«æ˜¯å¤§åé¼é¼çš„ <a href="https://github.com/mishoo/UglifyJS" target="_blank" rel="noreferrer">UglifyJS</a>ï¼Œå®ƒåœ¨ UglifyJS åŸºç¡€ä¸Šå¢åŠ äº† ES6 è¯­æ³•æ”¯æŒï¼Œå¹¶é‡æ„ä»£ç è§£æã€å‹ç¼©ç®—æ³•ï¼Œä½¿å¾—æ‰§è¡Œæ•ˆç‡ä¸å‹ç¼©ç‡éƒ½æœ‰è¾ƒå¤§æå‡ï¼š(æ•°æ®æ¥æºï¼š<a href="https://github.com/babel/minify" target="_blank" rel="noreferrer">https://github.com/babel/minify</a>)</p><p><img src="'+o+`" alt="JSå‹ç¼©å·¥å…·Benchmark"></p><p>Webpack5.0 åé»˜è®¤ä½¿ç”¨ Terser ä½œä¸º JavaScript ä»£ç å‹ç¼©å™¨ï¼Œç®€å•ç”¨æ³•åªéœ€é€šè¿‡ <code>optimization.minimize</code> é…ç½®é¡¹å¼€å¯å‹ç¼©åŠŸèƒ½å³å¯ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>ä½¿ç”¨ <code>mode = &#39;production&#39;</code> å¯åŠ¨ç”Ÿäº§æ¨¡å¼æ„å»ºæ—¶ï¼Œé»˜è®¤ä¹Ÿä¼šå¼€å¯ Terser å‹ç¼©ã€‚</p></div><p>Terser æ”¯æŒè®¸å¤šå‹ç¼©<a href="https://github.com/terser/terser#compress-options" target="_blank" rel="noreferrer">é…ç½®</a>ï¼š</p><ul><li><code>dead_code</code>ï¼šæ˜¯å¦åˆ é™¤ä¸å¯è§¦è¾¾çš„ä»£ç  â€”â€” ä¹Ÿå°±æ˜¯æ‰€è°“çš„æ­»ä»£ç ï¼›</li><li><code>booleans_as_integers</code>ï¼šæ˜¯å¦å°† Boolean å€¼å­—é¢é‡è½¬æ¢ä¸º 0ã€1ï¼›</li><li><code>join_vars</code>ï¼šæ˜¯å¦åˆå¹¶è¿ç»­çš„å˜é‡å£°æ˜ï¼Œå¦‚ <code>var a = 1; var b = 2;</code> åˆå¹¶ä¸º <code>var a=1,b=2;</code>ï¼›</li><li>ç­‰ç­‰ã€‚</li></ul><p>å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨é»˜è®¤ Terser é…ç½®å³å¯ï¼Œå¿…è¦æ—¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»º <a href="https://github.com/webpack-contrib/terser-webpack-plugin" target="_blank" rel="noreferrer">terser-webpack-plugin</a> å®ä¾‹å¹¶ä¼ å…¥å‹ç¼©é…ç½®å®ç°æ›´ç²¾ç»†çš„å‹ç¼©åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-LlQQv" id="tab-4JMLIyZ" checked="checked"><label for="tab-4JMLIyZ">webpack.config.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> TerserPlguin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">terser-webpack-plugin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimizer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TerserPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">terserOptions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">compress</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">reduce_vars</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F07178;">pure_funcs</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">console.log</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>ç¤ºä¾‹ä¸­çš„ <code>minimize</code> ç”¨äºæ§åˆ¶æ˜¯å¦å¼€å¯å‹ç¼©ï¼Œåªæœ‰ <code>minimize = true&#39;</code> æ—¶æ‰ä¼šè°ƒç”¨ <code>minimizer</code> å£°æ˜çš„å‹ç¼©å™¨æ•°ç»„ï¼ˆæ²¡é”™ï¼Œè¿™æ˜¯æ•°ç»„å½¢å¼ï¼‰æ‰§è¡Œå‹ç¼©æ“ä½œã€‚</p><p>å¦å¤–ï¼ŒWebpack4 é»˜è®¤ä½¿ç”¨ <a href="https://www.npmjs.com/package/uglifyjs-webpack-plugin" target="_blank" rel="noreferrer">uglifyjs-webpack-plugin</a> å‹ç¼©ä»£ç ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>minimizer</code> æ•°ç»„æ›¿æ¢ä¸º Terser æ’ä»¶ã€‚</p></div><p>terser-webpack-pluginæ˜¯ä¸€ä¸ªé¢‡ä¸ºå¤æ‚çš„ Webpack æ’ä»¶ï¼Œæä¾›ä¸‹è¿° <a href="https://www.npmjs.com/package/terser-webpack-plugin#options" target="_blank" rel="noreferrer">é…ç½®é¡¹</a>ï¼š</p><ul><li><code>test</code>ï¼šåªæœ‰å‘½ä¸­è¯¥é…ç½®çš„äº§ç‰©è·¯å¾„æ‰ä¼šæ‰§è¡Œå‹ç¼©ï¼ŒåŠŸèƒ½ä¸ <a href="https://webpack.js.org/configuration/module/#ruletest" target="_blank" rel="noreferrer">module.rules.test</a> ç›¸ä¼¼ï¼›</li><li><code>include</code>ï¼šåœ¨è¯¥èŒƒå›´å†…çš„äº§ç‰©æ‰ä¼šæ‰§è¡Œå‹ç¼©ï¼ŒåŠŸèƒ½ä¸ <a href="https://webpack.js.org/configuration/module/#ruleinclude" target="_blank" rel="noreferrer">module.rules.include</a> ç›¸ä¼¼ï¼›</li><li><code>exclude</code>ï¼šä¸ <code>include</code> ç›¸åï¼Œä¸åœ¨è¯¥èŒƒå›´å†…çš„äº§ç‰©æ‰ä¼šæ‰§è¡Œå‹ç¼©ï¼ŒåŠŸèƒ½ä¸ <a href="https://webpack.js.org/configuration/module/#ruleexclude" target="_blank" rel="noreferrer">module.rules.exclude</a> ç›¸ä¼¼ï¼›</li><li><code>parallel</code>ï¼šæ˜¯å¦å¯åŠ¨å¹¶è¡Œå‹ç¼©ï¼Œé»˜è®¤å€¼ä¸º <code>true</code>ï¼Œæ­¤æ—¶ä¼šæŒ‰ <code>os.cpus().length - 1</code> å¯åŠ¨è‹¥å¹²è¿›ç¨‹å¹¶å‘æ‰§è¡Œï¼›</li><li><code>minify</code>ï¼šç”¨äºé…ç½®å‹ç¼©å™¨ï¼Œæ”¯æŒä¼ å…¥è‡ªå®šä¹‰å‹ç¼©å‡½æ•°ï¼Œä¹Ÿæ”¯æŒ <code>swc/esbuild/uglifyjs</code> ç­‰å€¼ï¼Œä¸‹é¢æˆ‘ä»¬å†å±•å¼€è®²è§£ï¼›</li><li><code>terserOptions</code>ï¼šä¼ å…¥ <code>minify</code> â€”â€” â€œå‹ç¼©å™¨â€å‡½æ•°çš„é…ç½®å‚æ•°ï¼›</li><li><code>extractComments</code>ï¼šæ˜¯å¦å°†ä»£ç ä¸­çš„å¤‡æ³¨æŠ½å–ä¸ºå•ç‹¬æ–‡ä»¶ï¼Œå¯é…åˆç‰¹æ®Šå¤‡æ³¨å¦‚ <code>@license</code> ä½¿ç”¨ã€‚</li></ul><p>ğŸŒ°è¿™äº›é…ç½®é¡¹æ€»ç»“ä¸‹æ¥æœ‰ä¸¤ä¸ªå€¼å¾—å…³æ³¨çš„é€»è¾‘ï¼š</p><ol><li><p>å¯ä»¥é€šè¿‡ <code>test/include/exclude</code> è¿‡æ»¤æ’ä»¶çš„æ‰§è¡ŒèŒƒå›´ï¼Œè¿™ä¸ªåŠŸèƒ½é…åˆ <code>minimizer</code> çš„æ•°ç»„ç‰¹æ€§ï¼Œå¯ä»¥å®ç°é’ˆå¯¹ä¸åŒäº§ç‰©æ‰§è¡Œä¸åŒçš„å‹ç¼©ç­–ç•¥ï¼Œä¾‹å¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> TerserPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">terser-webpack-plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">foo</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/foo.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">bar</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/bar.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">output</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">filename</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">[name].js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimizer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TerserPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">foo</span><span style="color:#A6ACCD;">\\.</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">i</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">extractComments</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">all</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TerserPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">bar</span><span style="color:#A6ACCD;">\\.</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">extractComments</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><p><a href="https://github.com/Tecvan-fe/webpack-book-samples/blob/main/minify-terser/webpack.config.js" target="_blank" rel="noreferrer">ç¤ºä¾‹</a>ä¸­ï¼Œé’ˆå¯¹ <code>foo.js</code> äº§ç‰©æ–‡ä»¶ä¼šæ‰§è¡Œ <code>exctractComments</code> é€»è¾‘ï¼Œå°†å¤‡æ³¨ä¿¡æ¯æŠ½å–ä¸ºå•ç‹¬æ–‡ä»¶ï¼›è€Œé’ˆå¯¹ <code>bar.js</code>ï¼Œç”±äº <code>extractComments = false</code>ï¼Œä¸å•ç‹¬æŠ½å–å¤‡æ³¨å†…å®¹ã€‚</p></li><li><p>ğŸš€terser-webpack-pluginæ’ä»¶å¹¶ä¸åªæ˜¯ Terser çš„ç®€å•åŒ…è£…ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ªä»£ç å‹ç¼©åŠŸèƒ½éª¨æ¶ï¼Œåº•å±‚è¿˜æ”¯æŒä½¿ç”¨ SWCã€UglifyJSã€ESBuild ä½œä¸ºå‹ç¼©å™¨ï¼Œä½¿ç”¨æ—¶åªéœ€è¦é€šè¿‡ <code>minify</code> å‚æ•°åˆ‡æ¢å³å¯ï¼Œä¾‹å¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimizer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TerserPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">minify</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> TerserPlugin</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">swcMinify</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// \`terserOptions\` å°†è¢«ä¼ é€’åˆ° \`swc\` (\`@swc/core\`) å·¥å…·</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// å…·ä½“é…ç½®å‚æ•°å¯å‚è€ƒï¼šhttps://swc.rs/docs/config-js-minify</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">terserOptions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{},</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div></li></ol><ul><li><a href="https://github.com/Tecvan-fe/webpack-book-samples/blob/main/minify-terser/webpack.config.js" target="_blank" rel="noreferrer">ğŸŒ° minify-terser - @github</a></li></ul><p>TerserPlugin å†…ç½®å¦‚ä¸‹å‹ç¼©å™¨ï¼š</p><ul><li><code>TerserPlugin.terserMinify</code>ï¼šä¾èµ–äº <code>terser</code> åº“ï¼›</li><li><code>TerserPlugin.uglifyJsMinify</code>ï¼šä¾èµ–äº <code>uglify-js</code>ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£… <code>yarn add -D uglify-js</code>ï¼›</li><li><code>TerserPlugin.swcMinify</code>ï¼šä¾èµ–äº <code>@swc/core</code>ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£… <code>yarn add -D</code> <code>@swc/core</code>ï¼›âœ…</li><li><code>TerserPlugin.esbuildMinify</code>ï¼šä¾èµ–äº <code>esbuild</code>ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£… <code>yarn add -D esbuild</code>ã€‚</li></ul><p>å¦å¤–ï¼Œ<code>terserOptions</code> é…ç½®ä¹Ÿä¸ä»…ä»…ä¸“ä¾› <code>terser</code> ä½¿ç”¨ï¼Œè€Œæ˜¯ä¼šé€ä¼ ç»™å…·ä½“çš„ <code>minifier</code>ï¼Œå› æ­¤ä½¿ç”¨ä¸åŒå‹ç¼©å™¨æ—¶æ”¯æŒçš„é…ç½®é€‰é¡¹ä¹Ÿä¼šä¸åŒã€‚</p><p>ä¸åŒå‹ç¼©å™¨åŠŸèƒ½ã€æ€§èƒ½å·®å¼‚è¾ƒå¤§ï¼Œæ®æˆ‘äº†è§£ï¼ŒESBuild ä¸ SWC è¿™ä¸¤ä¸ªåŸºäº Go ä¸ Rust ç¼–å†™çš„å‹ç¼©å™¨æ€§èƒ½æ›´ä½³ï¼Œä¸”æ•ˆæœå·²ç»åŸºæœ¬è¶‹äºç¨³å®šï¼Œè™½ç„¶åŠŸèƒ½è¿˜æ¯”ä¸ä¸Š Terserï¼Œä½†æŸäº›æ„å»ºæ€§èƒ½æ•æ„Ÿåœºæ™¯ä¸‹ä¸å¤±ä¸ºä¸€ç§ä¸é”™çš„é€‰æ‹©ã€‚</p><h2 id="å‹ç¼©css-cssminimizerwebpackplugin" tabindex="-1">å‹ç¼©CSS - CssMinimizerWebpackPlugin <a class="header-anchor" href="#å‹ç¼©css-cssminimizerwebpackplugin" aria-label="Permalink to &quot;å‹ç¼©CSS - CssMinimizerWebpackPlugin&quot;">â€‹</a></h2><p>CSS æ˜¯ä¸€ç§çµæ´»å¤šå˜å¾—ç•¥æ˜¾å¤æ‚çš„å£°æ˜å¼è¯­è¨€ï¼ŒåŒæ ·çš„æ ·å¼æ•ˆæœå¯ä»¥è¢«è¡¨è¾¾æˆéå¸¸å¤šæ ·çš„ä»£ç è¯­å¥ï¼Œä¾‹å¦‚ä¸€ä¸ªéå¸¸å…¸å‹çš„æ¡ˆä¾‹ï¼š<code>margin: 10px</code>ï¼Œå¯ä»¥è¢«å†™æˆï¼š</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">margin: 10px 10px;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"># æˆ–è€…</span></span>
<span class="line"><span style="color:#FFCB6B;">margin-left</span><span style="color:#A6ACCD;">: 10px; </span><span style="color:#FFCB6B;">margin-right</span><span style="color:#A6ACCD;">: 10px;...</span></span></code></pre></div><p>è¿™äº›ä¸åŒçš„è¡¨è¿°æ–¹å¼æœ€ç»ˆå®ç°çš„æ ·å¼æ•ˆæœç›¸åŒï¼Œé‚£ç†æ‰€å½“ç„¶çš„å¯ä»¥ç”¨æœ€ç²¾ç®€çš„æ–¹å¼å‹ç¼©ä»£ç ã€‚æ‰©å±•å¼€æ¥ï¼š</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">h1</span><span style="color:#89DDFF;">::</span><span style="color:#C792EA;">before</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#FFCB6B;">h1</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">before</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* ä¸‹é¢å„ç§å¤‡æ³¨éƒ½å¯ä»¥åˆ é™¤ */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* margin å€¼å¯ç®€å†™ */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">margin</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10px</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20px</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10px</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20px</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* é¢œè‰²å€¼ä¹Ÿå¯ä»¥ç®€å†™ */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">ff0000</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* åˆ é™¤é‡å¤å±æ€§ */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">font-weight</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">400</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">font-weight</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">400</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* position å­—é¢é‡å€¼å¯ç®€åŒ–ä¸ºç™¾åˆ†æ¯” */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">background-position</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> bottom right</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* æ¸å˜å‚æ•°å¯ç²¾ç®€ */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">linear-gradient</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">to</span><span style="color:#A6ACCD;"> bottom</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">ffe500 </span><span style="color:#F78C6C;">0%</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">ffe500 </span><span style="color:#F78C6C;">50%</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">121 </span><span style="color:#F78C6C;">50%</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">121 </span><span style="color:#F78C6C;">100%</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* åˆå§‹å€¼ä¹Ÿå¯ç²¾ç®€ */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">min-width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> initial</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ä¸Šè¿°ä»£ç å°±æœ‰ä¸å°‘åœ°æ–¹å¯ä»¥ç²¾ç®€ä¼˜åŒ–ï¼Œä½¿ç”¨ <a href="https://cssnano.co/" target="_blank" rel="noreferrer">cssnano</a> å‹ç¼©åå¤§è‡´ä¸Šå¯ç®€åŒ–ä¸ºï¼š</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">h1</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">before</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">margin</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10px</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> red</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">font-weight</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">400</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">background-position</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100%</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100%</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">quotes</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Â«</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Â»</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">linear-gradient</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">180deg</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">ffe500</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">ffe500 </span><span style="color:#F78C6C;">50%</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">121 </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">#</span><span style="color:#A6ACCD;">121</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">min-width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ä»åŸæ¥çš„ 422 ä¸ªå­—ç¬¦ç²¾ç®€ä¸º 212 ä¸ªå­—ç¬¦ï¼Œæ¥è¿‘ 50%ï¼Œæˆ‘ä»¬æ—¥å¸¸ç¼–å†™çš„ CSS è¯­å¥ä¹Ÿè·Ÿä¸Šè¿°ç¤ºä¾‹ç±»ä¼¼ï¼Œé€šå¸¸éƒ½ä¼šæœ‰ä¸å°‘å¯ä»¥ä¼˜åŒ–å‹ç¼©çš„åœ°æ–¹ã€‚</p><p>ğŸŒ°Webpack ç¤¾åŒºä¸­æœ‰ä¸å°‘å®ç° CSS ä»£ç å‹ç¼©çš„æ’ä»¶ï¼Œä¾‹å¦‚ï¼š<a href="https://webpack.js.org/plugins/css-minimizer-webpack-plugin/" target="_blank" rel="noreferrer">css-minimizer-webpack-plugin</a>ï¼Œç”¨æ³•ï¼š</p><ol><li><p>å®‰è£…ä¾èµ–ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-D</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">css-minimizer-webpack-plugin</span></span></code></pre></div></li><li><p>ä¿®æ”¹ Webpack é…ç½®ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> CssMinimizerPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">css-minimizer-webpack-plugin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> MiniCssExtractPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mini-css-extract-plugin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">module</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">rules</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">.css</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// æ³¨æ„ï¼Œè¿™é‡Œç”¨çš„æ˜¯ \`MiniCssExtractPlugin.loader\` è€Œä¸æ˜¯ \`style-loader\`</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">use</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [MiniCssExtractPlugin</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">loader</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">css-loader</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimizer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line highlighted"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// Webpack5 ä¹‹åï¼Œçº¦å®šä½¿ç”¨ \`&#39;...&#39;\` å­—é¢é‡ä¿ç•™é»˜è®¤ \`minimizer\` é…ç½®</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CssMinimizerPlugin</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// éœ€è¦ä½¿ç”¨ \`mini-css-extract-plugin\` å°† CSS ä»£ç æŠ½å–ä¸ºå•ç‹¬æ–‡ä»¶</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æ‰èƒ½å‘½ä¸­ \`css-minimizer-webpack-plugin\` é»˜è®¤çš„ \`test\` è§„åˆ™</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MiniCssExtractPlugin</span><span style="color:#A6ACCD;">()]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></li></ol><p>è¿™é‡Œçš„é…ç½®é€»è¾‘ï¼Œä¸€æ˜¯ä½¿ç”¨ <code>mini-css-extract-plugin</code> å°† CSS ä»£ç æŠ½å–ä¸ºå•ç‹¬çš„ CSS äº§ç‰©æ–‡ä»¶ï¼Œè¿™æ ·æ‰èƒ½å‘½ä¸­ <code>css-minimizer-webpack-plugin</code> é»˜è®¤çš„ <code>test</code> é€»è¾‘ï¼›äºŒæ˜¯ä½¿ç”¨ <code>css-minimizer-webpack-plugin</code> å‹ç¼© CSS ä»£ç ã€‚æ•ˆæœï¼š</p><p><img src="`+e+'" alt="css minimizer"></p><ul><li><a href="https://github.com/Tecvan-fe/webpack-book-samples/blob/main/minify-css/webpack.config.js" target="_blank" rel="noreferrer">ğŸŒ° minify-css - @github</a></li></ul><p>ä¸ <code>terser-webpack-plugin</code> ç±»ä¼¼ï¼Œ<code>css-minimizer-webpack-plugin</code> ä¹Ÿæ”¯æŒ <code>testã€includeã€excludeã€minifyã€minimizerOptions</code> é…ç½®ï¼Œå…¶ä¸­ <code>minify</code> æ”¯æŒï¼š</p><ul><li>CssMinimizerPlugin.cssnanoMinifyï¼šé»˜è®¤å€¼ï¼Œä½¿ç”¨ <a href="https://cssnano.co/" target="_blank" rel="noreferrer">cssnano</a> å‹ç¼©ä»£ç ï¼Œä¸éœ€è¦é¢å¤–å®‰è£…ä¾èµ–ï¼›</li><li>CssMinimizerPlugin.cssoMinifyï¼šä½¿ç”¨ <a href="https://github.com/css/csso" target="_blank" rel="noreferrer">csso</a> å‹ç¼©ä»£ç ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ä¾èµ– <code>yarn add -D csso</code>ï¼›</li><li>CssMinimizerPlugin.cleanCssMinifyï¼šä½¿ç”¨ <a href="https://github.com/clean-css/clean-css" target="_blank" rel="noreferrer">clean-css</a> å‹ç¼©ä»£ç ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ä¾èµ– <code>yarn add -D clean-css</code>ï¼›</li><li>CssMinimizerPlugin.esbuildMinifyï¼šä½¿ç”¨ <a href="https://esbuild.github.io/" target="_blank" rel="noreferrer">ESBuild</a> å‹ç¼©ä»£ç ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ä¾èµ– <code>yarn add -D esbuild</code>ï¼›</li><li>CssMinimizerPlugin.parcelCssMinifyï¼šä½¿ç”¨ <a href="https://github.com/parcel-bundler/parcel-css" target="_blank" rel="noreferrer">parcel-css</a> å‹ç¼©ä»£ç ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ä¾èµ– <code>yarn add -D</code> <code>@parcel/css</code>ã€‚</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>åŒæ ·çš„ï¼Œ<code>minimizerOptions</code> ä¹Ÿæ˜¯ç›´æ¥é€ä¼ ç»™å…·ä½“ <code>minify</code>ï¼Œå…·ä½“é…ç½®é€‰é¡¹å¯å‚è€ƒ <a href="https://webpack.js.org/plugins/css-minimizer-webpack-plugin/#minimizeroptions" target="_blank" rel="noreferrer">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p></div><p>å…¶ä¸­ <code>parcel-css</code> ä¸ ESBuild å‹ç¼©æ€§èƒ½ç›¸å¯¹è¾ƒä½³ï¼š</p><p><img src="'+t+`" alt="csså‹ç¼©å™¨benchmark"></p><p>ä½†ä¸¤è€…åŠŸèƒ½ä¸å…¼å®¹æ€§ç¨å¼±ï¼Œå¤šæ•°æƒ…å†µä¸‹æ¨èä½¿ç”¨ <code>cssnano</code>ã€‚</p><h2 id="å‹ç¼©html-htmlminifierterser" tabindex="-1">å‹ç¼©HTML - HtmlMinifierTerser <a class="header-anchor" href="#å‹ç¼©html-htmlminifierterser" aria-label="Permalink to &quot;å‹ç¼©HTML - HtmlMinifierTerser&quot;">â€‹</a></h2><p>ç°ä»£ Web åº”ç”¨å¤§å¤šä¼šé€‰æ‹©ä½¿ç”¨ Reactã€Vue ç­‰ MVVM æ¡†æ¶ï¼Œè¿™è¡ç”Ÿå‡ºæ¥çš„ä¸€ä¸ªå‰¯ä½œç”¨æ˜¯åŸç”Ÿ HTML çš„å¼€å‘éœ€æ±‚è¶Šæ¥è¶Šå°‘ï¼ŒHTML ä»£ç å æ¯”è¶Šæ¥è¶Šä½ï¼Œæ‰€ä»¥å¤§å¤šæ•°ç°ä»£ Web é¡¹ç›®ä¸­å…¶å®å¹¶ä¸éœ€è¦è€ƒè™‘ä¸º HTML é…ç½®ä»£ç å‹ç¼©å·¥ä½œæµã€‚ä¸è¿‡å‡¡äº‹éƒ½æœ‰ä¾‹å¤–ï¼ŒæŸäº›åœºæ™¯å¦‚ SSG æˆ–å®˜ç½‘ä¸€ç±»åé™æ€çš„åº”ç”¨ä¸­å°±å­˜åœ¨å¤§é‡å¯è¢«ä¼˜åŒ–çš„ HTML ä»£ç ï¼Œä¸ºæ­¤ç¤¾åŒºä¹Ÿæä¾›äº†ä¸€äº›ç›¸å…³çš„å·¥ç¨‹åŒ–å·¥å…·ï¼Œä¾‹å¦‚ <code>html-minifier-terser</code>ã€‚</p><p><a href="https://github.com/terser/html-minifier-terser" target="_blank" rel="noreferrer">html-minifier-terser</a> æ˜¯ä¸€ä¸ªåŸºäº JavaScript å®ç°çš„ã€é«˜åº¦å¯é…ç½®çš„ HTML å‹ç¼©å™¨ï¼Œæ”¯æŒä¸€ç³»åˆ— <a href="https://github.com/terser/html-minifier-terser#options-quick-reference" target="_blank" rel="noreferrer">å‹ç¼©ç‰¹æ€§</a> å¦‚ï¼š</p><ol><li><p><code>collapseWhitespace</code>ï¼šåˆ é™¤èŠ‚ç‚¹é—´çš„ç©ºå­—ç¬¦ä¸²ï¼Œå¦‚ï¼š</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;"> åŸå§‹ä»£ç ï¼š </span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">    foo </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;"> ç»è¿‡å‹ç¼©çš„ä»£ç ï¼š </span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;&lt;</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">foo</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div></li><li><p><code>removeComments</code>ï¼šåˆ é™¤å¤‡æ³¨ï¼Œå¦‚ï¼š</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;"> åŸå§‹ä»£ç ï¼š </span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;"> some comment </span><span style="color:#89DDFF;">--&gt;&lt;</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">blah</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;"> ç»è¿‡å‹ç¼©çš„ä»£ç ï¼š </span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">blah</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">p</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div></li><li><p><code>collapseBooleanAttributes</code>ï¼šåˆ é™¤ HTML çš„ <a href="https://www.w3.org/TR/html4/intro/sgmltut.html#h-3.3.4.2" target="_blank" rel="noreferrer">Boolean å±æ€§å€¼</a>ï¼Œå¦‚ï¼š</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;!--</span><span style="color:#A6ACCD;"> åŸå§‹ä»£ç ï¼š </span><span style="color:#89DDFF;">--&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">value</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">readonly</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">readonly</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">&lt;!-- ç»è¿‡å‹ç¼©çš„ä»£ç ï¼š --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">input</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">value</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">readonly</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div></li><li><p>ç­‰ç­‰</p></li></ol><p>ğŸŒ°æˆ‘ä»¬å¯ä»¥å€ŸåŠ© <a href="https://webpack.js.org/plugins/html-minimizer-webpack-plugin/" target="_blank" rel="noreferrer">html-minimizer-webpack-plugin</a> æ’ä»¶æ¥å…¥ <code>html-minifier-terser</code> å‹ç¼©å™¨ï¼Œæ­¥éª¤ï¼š</p><ol><li><p>å®‰è£…ä¾èµ–ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-D</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">html-minimizer-webpack-plugin</span></span></code></pre></div></li><li><p>ä¿®æ”¹ Webpack é…ç½®ï¼Œå¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HtmlWebpackPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">html-webpack-plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HtmlMinimizerPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">html-minimizer-webpack-plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">minimizer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// Webpack5 ä¹‹åï¼Œçº¦å®šä½¿ç”¨ \`&#39;...&#39;\` å­—é¢é‡ä¿ç•™é»˜è®¤ \`minimizer\` é…ç½®</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">HtmlMinimizerPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">minimizerOptions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// æŠ˜å  Boolean å‹å±æ€§</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">collapseBooleanAttributes</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ä½¿ç”¨ç²¾ç®€ \`doctype\` å®šä¹‰</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">useShortDoctype</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ç®€å•èµ·è§ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ \`html-webpack-plugin\` è‡ªåŠ¨ç”Ÿæˆ HTML æ¼”ç¤ºæ–‡ä»¶</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">HtmlWebpackPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">templateContent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;html&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;head&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;title&gt;webpack App&lt;/title&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;/head&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;body&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;input readonly=&quot;readonly&quot;/&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;!-- comments --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;script src=&quot;http://www.lilnong.top/urlTrans?group=juejin&amp;url=index_bundle.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;/body&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/html&gt;</span><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div></li></ol><ul><li><a href="https://github.com/Tecvan-fe/webpack-book-samples/blob/main/minify-html/webpack.config.js" target="_blank" rel="noreferrer">ğŸŒ° minify-html - @github</a></li></ul><p>è¿™æ®µé…ç½®çš„å…³é”®é€»è¾‘ï¼Œä¸€æ˜¯é€šè¿‡ <code>html-webpack-plugin</code> ç”Ÿæˆ HTML æ–‡ä»¶ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ç‰¹æ„åœ¨ HTML æ¨¡æ¿ <code>templateContent</code> ä¸­æ’å…¥ä¸€äº›å¯ä»¥è¢«å‹ç¼©çš„ä»£ç ï¼›äºŒæ˜¯é€šè¿‡ <code>html-minimizer-plugin</code> å‹ç¼© HTML ä»£ç ï¼Œæ•ˆæœï¼š</p><p><img src="`+c+'" alt="minify html"></p><p>ä¸Šå›¾ä¸­å·¦è¾¹æ˜¯æ­£å¸¸æ„å»ºç»“æœï¼Œå³å›¾æ˜¯ç»è¿‡ <code>html-minimizer-plugin</code> å‹ç¼©åçš„æ„å»ºç»“æœï¼Œå¯ä»¥çœ‹åˆ°å¦‚ <code>doctype</code> æ ‡ç­¾è¢«åˆ æ‰è‹¥å¹²ä¸é‡è¦çš„å£°æ˜ï¼Œæ–‡æ¡£ä¸­çš„å¤‡æ³¨ä¹Ÿè¢«åˆ é™¤ï¼Œç­‰ç­‰ã€‚</p><p>ä¸ <code>terser-webpack-plugin</code> ç±»ä¼¼ï¼Œ<a href="https://webpack.js.org/plugins/html-minimizer-webpack-plugin/" target="_blank" rel="noreferrer">html-minimizer-webpack-plugin</a> ä¹Ÿæ”¯æŒ <code>includeã€testã€minimizerOptions</code> ç­‰ç­‰ä¸€ç³»åˆ—é…ç½®ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p><p>æ³¨æ„ï¼Œ<a href="https://github.com/terser/html-minifier-terser" target="_blank" rel="noreferrer">html-minifier-terser</a> æä¾›çš„é»˜è®¤é…ç½®æœ‰ç‚¹è¿‡äºä¿å®ˆï¼Œä¾‹å¦‚ <code>removeComments</code> â€”â€” ç”¨äºç§»é™¤ä»£ç å¤‡æ³¨çš„é…ç½®ï¼Œæˆ–è€… <code>useShortDoctype</code> ç”¨äºç®€åŒ– <code>&lt;doctype&gt;</code> æ ‡ç­¾çš„é…ç½®ï¼Œé»˜è®¤ç«Ÿç„¶éƒ½æ˜¯ falseï¼Œè¿™æ”¾åœ¨å½“ä¸‹æµè§ˆå™¨åŠŸèƒ½å·²ç»éå¸¸å¼ºåŠ²ï¼Œå…¼å®¹æ€§é—®é¢˜å·²ç»è¢«å¤§å¤§æŠ¹å¹³çš„èƒŒæ™¯ä¸‹ï¼Œæœ‰ç‚¹å¤§å¯ä¸å¿…äº†ã€‚å› æ­¤ï¼Œå»ºè®®ä½ ä½¿ç”¨æ—¶å…ˆåˆ° <a href="https://github.com/terser/html-minifier-terser#options-quick-reference" target="_blank" rel="noreferrer">å®˜ç½‘</a> ä»”ç»†äº†è§£å„é¡¹é…ç½®ï¼Œå°½å¯èƒ½å¼€å¯æ›´å¤šå‹ç¼©åŠŸèƒ½ã€‚</p><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><p>ç»¼ä¸Šï¼Œä»£ç å‹ç¼©çš„é‡ç‚¹å°±åœ¨äºâ€œä¿æŒåŠŸèƒ½æ€§â€çš„å‰æä¸‹å°½å¯èƒ½â€œåˆ é™¤â€ä¸å¿…è¦çš„å­—ç¬¦ï¼ŒåŸç†è™½ä¸å¤æ‚ä½†å¿…é¡»å¯¹è¯­è¨€ç‰¹æ€§æœ‰æ¯”è¾ƒæ·±çš„ç†è§£æ‰èƒ½å®ç°ï¼Œæ‰€å¹¸ç¤¾åŒºå·²ç»æä¾›äº†å„ç§å„æ ·çš„å‹ç¼©å·¥å…·ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•é…ç½®å°±èƒ½è½»æ¾æ¥å…¥ã€‚</p><p>åœ¨ Webpack ä¸­éœ€è¦ä½¿ç”¨ <code>optimization.minimizer</code> æ•°ç»„æ¥å…¥ä»£ç å‹ç¼©æ’ä»¶ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ’ä»¶æœ‰ï¼š</p><ul><li><code>terser-webpack-plugin</code>ï¼šç”¨äºå‹ç¼© ES6 ä»£ç çš„æ’ä»¶ï¼›</li><li><code>css-minimizer-webpack-plugin</code>ï¼šç”¨äºå‹ç¼© CSS ä»£ç çš„æ’ä»¶ï¼›</li><li><code>html-minifier-terser</code>ï¼šç”¨äºå‹ç¼© HTML ä»£ç çš„æ’ä»¶</li></ul><p>è¿™äº›æ’ä»¶ç”¨æ³•éå¸¸ç›¸ä¼¼ï¼Œéƒ½æ”¯æŒ <code>include/test/exclude</code> é…ç½®é¡¹ï¼Œç”¨äºæ§åˆ¶å‹ç¼©åŠŸèƒ½çš„åº”ç”¨èŒƒå›´ï¼›ä¹Ÿéƒ½æ”¯æŒ <code>minify</code> é…ç½®é¡¹ï¼Œç”¨äºåˆ‡æ¢å‹ç¼©å™¨ï¼Œå€ŸåŠ©è¿™ä¸ªé…ç½®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ€§èƒ½æ›´ä½³çš„å·¥å…·ï¼Œå¦‚ ESBuild æ‰§è¡Œå‹ç¼©ã€‚</p><h2 id="æ€è€ƒé¢˜" tabindex="-1">æ€è€ƒé¢˜ <a class="header-anchor" href="#æ€è€ƒé¢˜" aria-label="Permalink to &quot;æ€è€ƒé¢˜&quot;">â€‹</a></h2><p>ä»£ç å‹ç¼©ä¸ä»£ç æ··æ·†æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œåˆ†åˆ«ç”¨äºè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿå‹ç¼©èƒ½ä»£ç æ··æ·†æ•ˆæœå—ï¼Ÿ</p><details class="details custom-block"><summary>chatgptå›ç­”</summary><p>1ï¸âƒ£ <strong>ä»£ç å‹ç¼©ä¸ä»£ç æ··æ·†æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œåˆ†åˆ«ç”¨äºè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p><p>ä»£ç å‹ç¼©å’Œä»£ç æ··æ·†æœ‰äº›å…³è”ï¼Œä½†å®ƒä»¬æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µã€‚ä»£ç å‹ç¼©é€šå¸¸æ˜¯æŒ‡ä½¿ç”¨å·¥å…·å°†æºä»£ç æ–‡ä»¶å‹ç¼©æˆæœ€å°çš„æ–‡ä»¶å¤§å°ï¼Œä»¥ä¾¿äºç½‘ç»œä¼ è¾“å’ŒåŠ å¿«é¡µé¢åŠ è½½é€Ÿåº¦ã€‚åŒæ—¶ï¼Œå‹ç¼©ä»£ç è¿˜å¯ä»¥å‡å°‘å¸¦å®½ä½¿ç”¨å’Œå­˜å‚¨æˆæœ¬ã€‚</p><p>ä»£ç æ··æ·†åˆ™æ˜¯æŒ‡ä½¿ç”¨å·¥å…·å°†æºä»£ç è¿›è¡ŒåŠ å¯†å’Œè½¬æ¢ï¼Œä½¿å…¶éš¾ä»¥é˜…è¯»å’Œç†è§£ï¼Œä»è€Œå¢åŠ äº†åç¼–è¯‘å’Œç›—å–ä»£ç çš„éš¾åº¦ã€‚æ··æ·†ä»£ç è¿˜å¯ä»¥å¢åŠ ä»£ç çš„å®‰å…¨æ€§å’Œä¿æŠ¤çŸ¥è¯†äº§æƒã€‚å› æ­¤ï¼Œä»£ç æ··æ·†æ›´ä¾§é‡äºä»£ç çš„å®‰å…¨æ€§å’Œä¿å¯†æ€§ï¼Œè€Œä»£ç å‹ç¼©åˆ™æ›´ä¾§é‡äºå‡å°‘æ–‡ä»¶å¤§å°å’Œæé«˜é¡µé¢æ€§èƒ½ã€‚</p><p>2ï¸âƒ£ <strong>å‹ç¼©èƒ½ä»£ç æ··æ·†æ•ˆæœå—ï¼Ÿ</strong></p><p>ä»£ç å‹ç¼©å¯ä»¥å‡å°æ–‡ä»¶å¤§å°ï¼Œä½†å®ƒå¹¶ä¸èƒ½èµ·åˆ°æ··æ·†ä»£ç çš„ä½œç”¨ã€‚è™½ç„¶å‹ç¼©åçš„ä»£ç å¯èƒ½éš¾ä»¥é˜…è¯»ï¼Œä½†æ˜¯å®ƒçš„é€»è¾‘å’Œç»“æ„å¹¶æœªè¢«æ”¹å˜ï¼Œä»£ç å‹ç¼©ä¹Ÿä¸ä¼šåœ¨ä»£ç ä¸­æ·»åŠ é¢å¤–çš„æ··æ·†å†…å®¹ã€‚</p><p>ç›¸åï¼Œä»£ç æ··æ·†æ˜¯ä¸€ç§ç‰¹å®šçš„ä¼˜åŒ–æ–¹æ³•ï¼Œå®ƒé€šè¿‡æ”¹å˜å’Œéšè—ä»£ç çš„ç»“æ„å’Œé€»è¾‘ï¼Œä½¿ä»£ç éš¾ä»¥è¢«ç ´è§£å’Œç›—ç”¨ï¼Œä»è€Œå¢å¼ºä»£ç çš„å®‰å…¨æ€§ã€‚è™½ç„¶ä»£ç æ··æ·†æœ‰æ—¶ä¹Ÿä¼šé™ä½ä»£ç çš„å¯è¯»æ€§ï¼Œä½†å®ƒå…·æœ‰å‰æ‰€æœªæœ‰çš„ç¨‹åº¦çš„å®‰å…¨æ€§ï¼Œå¯ä»¥åœ¨ä¿éšœä»£ç è¿è¡Œæ•ˆç‡çš„åŒæ—¶æé«˜ä»£ç çš„å®‰å…¨æ€§ã€‚</p><p>å› æ­¤ï¼Œè™½ç„¶ä»£ç å‹ç¼©å’Œä»£ç æ··æ·†éƒ½æ˜¯ä¼˜åŒ–ä»£ç çš„æ–¹æ³•ï¼Œä½†å®ƒä»¬çš„ç›®çš„å’Œå®ç°æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œä»»ä½•ä¸€ç§æ–¹æ³•å•ç‹¬ä½¿ç”¨éƒ½ä¸èƒ½å–ä»£å¦ä¸€ç§æ–¹æ³•çš„ä½œç”¨ã€‚</p></details><p>2023å¹´04æœˆ19æ—¥14:54:14</p>',73),D=[i];function y(F,C,A,d,m,u){return a(),n("div",null,D)}const b=s(r,[["render",y]]);export{h as __pageData,b as default};
