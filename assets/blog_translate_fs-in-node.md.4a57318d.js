import{_ as s,c as a,o as n,N as l}from"./chunks/framework.9bcd12c4.js";const C=JSON.parse('{"title":"FS in Node","description":"","frontmatter":{"title":"FS in Node"},"headers":[],"relativePath":"blog/translate/fs-in-node.md","lastUpdated":1679304702000}'),p={name:"blog/translate/fs-in-node.md"},o=l(`<p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ¶µç›–2ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>Node fs APIs æ¦‚è§ˆ</li><li>ä½¿ç”¨è¿™äº›APIsæ‰§è¡Œä¸åŒä»»åŠ¡çš„å°æŠ€å·§ï¼ˆä»£ç ç‰‡æ®µï¼‰</li></ol><p>æœ¬æ–‡å…³æ³¨shellè„šæœ¬ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åªé’ˆå¯¹æ–‡æœ¬æ•°æ®ã€‚</p><p>ç›®å½•ï¼š</p><nav class="table-of-contents"><ul><li><a href="#_1ï¸âƒ£-â­-fs-apisçš„æ¦‚å¿µ-æ¨¡å¼å’Œè§„èŒƒ">1ï¸âƒ£ â­ fs APIsçš„æ¦‚å¿µï¼Œæ¨¡å¼å’Œè§„èŒƒ</a><ul><li><a href="#_1-1-å‡½æ•°ä¸åŒçš„é£æ ¼">1.1 å‡½æ•°ä¸åŒçš„é£æ ¼</a></li><li><a href="#_1-2-â­-è®¿é—®æ–‡ä»¶çš„æ–¹å¼">1.2 â­ è®¿é—®æ–‡ä»¶çš„æ–¹å¼</a></li><li><a href="#_1-3-â­-å‡½æ•°åå‰ç¼€">1.3 â­ å‡½æ•°åå‰ç¼€</a></li><li><a href="#_1-4-é‡è¦çš„ç±»">1.4 é‡è¦çš„ç±»</a></li></ul></li><li><a href="#_2ï¸âƒ£-è¯»å’Œå†™æ–‡ä»¶">2ï¸âƒ£ è¯»å’Œå†™æ–‡ä»¶</a><ul><li><a href="#_2-1-åŒæ­¥è¯»æ–‡ä»¶ä¸ºå•ä¸€å­—ç¬¦ä¸²-å¯é€‰-æ‹†åˆ†ä¸ºè¡Œ">2.1 åŒæ­¥è¯»æ–‡ä»¶ä¸ºå•ä¸€å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼šæ‹†åˆ†ä¸ºè¡Œï¼‰</a></li><li><a href="#_2-2-â­-é€šè¿‡æµè¯»å–æ–‡ä»¶-ä¸€è¡Œæ¥ä¸€è¡Œ">2.2 â­ é€šè¿‡æµè¯»å–æ–‡ä»¶ï¼Œä¸€è¡Œæ¥ä¸€è¡Œ</a></li><li><a href="#_2-3-å•ä¸€å­—ç¬¦ä¸²åŒæ­¥å†™å…¥æ–‡ä»¶">2.3 å•ä¸€å­—ç¬¦ä¸²åŒæ­¥å†™å…¥æ–‡ä»¶</a></li><li><a href="#_2-4-è¿½åŠ å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­-åŒæ­¥çš„">2.4 è¿½åŠ å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ï¼ˆåŒæ­¥çš„ï¼‰</a></li><li><a href="#_2-5-ä½¿ç”¨æµå†™å…¥å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­">2.5 ä½¿ç”¨æµå†™å…¥å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­</a></li><li><a href="#_2-6-é€šè¿‡æµè¿½åŠ å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­-å¼‚æ­¥çš„">2.6 é€šè¿‡æµè¿½åŠ å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ï¼ˆå¼‚æ­¥çš„ï¼‰</a></li></ul></li><li><a href="#_3ï¸âƒ£-è·¨å¹³å°å¤„ç†è¡Œåˆ†éš”ç¬¦">3ï¸âƒ£ è·¨å¹³å°å¤„ç†è¡Œåˆ†éš”ç¬¦</a><ul><li><a href="#_3-1-è¯»å–è¡Œåˆ†éš”ç¬¦">3.1 è¯»å–è¡Œåˆ†éš”ç¬¦</a></li><li><a href="#_3-2-å†™è¡Œåˆ†å‰²ç¬¦">3.2 å†™è¡Œåˆ†å‰²ç¬¦</a></li></ul></li><li><a href="#_4ï¸âƒ£-â­-éå†å’Œåˆ›å»ºç›®å½•">4ï¸âƒ£ â­ éå†å’Œåˆ›å»ºç›®å½•</a><ul><li><a href="#_4-1-éå†ä¸€ä¸ªç›®å½•">4.1 éå†ä¸€ä¸ªç›®å½•</a></li><li><a href="#_4-2-åˆ›å»ºç›®å½•-mkdir-mkdir-p">4.2 åˆ›å»ºç›®å½•ï¼ˆmkdir, mkdir -pï¼‰</a></li><li><a href="#_4-3-ç¡®ä¿çˆ¶ç›®å½•å­˜åœ¨">4.3 ç¡®ä¿çˆ¶ç›®å½•å­˜åœ¨</a></li><li><a href="#_4-4-åˆ›å»ºä¸´æ—¶ç›®å½•">4.4 åˆ›å»ºä¸´æ—¶ç›®å½•</a></li></ul></li><li><a href="#_5ï¸âƒ£-æ‹·è´-é‡å‘½å-ç§»åŠ¨æ–‡ä»¶æˆ–è€…ç›®å½•">5ï¸âƒ£ æ‹·è´ï¼Œé‡å‘½åï¼Œç§»åŠ¨æ–‡ä»¶æˆ–è€…ç›®å½•</a><ul><li><a href="#_5-1-æ‹·è´æ–‡ä»¶æˆ–ç›®å½•">5.1 æ‹·è´æ–‡ä»¶æˆ–ç›®å½•</a></li><li><a href="#_5-2-é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹">5.2 é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</a></li></ul></li><li><a href="#_6ï¸âƒ£-ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•">6ï¸âƒ£ ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•</a><ul><li><a href="#_6-1-ç§»é™¤æ–‡ä»¶å’Œä»»æ„ç›®å½•-shell-rm-rm-r">6.1 ç§»é™¤æ–‡ä»¶å’Œä»»æ„ç›®å½•ï¼ˆshell: rm, rm -rï¼‰</a></li><li><a href="#_6-2-ç§»é™¤ç©ºç›®å½•-shell-rmdir">6.2 ç§»é™¤ç©ºç›®å½•ï¼ˆshell: rmdirï¼‰</a></li><li><a href="#_6-3-æ¸…ç©ºç›®å½•">6.3 æ¸…ç©ºç›®å½•</a></li><li><a href="#_6-4-trashåº“">6.4 trashåº“</a></li></ul></li><li><a href="#_7ï¸âƒ£-è¯»å’Œæ”¹å˜æ–‡ä»¶ç³»ç»Ÿæ¡ç›®">7ï¸âƒ£ è¯»å’Œæ”¹å˜æ–‡ä»¶ç³»ç»Ÿæ¡ç›®</a><ul><li><a href="#_7-1-â­-æ£€æµ‹æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨">7.1 â­ æ£€æµ‹æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨</a></li><li><a href="#_7-2-æ£€æµ‹æ–‡ä»¶stats-æ˜¯å¦æ˜¯è·¯å¾„-åˆ›å»ºæ—¶é—´-ç­‰">7.2 æ£€æµ‹æ–‡ä»¶statsï¼šæ˜¯å¦æ˜¯è·¯å¾„ï¼Ÿåˆ›å»ºæ—¶é—´ï¼Ÿç­‰</a></li><li><a href="#_7-3-æ”¹å˜æ–‡ä»¶ç‰¹æ€§-æƒé™-æ‹¥æœ‰è€…-ç»„-æ—¶é—´æˆ³">7.3 æ”¹å˜æ–‡ä»¶ç‰¹æ€§ï¼šæƒé™ï¼Œæ‹¥æœ‰è€…ï¼Œç»„ï¼Œæ—¶é—´æˆ³</a></li></ul></li><li><a href="#_8ï¸âƒ£-æ“ä½œé“¾æ¥-links">8ï¸âƒ£ æ“ä½œé“¾æ¥ï¼ˆLinksï¼‰</a></li><li><a href="#_9ï¸âƒ£-è¿›ä¸€æ­¥é˜…è¯»">9ï¸âƒ£ è¿›ä¸€æ­¥é˜…è¯»</a></li></ul></nav><h2 id="_1ï¸âƒ£-â­-fs-apisçš„æ¦‚å¿µ-æ¨¡å¼å’Œè§„èŒƒ" tabindex="-1">1ï¸âƒ£ â­ fs APIsçš„æ¦‚å¿µï¼Œæ¨¡å¼å’Œè§„èŒƒ <a class="header-anchor" href="#_1ï¸âƒ£-â­-fs-apisçš„æ¦‚å¿µ-æ¨¡å¼å’Œè§„èŒƒ" aria-label="Permalink to &quot;1ï¸âƒ£ â­ fs APIsçš„æ¦‚å¿µï¼Œæ¨¡å¼å’Œè§„èŒƒ&quot;">â€‹</a></h2><p>æœ¬èŠ‚ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢2ä¸ªå¼•å…¥ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fsPromises </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs/promises</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><h3 id="_1-1-å‡½æ•°ä¸åŒçš„é£æ ¼" tabindex="-1">1.1 å‡½æ•°ä¸åŒçš„é£æ ¼ <a class="header-anchor" href="#_1-1-å‡½æ•°ä¸åŒçš„é£æ ¼" aria-label="Permalink to &quot;1.1 å‡½æ•°ä¸åŒçš„é£æ ¼&quot;">â€‹</a></h3><p>ğŸ“šNode fs APIsæœ‰3ç§ä¸åŒçš„é£æ ¼ï¼š</p><ol><li>1ç§åŒæ­¥é£æ ¼ï¼Œæ¯”å¦‚ <ul><li><a href="https://nodejs.org/api/fs.html#fsreadfilesyncpath-options" target="_blank" rel="noreferrer">fs.readFileSync(path, options?): string|Buffer</a></li></ul></li><li>2ç§å¼‚æ­¥é£æ ¼ <ol><li><strong>åŸºäºå›è°ƒå‡½æ•°</strong> çš„å¼‚æ­¥é£æ ¼ï¼Œæ¯”å¦‚ <ul><li><a href="https://nodejs.org/api/fs.html#fsreadfilepath-options-callback" target="_blank" rel="noreferrer">fs.readFile(path, options?, callback): void</a></li></ul></li><li><strong>åŸºäºPromiseså‡½æ•°</strong> çš„å¼‚æ­¥é£æ ¼ï¼Œæ¯”å¦‚ï¼š <ul><li><a href="https://nodejs.org/api/fs.html#fspromisesreadfilepath-options" target="_blank" rel="noreferrer">fsPromises.readFile(path, options?): Promise&lt;string|Buffer&gt;</a></li></ul></li></ol></li></ol><p>ğŸš€ä¸Šé¢3ä¸ªä¾‹å­ï¼Œå±•ç¤ºäº†åŠŸèƒ½ç›¸åŒå‡½æ•°çš„å‘½åè§„èŒƒï¼š</p><ul><li>åŸºäºå›è°ƒçš„å‡½æ•°æœ‰ä¸€ä¸ªåŸºç¡€åï¼š<code>fs.readFile()</code></li><li>åŸºäºPromiseçš„ç‰ˆæœ¬åå­—ç›¸åŒï¼Œä½†æ˜¯åœ¨ä¸åŒæ¨¡å—ä¸­ï¼š<code>fsPromises.readFile()</code></li><li>åŒæ­¥ç‰ˆæœ¬çš„åå­—ä¸ºï¼ŒåŸºç¡€åå­— + <code>Sync</code> åç¼€ï¼š<code>fs.readFileSync()</code></li></ul><p>ä¸‹é¢è¿›ä¸€æ­¥çœ‹çœ‹è¿™3ç§é£æ ¼ã€‚</p><h4 id="_1-1-1-åŒæ­¥å‡½æ•°" tabindex="-1">1.1.1 åŒæ­¥å‡½æ•° <a class="header-anchor" href="#_1-1-1-åŒæ­¥å‡½æ•°" aria-label="Permalink to &quot;1.1.1 åŒæ­¥å‡½æ•°&quot;">â€‹</a></h4><p>åŒæ­¥å‡½æ•°æœ€ç®€å• - å®ƒä»¬ç«‹å³è¿”å›å€¼ï¼Œå‡ºç°å¼‚å¸¸åˆ™æŠ›å‡ºé”™è¯¯ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/etc/passwd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> encoding</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#A6ACCD;"> (err) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æœ¬æ–‡ä¸»è¦ä½¿ç”¨è¿™ç§é£æ ¼ï¼Œå› ä¸ºå®ƒä»¬å¾ˆæ–¹ä¾¿ï¼Œå¹¶ä¸”å¾ˆé€‚åˆshellè„šæœ¬ğŸ˜ã€‚</p><h4 id="_1-1-2-åŸºäºpromiseçš„å‡½æ•°" tabindex="-1">1.1.2 åŸºäºPromiseçš„å‡½æ•° <a class="header-anchor" href="#_1-1-2-åŸºäºpromiseçš„å‡½æ•°" aria-label="Permalink to &quot;1.1.2 åŸºäºPromiseçš„å‡½æ•°&quot;">â€‹</a></h4><p>è¿”å› <a href="https://exploringjs.com/impatient-js/ch_promises.html" target="_blank" rel="noreferrer">Promises</a>ï¼Œå®Œæˆåˆ™è¿”å›ç»“æœæˆ–rejecté”™è¯¯:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fsPromises </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs/promises</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// A</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fsPromises</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFile</span><span style="color:#F07178;">(</span></span>
<span class="line highlighted"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/etc/passwd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> encoding</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line highlighted"><span style="color:#F07178;">  )</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#A6ACCD;"> (err) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>æ³¨æ„ <code>A</code> è¡Œå¤„çš„æ¨¡å—æŒ‡ç¤ºç¬¦ï¼šåŸºäºPromiseçš„APIä½äºä¸åŒçš„æ¨¡å—ä¸­ã€‚</p><h4 id="_1-1-3-åŸºäºcallbackçš„å‡½æ•°" tabindex="-1">1.1.3 åŸºäºCallbackçš„å‡½æ•° <a class="header-anchor" href="#_1-1-3-åŸºäºcallbackçš„å‡½æ•°" aria-label="Permalink to &quot;1.1.3 åŸºäºCallbackçš„å‡½æ•°&quot;">â€‹</a></h4><p>åŸºäºå›è°ƒçš„å‡½æ•°å°†ç»“æœå’Œé”™è¯¯ä¼ é€’ç»™callbacksï¼Œå®ƒæ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFile</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/etc/passwd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">result</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// error-first callback</span></span>
<span class="line highlighted"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line highlighted"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span></span>
<span class="line highlighted"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line highlighted"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;">)</span></span>
<span class="line highlighted"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>æœ¬æ–‡ä¸ä¼šä½¿ç”¨è¿™ç§é£æ ¼ã€‚<a href="https://nodejs.org/en/knowledge/getting-started/control-flow/what-are-callbacks/" target="_blank" rel="noreferrer">Nodeæ–‡æ¡£ä¸­æœ‰å…·ä½“ä»‹ç»</a></p><h3 id="_1-2-â­-è®¿é—®æ–‡ä»¶çš„æ–¹å¼" tabindex="-1">1.2 â­ è®¿é—®æ–‡ä»¶çš„æ–¹å¼ <a class="header-anchor" href="#_1-2-â­-è®¿é—®æ–‡ä»¶çš„æ–¹å¼" aria-label="Permalink to &quot;1.2 â­ è®¿é—®æ–‡ä»¶çš„æ–¹å¼&quot;">â€‹</a></h3><ol><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²è¯»æˆ–å†™æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹</li><li>æˆ‘ä»¬å¯ä»¥ä»¥æµçš„æ–¹å¼æ‰“å¼€æˆ–è€…å†™å…¥ï¼Œä¸€æ¬¡æ€§æ›´å°å—çš„å¤„ç†æ–‡ä»¶ã€‚æµåªå…è®¸é¡ºåºè®¿é—®</li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>file descriptors</code>ï¼‰ æˆ– æ–‡ä»¶å¥æŸ„ï¼ˆ<code>FileHandles</code>ï¼‰ï¼Œé€šè¿‡ä¸€ä¸ªç±»ä¼¼äºæµçš„APIæ¥è·å¾—é¡ºåºè®¿é—®å’Œéšæœºè®¿é—® <ul><li><a href="https://nodejs.org/api/fs.html#file-descriptors_1" target="_blank" rel="noreferrer">æ–‡ä»¶æè¿°ç¬¦</a> æ˜¯è¡¨ç¤ºæ–‡ä»¶çš„æ•´æ•°ã€‚å®ƒä»¬é€šè¿‡å¦‚ä¸‹å‡½æ•°ç®¡ç†ï¼ˆä¸‹é¢åªå±•ç¤ºåŒæ­¥ç‰ˆæœ¬ï¼Œå½“ç„¶ä¹Ÿæœ‰åŸºäºå›è°ƒçš„ç‰ˆæœ¬ - <code>fs.open()</code> ç­‰ï¼‰ï¼š <ul><li><code>fs.openSync(path, flags?, mode?)</code> æ‰“å¼€ä¸€ä¸ªæŒ‡å®šè·¯å¾„çš„æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶åå°†å…¶è¿”å›</li><li><code>fs.closeSync(fd)</code> å…³é—­æ–‡ä»¶æè¿°ç¬¦</li><li><code>fs.fchmodSync(fd, mode)</code></li><li><code>fs.fchownSync(fd, uid, gid)</code></li><li><code>fs.fdatasyncSync(fd)</code></li><li><code>fs.fstatSync(fd, options?)</code></li><li><code>fs.fsyncSync(fd)</code></li><li><code>fs.ftruncateSync(fd, len?)</code></li><li><code>fs.futimesSync(fd, atime, mtime)</code></li></ul></li><li><strong>åªæœ‰åŒæ­¥ç‰ˆæœ¬å’ŒåŸºäºå›è°ƒçš„APIæ‰ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼ŒåŸºäºPromiseç‰ˆæœ¬APIæœ‰æ›´å¥½çš„æŠ½è±¡ - <a href="https://nodejs.org/api/fs.html#class-filehandle" target="_blank" rel="noreferrer">class FileHandle</a></strong> - å®ƒåŸºäºæ–‡ä»¶æè¿°ç¬¦ğŸ¤©ã€‚é€šè¿‡ <code>fsPromises.open()</code> åˆ›å»ºçš„å®ä¾‹ï¼Œå„ç§æ“ä½œé€šè¿‡æ–¹æ³•çš„å½¢å¼æä¾›ï¼ˆè€Œä¸æ˜¯å‡½æ•°ï¼‰ï¼š <ul><li><code>fileHandle.close()</code></li><li><code>fileHandle.chmod(mode)</code></li><li><code>fileHandle.chown(uid, gid)</code></li><li>...</li></ul></li></ul></li></ol><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>ğŸš¨ æœ¬æ–‡ä¸ä½¿ç”¨ç¬¬3ç§å½¢å¼ï¼Œæˆ‘ä»¬çš„ç›®çš„åªä½¿ç”¨ç¬¬1,2ç§æ–¹å¼å°±è¶³å¤Ÿäº†ã€‚</p></div><h3 id="_1-3-â­-å‡½æ•°åå‰ç¼€" tabindex="-1">1.3 â­ å‡½æ•°åå‰ç¼€ <a class="header-anchor" href="#_1-3-â­-å‡½æ•°åå‰ç¼€" aria-label="Permalink to &quot;1.3 â­ å‡½æ•°åå‰ç¼€&quot;">â€‹</a></h3><h4 id="_1-3-1-å‰ç¼€-l-ç¬¦å·é“¾æ¥" tabindex="-1">1.3.1 å‰ç¼€ <code>l</code> : ç¬¦å·é“¾æ¥ <a class="header-anchor" href="#_1-3-1-å‰ç¼€-l-ç¬¦å·é“¾æ¥" aria-label="Permalink to &quot;1.3.1 å‰ç¼€ \`l\` : ç¬¦å·é“¾æ¥&quot;">â€‹</a></h4><p>ä»¥ <code>l</code> å¼€å¤´çš„å‡½æ•°é€šå¸¸æ˜¯å¯¹ç¬¦å·é“¾æ¥è¿›è¡Œæ“ä½œçš„ï¼š</p><ul><li><code>fs.lchmodSync()</code> + <code>fs.lchmod()</code> + <code>fsPromises.lchmod()</code></li><li><code>fs.lchownSync()</code> + <code>fs.lchown()</code> + <code>fsPromises.lchown()</code></li><li><code>fs.lutimeSync()</code> + <code>fs.lutimes()</code> + <code>fsPromises.lutimes()</code></li><li>...ç­‰ç­‰</li></ul><h4 id="_1-3-2-å‰ç¼€-f-æ–‡ä»¶æè¿°ç¬¦" tabindex="-1">1.3.2 å‰ç¼€ <code>f</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ <a class="header-anchor" href="#_1-3-2-å‰ç¼€-f-æ–‡ä»¶æè¿°ç¬¦" aria-label="Permalink to &quot;1.3.2 å‰ç¼€ \`f\`ï¼šæ–‡ä»¶æè¿°ç¬¦&quot;">â€‹</a></h4><p>ä»¥ <code>f</code> å¼€å¤´çš„å‡½æ•°é€šå¸¸ç”¨äºç®¡ç†æ–‡ä»¶æè¿°ç¬¦ï¼š</p><ul><li><code>fs.fchmodSync()</code> + <code>fs.fchmod()</code></li><li><code>fs.fchownSync()</code> + <code>fs.fchown()</code></li><li><code>fs.fstatSync()</code> + <code>fs.fstate()</code></li><li>...ç­‰ç­‰</li></ul><h3 id="_1-4-é‡è¦çš„ç±»" tabindex="-1">1.4 é‡è¦çš„ç±» <a class="header-anchor" href="#_1-4-é‡è¦çš„ç±»" aria-label="Permalink to &quot;1.4 é‡è¦çš„ç±»&quot;">â€‹</a></h3><p>æœ‰å‡ ä¸ªç±»åœ¨Nodeæ–‡ä»¶ç³»ç»ŸAPIä¸­æ‰®æ¼”ç€ä¸¾è¶³è½»é‡çš„è§’è‰²ã€‚</p><h4 id="_1-4-1-â­-urls-å­—ç¬¦ä¸²æ–‡ä»¶ç³»ç»Ÿçš„å¦ä¸€ç§é€‰æ‹©" tabindex="-1">1.4.1 â­ URLs : å­—ç¬¦ä¸²æ–‡ä»¶ç³»ç»Ÿçš„å¦ä¸€ç§é€‰æ‹© <a class="header-anchor" href="#_1-4-1-â­-urls-å­—ç¬¦ä¸²æ–‡ä»¶ç³»ç»Ÿçš„å¦ä¸€ç§é€‰æ‹©" aria-label="Permalink to &quot;1.4.1 â­ URLs : å­—ç¬¦ä¸²æ–‡ä»¶ç³»ç»Ÿçš„å¦ä¸€ç§é€‰æ‹©&quot;">â€‹</a></h4><p>ğŸš€ğŸš€ æ¯å½“æŸä¸ªNodeå‡½æ•°æ¥æ”¶ä»¥å­—ç¬¦ä¸²å½¢å¼çš„æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ï¼ˆè¡Œ <code>A</code>ï¼‰ï¼Œé€šå¸¸ä¹Ÿå¯ä»¥æ¥æ”¶ä¸€ä¸ª <code>URL</code> å®ä¾‹ï¼ˆè¡Œ <code>B</code>ï¼‰:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/tmp/text-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// A</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Text Content</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  )</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file:///tmp/text-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// B</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Text Content</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  )</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>æ‰‹åŠ¨è½¬æ¢è·¯å¾„å’Œ <code>file:</code> URLsçœ‹èµ·æ¥å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯å´æœ‰å¾ˆå¤šå¼Šç«¯ï¼šç™¾åˆ†å·ç¼–ç æˆ–è§£ç ï¼ŒWindowsç£ç›˜ç›˜ç¬¦ç­‰ã€‚ç›¸åï¼Œæœ€å¥½ä½¿ç”¨ä¸‹é¢2ä¸ªå‡½æ•°ï¼š</p><ol><li><a href="https://nodejs.org/api/url.html#urlpathtofileurlpath" target="_blank" rel="noreferrer">url.pathToFileURL()</a></li><li><a href="https://nodejs.org/api/url.html#urlpathtofileurlpath" target="_blank" rel="noreferrer">url.fileURLToPath()</a></li></ol><div class="info custom-block"><p class="custom-block-title">INFO</p><p>æœ¬æ–‡å¹¶ä¸ä¼šä½¿ç”¨æ–‡ä»¶URLs.</p></div><h4 id="_1-4-2-buffers" tabindex="-1">1.4.2 Buffers <a class="header-anchor" href="#_1-4-2-buffers" aria-label="Permalink to &quot;1.4.2 Buffers&quot;">â€‹</a></h4><p>Nodeä¸­çš„ <a href="https://nodejs.org/api/buffer.html" target="_blank" rel="noreferrer">Buffer</a> è¡¨ç¤º <em>å›ºå®šé•¿åº¦çš„å­—èŠ‚åºåˆ—</em>ã€‚å®ƒæ˜¯ <code>Uint8Array</code> (ä¸€ç§ <a href="https://exploringjs.com/impatient-js/ch_typed-arrays.html" target="_blank" rel="noreferrer">TypedArray</a>)ã€‚Buffersä¸»è¦å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆ<code>binary files</code>ï¼‰ï¼Œå› æ­¤æœ¬æ–‡å¹¶ä¸ä¼šä½¿ç”¨å®ƒã€‚</p><p>ğŸ‘©â€ğŸ« å½“Nodeæ¥æ”¶ä¸€ä¸ªBufferæ—¶ï¼Œå®ƒä¹Ÿæ¥æ”¶ä¸€ä¸ªUint8Arrayã€‚å› æ­¤ï¼Œ<strong>é‰´äºUint8Arraysæ˜¯è·¨å¹³å°çš„ï¼Œè€ŒBufferså¹¶ä¸æ˜¯ï¼Œå› æ­¤æ›´åå‘é€‰æ‹©Uint8Arrays</strong>ã€‚</p><p>Buffersèƒ½å®ŒæˆUint8Arraysä¸èƒ½å®Œæˆçš„ä¸€ä»¶äº‹ï¼šä»¥å¤šç§æ ¼å¼ç¼–ç å’Œè§£ç æ–‡æœ¬ğŸ˜ã€‚å¦‚æœæˆ‘ä»¬ä»¥Uint8Arraysç¼–ç æˆ–è§£ç UTF-8ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://developer.mozilla.org/en-US/docs/Web/API/TextEncoder" target="_blank" rel="noreferrer">TextEncoder</a> æˆ– <a href="https://developer.mozilla.org/en-US/docs/Web/API/TextDecoder" target="_blank" rel="noreferrer">TextDecoder</a> ç±»ã€‚è¿™äº›ç±»åœ¨å¤§å¤šæ•°JSå¹³å°éƒ½å¯ä»¥ä½¿ç”¨ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TextEncoder</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">encode</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cafÃ©</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// Uint8Array.of(99, 97, 102, 195, 169)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TextDecoder</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decode</span><span style="color:#A6ACCD;">(Uint8Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">99</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">97</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">102</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">195</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">169</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;cafÃ©&#39;</span></span>
<span class="line"></span></code></pre></div><h4 id="_1-4-3-node-js-streams" tabindex="-1">1.4.3 Node.js Streams <a class="header-anchor" href="#_1-4-3-node-js-streams" aria-label="Permalink to &quot;1.4.3 Node.js Streams&quot;">â€‹</a></h4><p>æœ‰äº›å‡½æ•°æ¥æ”¶æˆ–è¿”å›åŸç”Ÿçš„Node.jsæµï¼š</p><ul><li><code>stream.Readable</code> æ˜¯Nodeä¸­ç”¨äºå¯è¯»çš„æµã€‚æ¨¡å— <code>node:fs</code> ä½¿ç”¨ <code>fs.ReadStream</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­ç±»</li><li><code>stream.Writable</code> æ˜¯Nodeä¸­ç”¨äºå†™å…¥çš„æµã€‚æ¨¡å— <code>node:fs</code> ä½¿ç”¨ <code>fs.WriteStream</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­ç±»</li></ul><p>é™¤äº†ä½¿ç”¨åŸç”Ÿæµï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨Nodeä¸­ä½¿ç”¨è·¨å¹³å°çš„ <code>web stream</code></p><ul><li><a href="https://2ality.com/2022/06/web-streams-nodejs.html" target="_blank" rel="noreferrer">Using web streams on Node.js - 2ality</a></li></ul><h2 id="_2ï¸âƒ£-è¯»å’Œå†™æ–‡ä»¶" tabindex="-1">2ï¸âƒ£ è¯»å’Œå†™æ–‡ä»¶ <a class="header-anchor" href="#_2ï¸âƒ£-è¯»å’Œå†™æ–‡ä»¶" aria-label="Permalink to &quot;2ï¸âƒ£ è¯»å’Œå†™æ–‡ä»¶&quot;">â€‹</a></h2><h3 id="_2-1-åŒæ­¥è¯»æ–‡ä»¶ä¸ºå•ä¸€å­—ç¬¦ä¸²-å¯é€‰-æ‹†åˆ†ä¸ºè¡Œ" tabindex="-1">2.1 åŒæ­¥è¯»æ–‡ä»¶ä¸ºå•ä¸€å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼šæ‹†åˆ†ä¸ºè¡Œï¼‰ <a class="header-anchor" href="#_2-1-åŒæ­¥è¯»æ–‡ä»¶ä¸ºå•ä¸€å­—ç¬¦ä¸²-å¯é€‰-æ‹†åˆ†ä¸ºè¡Œ" aria-label="Permalink to &quot;2.1 åŒæ­¥è¯»æ–‡ä»¶ä¸ºå•ä¸€å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼šæ‹†åˆ†ä¸ºè¡Œï¼‰&quot;">â€‹</a></h3><p><a href="https://nodejs.org/api/fs.html#fsreadfilesyncpath-options" target="_blank" rel="noreferrer">fs.readFileSync</a> åŒæ­¥è¯»å– <code>filePath</code> å¤„çš„æ–‡ä»¶ä¸ºå•ä¸€å­—ç¬¦ä¸²ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">there</span><span style="color:#A6ACCD;">\\r\\n</span><span style="color:#C3E88D;">are</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">multiple</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">lines</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼ˆå¯¹æ¯”æµï¼‰ï¼š</p><ul><li>ğŸ˜‹ä¼˜ç‚¹ï¼šä½¿ç”¨ç®€å•ï¼Œå¹¶ä¸”åŒæ­¥ã€‚é€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯</li><li>ğŸ˜¥ç¼ºç‚¹ï¼šä¸é€‚ç”¨äºå¤§æ–‡ä»¶ï¼šåœ¨æˆ‘ä»¬å¤„ç†æ•°æ®å‰ï¼Œå¿…é¡»å°†å…¶å®Œå…¨è¯»å–åˆ°å†…å­˜ä¸­</li></ul><p>ä¸‹é¢çœ‹çœ‹æ‹†åˆ†å­—ç¬¦ä¸²ï¼Œä»¥è¡Œçš„æ–¹å¼è¯»å–ã€‚</p><h4 id="_2-1-1-æ‹†åˆ†è¡Œ-å¹¶ä¸”ä¸åŒ…å«è¡Œåˆ†éš”ç¬¦" tabindex="-1">2.1.1 æ‹†åˆ†è¡Œï¼Œå¹¶ä¸”ä¸åŒ…å«è¡Œåˆ†éš”ç¬¦ <a class="header-anchor" href="#_2-1-1-æ‹†åˆ†è¡Œ-å¹¶ä¸”ä¸åŒ…å«è¡Œåˆ†éš”ç¬¦" aria-label="Permalink to &quot;2.1.1 æ‹†åˆ†è¡Œï¼Œå¹¶ä¸”ä¸åŒ…å«è¡Œåˆ†éš”ç¬¦&quot;">â€‹</a></h4><p>ä¸‹é¢ä»£ç æ‹†åˆ†å­—ç¬¦ä¸²ä¸ºè¡Œçš„åŒæ—¶ï¼Œç§»é™¤è¡Œåˆ†éš”ç¬¦ã€‚é€‚ç”¨äºUnixå’ŒWindowsè¡Œåˆ†éš”ç¬¦ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> RE_SPLIT_EOL </span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">\\r</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">\\n</span><span style="color:#89DDFF;">/</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">splitLines</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">str</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">RE_SPLIT_EOL</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">splitLines</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">there</span><span style="color:#A6ACCD;">\\r\\n</span><span style="color:#C3E88D;">are</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">multiple</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">lines</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">there</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">are</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">multiple</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lines</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><code>EOL</code> è¡¨ç¤º <code>end of line</code>ã€‚æˆ‘ä»¬åŒæ—¶æ¥æ”¶Unixè¡Œåˆ†å‰²ç¬¦ï¼ˆ<code>\\n</code>ï¼‰å’Œ Windowsè¡Œåˆ†éš”ç¬¦ï¼ˆ<code>\\r\\n</code>ï¼‰ã€‚</p><h4 id="_2-1-2-æ‹†åˆ†è¡Œ-å¹¶ä¸”ä¿ç•™è¡Œåˆ†éš”ç¬¦" tabindex="-1">2.1.2 æ‹†åˆ†è¡Œï¼Œå¹¶ä¸”ä¿ç•™è¡Œåˆ†éš”ç¬¦ <a class="header-anchor" href="#_2-1-2-æ‹†åˆ†è¡Œ-å¹¶ä¸”ä¿ç•™è¡Œåˆ†éš”ç¬¦" aria-label="Permalink to &quot;2.1.2 æ‹†åˆ†è¡Œï¼Œå¹¶ä¸”ä¿ç•™è¡Œåˆ†éš”ç¬¦&quot;">â€‹</a></h4><p>ä¸‹é¢ä»£ç å°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºè¡Œï¼Œå¹¶ä¸”ä¿ç•™è¡Œåˆ†éš”ç¬¦ã€‚åŒæ—¶é€‚ç”¨äºUnixå’ŒWindowsè¡Œåˆ†éš”ç¬¦ï¼šã€</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> RE_SPLIT_AFTER_EOL </span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/(?&lt;=</span><span style="color:#C3E88D;">\\r</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">\\n</span><span style="color:#89DDFF;">)/</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// A</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">splitLines</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">str</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">RE_SPLIT_EOL</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">splitLinesWithEols</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">there</span><span style="color:#A6ACCD;">\\r\\n</span><span style="color:#C3E88D;">are</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">multiple</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">lines</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">there</span><span style="color:#A6ACCD;">\\r\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">are</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">multiple</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lines</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">splitLinesWithEols</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">first</span><span style="color:#A6ACCD;">\\n\\n</span><span style="color:#C3E88D;">third</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">first</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">third</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">splitLinesWithEols</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">EOL at the end</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">EOL at the end</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">splitLinesWithEols</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>Aè¡Œå¤„ä½¿ç”¨äº† <a href="https://jamessawyer.github.io/deep-javascript-cn/6/Regular-expressions-lookaround-assertions-by-example.html#_1%EF%B8%8F%E2%83%A3-%E2%AD%90-cheatsheet-%E7%8E%AF%E8%A7%86%E6%96%AD%E8%A8%80" target="_blank" rel="noreferrer">åè¡Œæ–­è¨€</a> æ­£åˆ™è¡¨è¾¾å¼ã€‚å®ƒåŒ¹é…åé¢è·Ÿç€çš„æ¨¡å¼ <code>\\r?\\n</code>ï¼Œä½†å®ƒè‡ªèº«ä¸ä¼šè¢«æ•è·ã€‚å› æ­¤ï¼Œå®ƒä¸ä¼šåˆ é™¤å°†è¾“å…¥å­—ç¬¦ä¸²åˆ†å‰²æˆçš„å­—ç¬¦ä¸²ç‰‡æ®µä¹‹é—´çš„ä»»ä½•å†…å®¹ã€‚</p><p>å¯¹äºä¸æ”¯æŒåç»­æ–­è¨€çš„å¼•æ“ï¼ˆ<a href="https://caniuse.com/js-regexp-lookbehind" target="_blank" rel="noreferrer">caniuse - lookbehind</a>ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢æ–¹æ¡ˆï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">splitLinesWithEols</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">str</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">lines</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> []</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">prevEnd</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">prevEnd</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æœç´¢ \`\\n\`ï¼Œæ„å‘³ç€æˆ‘ä»¬ä¹Ÿèƒ½æ‰¾åˆ° \`\\r\\n\`</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newlineIndex</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">indexOf</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">prevEnd</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¦‚æœå­˜åœ¨æ–°è¡Œï¼Œå®ƒè¢«åŒ…å«åœ¨æ”¹è¡Œä¸­</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">end</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newlineIndex</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newlineIndex</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">lines</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">str</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">slice</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">prevEnd</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">end</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">prevEnd</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">end</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">lines</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¿™ä¸ªæ–¹æ¡ˆç®€å•ï¼Œä½†æ˜¯å¤ªå†—é•¿ã€‚</p><p>2ä¸ªç‰ˆæœ¬éƒ½åŒæ—¶æ¥æ”¶Unixå’ŒWindowsè¡Œåˆ†éš”ç¬¦ï¼Œæ›´å¤šå¯æŸ¥çœ‹ï¼š<a href="https://2ality.com/2022/06/nodejs-file-system.html#handling-line-terminators-across-platforms" target="_blank" rel="noreferrer">Handling line terminators across platforms</a></p><h3 id="_2-2-â­-é€šè¿‡æµè¯»å–æ–‡ä»¶-ä¸€è¡Œæ¥ä¸€è¡Œ" tabindex="-1">2.2 â­ é€šè¿‡æµè¯»å–æ–‡ä»¶ï¼Œä¸€è¡Œæ¥ä¸€è¡Œ <a class="header-anchor" href="#_2-2-â­-é€šè¿‡æµè¯»å–æ–‡ä»¶-ä¸€è¡Œæ¥ä¸€è¡Œ" aria-label="Permalink to &quot;2.2 â­ é€šè¿‡æµè¯»å–æ–‡ä»¶ï¼Œä¸€è¡Œæ¥ä¸€è¡Œ&quot;">â€‹</a></h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æµçš„æ–¹å¼è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Readable</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:stream</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> nodeReadable </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createReadStream</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;">// ğŸ’¡ webè·¨å¹³å°æµ</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> webReadableStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Readable</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toWeb</span><span style="color:#A6ACCD;">(nodeReadable)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> lineStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> webReadableStream</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">pipeThrough</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ChunksToLinesStream</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> (</span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> line </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> lineStream) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">line</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è¾“å‡º</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;there\\r\\n&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;are\\n&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;multiple\\n&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;lines&#39;</span></span>
<span class="line"></span></code></pre></div><p>ğŸš€ğŸš€æˆ‘ä»¬ä½¿ç”¨äº†ä¸‹é¢å¤–éƒ¨å‡½æ•°ï¼š</p><ol><li><a href="https://nodejs.org/api/fs.html#fscreatereadstreampath-options" target="_blank" rel="noreferrer">fs.createReadStream(filePath, options?)</a> åˆ›å»ºNode.jsæµï¼ˆ<code>stream.Readable</code> å®ä¾‹ï¼‰</li><li><a href="https://nodejs.org/api/stream.html#streamreadabletowebstreamreadable" target="_blank" rel="noreferrer">stream.Readable.toWeb(streamReadable)</a> å°†Nodeå¯è¯»æµè½¬æ¢ä¸ºwebæµï¼ˆ<code>ReadableStream</code> å®ä¾‹ï¼‰</li><li><code>ChunksToLinesStream</code> åœ¨ <a href="https://2ality.com/2022/06/web-streams-nodejs.html#example%3A-transforming-a-stream-of-arbitrary-chunks-to-a-stream-of-lines" target="_blank" rel="noreferrer">Using web streams on Node.js</a> ä¸­å·²è§£é‡Šã€‚<strong>å—ï¼ˆ<code>Chunks</code>ï¼‰æ˜¯ç”±æµäº§ç”Ÿçš„æ•°æ®ç‰‡æ®µ</strong>ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæµï¼Œå®ƒæ˜¯ä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²å—ï¼Œé€šè¿‡ <code>ChunksToLinesStream</code> ç®¡é“ï¼Œæˆ‘ä»¬å°†è·å¾—ä¸€ä¸ªå—æ˜¯è¡Œçš„æµã€‚</li></ol><p>Webæµæ˜¯ <a href="https://exploringjs.com/impatient-js/ch_async-iteration.html" target="_blank" rel="noreferrer">å¼‚æ­¥å¯è¿­ä»£çš„</a>ï¼Œè¿™å›ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>for-await-of</code> å¾ªç¯è¿­ä»£è¡Œã€‚</p><p>å¦‚æœä½ å¯¹æ–‡æœ¬è¡Œä¸æ„Ÿå…´è¶£ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨ <code>ChunksToLinesStream</code>ï¼Œå¯¹ <code>webReadableStream</code> è¿­ä»£ï¼Œå¾—åˆ°ä»»æ„é•¿åº¦çš„å—ã€‚</p><p>æ›´å¤šä¿¡æ¯L:</p><ul><li>webæµåœ¨ <a href="https://2ality.com/2022/06/web-streams-nodejs.html#example%3A-transforming-a-stream-of-arbitrary-chunks-to-a-stream-of-lines" target="_blank" rel="noreferrer">Using web streams on Node.js</a> å·²ä»‹ç»</li><li>è¡Œåˆ†å‰²ç¬¦åœ¨ä¸Šé¢ä¹Ÿä»‹ç»äº†</li></ul><p>è¿™ç§æ–¹å¼ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼ˆå¯¹æ¯” è¯»å–å•ä¸€å­—ç¬¦ä¸²ï¼‰ï¼š</p><ul><li>ğŸ˜‹ä¼˜ç‚¹ï¼šå¯¹å¤§æ–‡ä»¶æ•ˆæœå¥½ - æˆ‘ä»¬å¯ä»¥é€æ¸å¤„ç†æ•°æ®ï¼Œä¸€å°å—ä¸€å°å—çš„ï¼Œä¸éœ€ç­‰å¾…å°†æ•°æ®å®Œå…¨è¯»å–åˆ°å†…å­˜ä¸­</li><li>ğŸ˜¥ç¼ºç‚¹ï¼šå¾ˆå¤æ‚ï¼Œä¸æ˜¯åŒæ­¥çš„</li></ul><h3 id="_2-3-å•ä¸€å­—ç¬¦ä¸²åŒæ­¥å†™å…¥æ–‡ä»¶" tabindex="-1">2.3 å•ä¸€å­—ç¬¦ä¸²åŒæ­¥å†™å…¥æ–‡ä»¶ <a class="header-anchor" href="#_2-3-å•ä¸€å­—ç¬¦ä¸²åŒæ­¥å†™å…¥æ–‡ä»¶" aria-label="Permalink to &quot;2.3 å•ä¸€å­—ç¬¦ä¸²åŒæ­¥å†™å…¥æ–‡ä»¶&quot;">â€‹</a></h3><p><a href="https://nodejs.org/api/fs.html#fswritefilesyncfile-data-options" target="_blank" rel="noreferrer">fs.writeFileSync(filePath, str, options?)</a> å°† <code>str</code> å†™å…¥åˆ° <code>filePath</code> å¤„çš„æ–‡ä»¶ä¸­ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™ä¼šè¦†å†™ã€‚</p><p>ğŸŒ°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeFileSync</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">new-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">First line</span><span style="color:#A6ACCD;">\\n</span><span style="color:#C3E88D;">Second line</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>ä¼˜ç¼ºç‚¹ï¼ˆå¯¹æ¯”æµæ–¹å¼ï¼‰ï¼š</p><ul><li>ğŸ˜‹ä¼˜ç‚¹ï¼šä½¿ç”¨ç®€å•ï¼ŒåŒæ­¥ã€‚ä½¿ç”¨å¤§å¤šæ•°åœºæ™¯</li><li>ğŸ˜¥ç¼ºç‚¹ï¼šä¸é€‚ç”¨äºå¤§æ–‡ä»¶</li></ul><h3 id="_2-4-è¿½åŠ å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­-åŒæ­¥çš„" tabindex="-1">2.4 è¿½åŠ å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ï¼ˆåŒæ­¥çš„ï¼‰ <a class="header-anchor" href="#_2-4-è¿½åŠ å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­-åŒæ­¥çš„" aria-label="Permalink to &quot;2.4 è¿½åŠ å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ï¼ˆåŒæ­¥çš„ï¼‰&quot;">â€‹</a></h3><p>ä¸‹é¢ä»£ç è¿½åŠ æ–‡æœ¬åˆ°å·²ç»å­˜åœ¨çš„æ–‡ä»¶ä¸­ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeFileSync</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">new-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Append line</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">flag</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">// ğŸš¨ æ³¨æ„è¿™é‡Œçš„ \`flag\`</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>ğŸ“šè¿™é‡Œçš„ä»£ç å‡ ä¹å’Œä¸Šé¢ç›¸åŒã€‚å”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œæ·»åŠ äº† <code>.flag</code> é…ç½®ï¼š <code>&#39;a&#39;</code> è¡¨ç¤ºè¿½åŠ æ•°æ®ã€‚å…¶ä½™å¯èƒ½çš„é…ç½®å€¼ï¼ˆæ¯”å¦‚ï¼Œæ–‡ä»¶ä¸å­˜åœ¨æŠ›å‡ºé”™è¯¯ï¼‰å¯å‚è€ƒ <a href="https://nodejs.org/api/fs.html#fswritefilesyncfile-data-options" target="_blank" rel="noreferrer">fs.WriteFileSync-data-options</a></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>ğŸš¨ åœ¨æŸäº›å‡½æ•°ä¸­ï¼Œè¿™ä¸ªé…ç½®é¡¹åä¸º <code>.flag</code>ï¼Œè€Œæœ‰ä¸€äº›åˆæ˜¯ <code>.flags</code>ã€‚</p></div><h3 id="_2-5-ä½¿ç”¨æµå†™å…¥å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­" tabindex="-1">2.5 ä½¿ç”¨æµå†™å…¥å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ <a class="header-anchor" href="#_2-5-ä½¿ç”¨æµå†™å…¥å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­" aria-label="Permalink to &quot;2.5 ä½¿ç”¨æµå†™å…¥å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­&quot;">â€‹</a></h3><p>ğŸŒ°ä¸‹é¢ä»£ç ä½¿ç”¨æµå†™å…¥å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Writable</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:stream</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> nodeWritable </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createWriteStream</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">new-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> webWritableStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Writable</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toWeb</span><span style="color:#A6ACCD;">(nodeWritable)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> writer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> webWritableStream</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getWriter</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">First line</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line highlighted"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Second line</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line highlighted"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">finally</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">releaseLock</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>ğŸš€ğŸš€æˆ‘ä»¬ä½¿ç”¨äº†ä¸‹é¢å‡½æ•°ï¼š</p><ul><li><a href="https://nodejs.org/api/fs.html#fscreatewritestreampath-options" target="_blank" rel="noreferrer">fs.createWriteStream(path, options?)</a> åˆ›å»ºNodeæµï¼ˆ<code>stream.Writable</code> å®ä¾‹ï¼‰</li><li><a href="https://nodejs.org/api/stream.html#streamwritabletowebstreamwritable" target="_blank" rel="noreferrer">stream.Writable.toWeb(streamWritable)</a> å°†Nodeå¯å†™æµè½¬æ¢ä¸ºwebæµï¼ˆ<code>WritableStream</code> å®ä¾‹ï¼‰</li></ul><p>æ›´å¤šä¿¡æ¯ï¼š</p><ul><li>WritableStream &amp; Writers åœ¨ <a href="https://2ality.com/2022/06/web-streams-nodejs.html" target="_blank" rel="noreferrer">Using web streams On Node.js</a> ä¸­å·²ç»ä»‹ç»</li><li>è¡Œåˆ†å‰²ç¬¦åœ¨ä¸Šé¢ä¹Ÿä»‹ç»äº†</li></ul><p>ä¼˜ç¼ºç‚¹ï¼ˆå¯¹æ¯”å†™å…¥å•ä¸€å­—ç¬¦ä¸²ï¼‰ï¼š</p><ul><li>ğŸ˜‹ä¼˜ç‚¹ï¼šé€‚ç”¨äºå¤§æ–‡ä»¶ï¼Œå› ä¸ºæ•°æ®æ˜¯ä»¥å°å—å°å—é€æ­¥å†™å…¥çš„</li><li>ğŸ˜¥ç¼ºç‚¹ï¼šå¾ˆå¤æ‚ï¼Œä¸æ˜¯åŒæ­¥çš„æ–¹å¼</li></ul><h3 id="_2-6-é€šè¿‡æµè¿½åŠ å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­-å¼‚æ­¥çš„" tabindex="-1">2.6 é€šè¿‡æµè¿½åŠ å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ï¼ˆå¼‚æ­¥çš„ï¼‰ <a class="header-anchor" href="#_2-6-é€šè¿‡æµè¿½åŠ å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­-å¼‚æ­¥çš„" aria-label="Permalink to &quot;2.6 é€šè¿‡æµè¿½åŠ å¤šä¸ªå­—ç¬¦ä¸²åˆ°æ–‡ä»¶ä¸­ï¼ˆå¼‚æ­¥çš„ï¼‰&quot;">â€‹</a></h3><p>ä¸‹é¢ä½¿ç”¨æµè¿½åŠ æ–‡æœ¬åˆ°å·²å­˜åœ¨æ–‡ä»¶ä¸­ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Writable</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:stream</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> nodeWritable </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createWriteStream</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">existing-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">flags</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// ğŸš¨ æ³¨æ„è¿™é‡Œæ˜¯ \`flags\` è€Œä¸æ˜¯ \`flag\`</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> webWritableStream </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Writable</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toWeb</span><span style="color:#A6ACCD;">(nodeWritable)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> writer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> webWritableStream</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getWriter</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">First appended line</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Second appended line</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">finally</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">writer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">releaseLock</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¿™ä¸ªä»£ç å’Œä¸Šé¢å‡ ä¹ä¸€æ ·ã€‚å”¯ä¸€åŒºåˆ«åœ¨äºæˆ‘ä»¬æ·»åŠ äº† <code>.flags</code> é…ç½®é¡¹ï¼šå€¼ä¸º <code>a</code>ï¼Œå…¶ä½™å¯èƒ½çš„é…ç½®å€¼ï¼ˆæ¯”å¦‚ï¼Œæ–‡ä»¶ä¸å­˜åœ¨æŠ›å‡ºé”™è¯¯ï¼‰å¯å‚è€ƒ <a href="https://nodejs.org/api/fs.html#fswritefilesyncfile-data-options" target="_blank" rel="noreferrer">fs.WriteFileSync-data-options</a></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>ğŸš¨ åœ¨æŸäº›å‡½æ•°ä¸­ï¼Œè¿™ä¸ªé…ç½®é¡¹åä¸º <code>.flag</code>ï¼Œè€Œæœ‰ä¸€äº›åˆæ˜¯ <code>.flags</code>ã€‚</p></div><h2 id="_3ï¸âƒ£-è·¨å¹³å°å¤„ç†è¡Œåˆ†éš”ç¬¦" tabindex="-1">3ï¸âƒ£ è·¨å¹³å°å¤„ç†è¡Œåˆ†éš”ç¬¦ <a class="header-anchor" href="#_3ï¸âƒ£-è·¨å¹³å°å¤„ç†è¡Œåˆ†éš”ç¬¦" aria-label="Permalink to &quot;3ï¸âƒ£ è·¨å¹³å°å¤„ç†è¡Œåˆ†éš”ç¬¦&quot;">â€‹</a></h2><p>ğŸ‘©â€ğŸ«ä¸æ˜¯æ‰€æœ‰çš„å¹³å°çš„è¡Œåˆ†éš”ç¬¦ï¼ˆEOLï¼‰éƒ½æ˜¯ç›¸åŒçš„ï¼š</p><ul><li>åœ¨Windowsä¸­ï¼ŒEOLæ˜¯ <code>\\r\\n</code></li><li>åœ¨Unixä¸­ï¼ŒEOLæ˜¯ <code>\\n</code></li></ul><p>æƒ³è¦è·¨å¹³å°å¤„ç†EOLï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‡ ç§ç­–ç•¥ã€‚</p><h3 id="_3-1-è¯»å–è¡Œåˆ†éš”ç¬¦" tabindex="-1">3.1 è¯»å–è¡Œåˆ†éš”ç¬¦ <a class="header-anchor" href="#_3-1-è¯»å–è¡Œåˆ†éš”ç¬¦" aria-label="Permalink to &quot;3.1 è¯»å–è¡Œåˆ†éš”ç¬¦&quot;">â€‹</a></h3><p>å½“è¯»å–æ–‡æœ¬æ—¶ï¼Œæœ€å¥½è¯†åˆ«2ä¸ªå¹³å°çš„EOLsã€‚</p><p>å½“å°†æ–‡æœ¬åˆ†æˆè¡Œæ—¶ï¼Œä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿæˆ‘ä»¬å¯ä»¥å°†eol(ä»¥ä»»ä½•ä¸€ç§æ ¼å¼)åŒ…æ‹¬åœ¨æœ€åã€‚å¦‚æœæˆ‘ä»¬ä¿®æ”¹è¿™äº›è¡Œå¹¶å°†å®ƒä»¬å†™å…¥æ–‡ä»¶ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿå°½å¯èƒ½å°‘åœ°æ›´æ”¹ã€‚</p><p>å½“å¤„ç†åŒ…å«EOLsè¡Œæ—¶ï¼Œæœ‰æ—¶ç§»é™¤å®ƒä»¬ä¹Ÿå¾ˆæœ‰ç”¨ - æ¯”å¦‚ï¼šé€šè¿‡ä¸‹é¢å‡½æ•°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> RE_EOL_REMOVE </span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">\\r</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">\\n</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">removeEol</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">line</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">match</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">RE_EOL_REMOVE</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exec</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">line</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">match</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">line</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">line</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">slice</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">match</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">index</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">removeEol</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Windows EOL</span><span style="color:#A6ACCD;">\\r\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Windows EOL</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">removeEol</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Unix EOL</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Unix EOL</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">removeEol</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">No EOL</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">No EOL</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-2-å†™è¡Œåˆ†å‰²ç¬¦" tabindex="-1">3.2 å†™è¡Œåˆ†å‰²ç¬¦ <a class="header-anchor" href="#_3-2-å†™è¡Œåˆ†å‰²ç¬¦" aria-label="Permalink to &quot;3.2 å†™è¡Œåˆ†å‰²ç¬¦&quot;">â€‹</a></h3><p>å½“ç¢°åˆ°å†™å…¥è¡Œåˆ†éš”ç¬¦æ—¶ï¼Œæˆ‘ä»¬æœ‰2ç§æ–¹æ³•ï¼š</p><ul><li><a href="https://nodejs.org/api/os.html#oseol" target="_blank" rel="noreferrer">&#39;node:os&#39;æ¨¡å—åŒ…å«å¸¸é‡EOL</a> è¡¨ç¤ºå½“å‰å¹³å°çš„EOL</li><li>æˆ‘ä»¬å¯ä»¥æ£€æµ‹è¾“å…¥æ–‡ä»¶çš„EOLæ ¼å¼ï¼Œç„¶ååœ¨æ”¹å˜è¯¥æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨è¯¥EOL</li></ul><h2 id="_4ï¸âƒ£-â­-éå†å’Œåˆ›å»ºç›®å½•" tabindex="-1">4ï¸âƒ£ â­ éå†å’Œåˆ›å»ºç›®å½• <a class="header-anchor" href="#_4ï¸âƒ£-â­-éå†å’Œåˆ›å»ºç›®å½•" aria-label="Permalink to &quot;4ï¸âƒ£ â­ éå†å’Œåˆ›å»ºç›®å½•&quot;">â€‹</a></h2><h3 id="_4-1-éå†ä¸€ä¸ªç›®å½•" tabindex="-1">4.1 éå†ä¸€ä¸ªç›®å½• <a class="header-anchor" href="#_4-1-éå†ä¸€ä¸ªç›®å½•" aria-label="Permalink to &quot;4.1 éå†ä¸€ä¸ªç›®å½•&quot;">â€‹</a></h3><p>ä¸‹é¢å‡½æ•°éå†ç›®å½•ï¼Œå¹¶åˆ—ä¸¾å…¶æ‰€æœ‰åä»£ï¼ˆå­å…ƒç´ ï¼ŒåŠå­å…ƒç´ çš„å­å…ƒç´ ï¼‰ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">dirPath</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dirEntries</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readdirSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">dirPath</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">withFileType</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¯¹æ¡ç›®è¿›è¡Œæ’åºï¼Œä»¥ä¿æŒç›®å½•æ›´æœ‰è°ƒç†æ€§</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">dirEntries</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sort</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">a</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">b</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">localeCompare</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">b</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">en</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  )</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dirEntry</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dirEntries</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fileName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dirEntry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">pathName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">dirPath</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fileName</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">pathName</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">dirEntry</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isDirectory</span><span style="color:#F07178;">()) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">pathName</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// ğŸ’¡ é€’å½’</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>ä¸Šé¢å‡½æ•°ä½¿ç”¨äº†å¦‚ä¸‹å‡½æ•°ï¼š</p><ul><li><a href="https://nodejs.org/api/fs.html#fsreaddirsyncpath-options" target="_blank" rel="noreferrer">fs.readdirSync(thePath, options?)</a> è¿”å› <code>thePath</code> è·¯å¾„ä¸‹çš„å­å…ƒç´  <ul><li>å¦‚æœé…ç½® <code>withFileTypes: true</code>ï¼Œå‡½æ•°è¿”å› <code>ç›®å½•æ¡ç›®ï¼ˆdirectory entriesï¼‰</code>ï¼Œä¸€ä¸ª <a href="https://nodejs.org/api/fs.html#class-fsdirent" target="_blank" rel="noreferrer">fs.Dirent</a> å®ä¾‹ã€‚å®ƒæœ‰å¦‚ä¸‹å±æ€§ï¼š <ul><li>dirent.name</li><li>dirent.isDirectory()</li><li>dirent.isFile()</li><li>dirent.isSymbolicLink()</li></ul></li><li>å¦‚æœ <code>withFileTypes: false</code> æˆ–ä¹œæœ‰æä¾›ï¼Œå‡½æ•°è¿”å›æ–‡ä»¶åçš„å­—ç¬¦ä¸²</li></ul></li></ul><p>å®æˆ˜ğŸŒ°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> (</span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> filePath </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">filePath</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// è¾“å‡º</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;dir/dir-file.txt&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;dir/subdir&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;dir/subdir/subdir-file1.txt&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// &#39;dir/subdir/subdir-file2.csv&#39;</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-2-åˆ›å»ºç›®å½•-mkdir-mkdir-p" tabindex="-1">4.2 åˆ›å»ºç›®å½•ï¼ˆmkdir, mkdir -pï¼‰ <a class="header-anchor" href="#_4-2-åˆ›å»ºç›®å½•-mkdir-mkdir-p" aria-label="Permalink to &quot;4.2 åˆ›å»ºç›®å½•ï¼ˆmkdir, mkdir -pï¼‰&quot;">â€‹</a></h3><p>ğŸ“’ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢å‡½æ•°åˆ›å»ºç›®å½•ï¼š<a href="https://nodejs.org/api/fs.html#fsmkdirsyncpath-options" target="_blank" rel="noreferrer">fs.mkdirSync</a></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirSync</span><span style="color:#A6ACCD;">(thePath</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> options</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><code>options.recursive</code> å†³å®šå‡½æ•°å¦‚æœåˆ›å»º <code>thePath</code> ç›®å½•ï¼š</p><ul><li>å¦‚æœ <code>recursive: false</code> æˆ–ä¸æä¾›ï¼Œ<code>mkdirSync()</code> å¯¹å¦‚ä¸‹2ç§æƒ…å†µè¿”å›undeinfedæˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼š <ul><li><code>thePath</code> å¤„ç›®å½•ï¼ˆæˆ–æ–‡ä»¶ï¼‰å·²ç»å­˜åœ¨</li><li><code>thePath</code> çš„çˆ¶ç›®å½•ä¸å­˜åœ¨</li></ul></li><li>å¦‚æœ <code>recursive: true</code>: <ul><li>å³ä½¿ <code>thePath</code> å¤„ç›®å½•å·²ç»å­˜åœ¨ä¹Ÿæ²¡é—®é¢˜</li><li><code>thePath</code> çš„ç¥–å…ˆç›®å½•åœ¨éœ€è¦æ—¶è¢«åˆ›å»ºğŸ˜</li><li><code>mkdirSync()</code> è¿”å›ç¬¬ä¸€ä¸ªæœ€æ–°åˆ›å»ºçš„ç›®å½•çš„è·¯å¾„</li></ul></li></ul><p>å®æˆ˜ğŸŒ°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// éå†å½“å‰ç›®å½•çš„ç›®å½• æŸ¥çœ‹4.1èŠ‚</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub/subsub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">recursive</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub/subsub</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-3-ç¡®ä¿çˆ¶ç›®å½•å­˜åœ¨" tabindex="-1">4.3 ç¡®ä¿çˆ¶ç›®å½•å­˜åœ¨ <a class="header-anchor" href="#_4-3-ç¡®ä¿çˆ¶ç›®å½•å­˜åœ¨" aria-label="Permalink to &quot;4.3 ç¡®ä¿çˆ¶ç›®å½•å­˜åœ¨&quot;">â€‹</a></h3><p>å¦‚æœæˆ‘ä»¬æƒ³æŒ‰éœ€è®¾ç½®ä¸€ä¸ªåµŒå¥—çš„æ–‡ä»¶ç»“æ„ï¼Œ<strong>å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸ç¼ºç¡®è®¤ç¥–å…ˆç›®å½•æ˜¯å¦å­˜åœ¨ğŸ˜…</strong>ã€‚ä¸‹é¢å‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ensureParentDirectory</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">filePath</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parentDir</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">filePath</span><span style="color:#F07178;">)</span></span>
<span class="line highlighted"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">existsSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">parentDir</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨çˆ¶ç›®å½•</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">parentDir</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">recursive</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>å®æˆ˜ğŸŒ°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> filePath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub/subsub/new-file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line highlighted"><span style="color:#82AAFF;">ensureParentDirectory</span><span style="color:#A6ACCD;">(filePath) </span><span style="color:#676E95;font-style:italic;">// A</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeFileSync</span><span style="color:#A6ACCD;">(filePath</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">content</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub/subsub</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/sub/subsub/new-file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-4-åˆ›å»ºä¸´æ—¶ç›®å½•" tabindex="-1">4.4 åˆ›å»ºä¸´æ—¶ç›®å½• <a class="header-anchor" href="#_4-4-åˆ›å»ºä¸´æ—¶ç›®å½•" aria-label="Permalink to &quot;4.4 åˆ›å»ºä¸´æ—¶ç›®å½•&quot;">â€‹</a></h3><p>ğŸ“’ <a href="https://nodejs.org/api/fs.html#fsmkdtempsyncprefix-options" target="_blank" rel="noreferrer">fs.mktempSync(pathPrefix, options?)</a> åˆ›å»ºä¸´æ—¶ç›®å½•ï¼šå®ƒä¼šæ·»åŠ 6ä¸ªéšæœºå­—ç¬¦ç»™ <code>pathPrefix</code>ï¼Œåœ¨æ–°çš„è·¯å¾„åˆ›å»ºç›®å½•ï¼Œå¹¶è¿”å›è¯¥è·¯å¾„ã€‚</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><code>pathPrefix</code> ä¸èƒ½ä»¥å¤§å†™ <code>X</code> ç»“å°¾ï¼Œå› ä¸ºæŸäº›å¹³å°ä¼šå°†å°¾éƒ¨çš„ <code>X</code>s ç”¨éšæœºå­—ç¬¦æ›¿æ¢ã€‚</p></div><p>å¦‚æœæˆ‘ä»¬æƒ³åœ¨æ“ä½œç³»ç»Ÿç‰¹å®šçš„å…¨å±€ä¸´æ—¶ç›®å½•åˆ›å»ºä¸´æ—¶ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://nodejs.org/api/os.html#ostmpdir" target="_blank" rel="noreferrer">os.tmpdir()</a> å‡½æ•°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> os </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:os</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> pathPrefix </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tmpdir</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">my-app</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// è·¯å¾„å‰ç¼€</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// e.g. &#39;/var/folders/ph/sz0384m11vxf/T/my-app&#39;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> tempPath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mktempSync</span><span style="color:#A6ACCD;">(pathPrefix) </span><span style="color:#676E95;font-style:italic;">// éšæœºç»™å‰ç¼€æ·»åŠ 6ä¸ªéšæœºå­—ç¬¦</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// e.g. &#39;/var/folders/ph/sz0384m11vxf/T/my-app1QXOXP&#39;</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>ğŸ’¡ ä¸´æ—¶ç›®å½•ä¸ä¼šéšç€Nodeè„šæœ¬çš„ç»“æŸè€Œè‡ªåŠ¨è¢«ç§»é™¤ã€‚è¦ä¹ˆæˆ‘ä»¬è‡ªå·±åˆ é™¤å®ƒï¼Œè¦ä¹ˆä¾èµ–æ“ä½œç³»ç»Ÿé—´æ­‡æ€§çš„æ¸…ç†å…¨å±€ä¸´æ—¶ç›®å½•ï¼ˆä¹Ÿæœ‰å¯èƒ½ä¸è¢«ç§»é™¤ï¼‰</p></div><h2 id="_5ï¸âƒ£-æ‹·è´-é‡å‘½å-ç§»åŠ¨æ–‡ä»¶æˆ–è€…ç›®å½•" tabindex="-1">5ï¸âƒ£ æ‹·è´ï¼Œé‡å‘½åï¼Œç§»åŠ¨æ–‡ä»¶æˆ–è€…ç›®å½• <a class="header-anchor" href="#_5ï¸âƒ£-æ‹·è´-é‡å‘½å-ç§»åŠ¨æ–‡ä»¶æˆ–è€…ç›®å½•" aria-label="Permalink to &quot;5ï¸âƒ£ æ‹·è´ï¼Œé‡å‘½åï¼Œç§»åŠ¨æ–‡ä»¶æˆ–è€…ç›®å½•&quot;">â€‹</a></h2><h3 id="_5-1-æ‹·è´æ–‡ä»¶æˆ–ç›®å½•" tabindex="-1">5.1 æ‹·è´æ–‡ä»¶æˆ–ç›®å½• <a class="header-anchor" href="#_5-1-æ‹·è´æ–‡ä»¶æˆ–ç›®å½•" aria-label="Permalink to &quot;5.1 æ‹·è´æ–‡ä»¶æˆ–ç›®å½•&quot;">â€‹</a></h3><p>ğŸ“’ <a href="https://nodejs.org/api/fs.html#fscpsyncsrc-dest-options" target="_blank" rel="noreferrer">fs.cpSync(srcPath, destPath, options?)</a>ï¼šä» <code>srcPath</code> å¤„æ‹·è´æ–‡ä»¶æˆ–ç›®å½•åˆ° <code>desPath</code>ã€‚æœ‰è¶£é…ç½®ï¼š</p><ul><li><code>recursive</code> (é»˜è®¤ <code>false</code>)ï¼šåªæœ‰è¿™ä¸ªé…ç½®ä¸º <code>true</code> æ—¶ï¼Œç›®å½•ï¼ˆåŒ…å«ç©ºç›®å½•ï¼‰æ‰ä¼šè¢«æ‹·è´</li><li><code>force</code> (é»˜è®¤ <code>true</code>)ï¼šå¦‚æœä¸º <code>true</code>ï¼Œå·²å­˜åœ¨çš„æ–‡ä»¶å°†è¢«è¦†å†™ã€‚å¦‚æœ <code>false</code>ï¼Œå·²ç»å­˜åœ¨çš„æ–‡ä»¶ä¼šè¢«ä¿å­˜ï¼š <ul><li><code>force: false</code> æ—¶ï¼Œè®¾ç½® <code>errorOnExist: true</code> æ—¶ï¼Œå¦‚æœå­˜åœ¨æ–‡ä»¶è·¯å¾„å†²çªï¼Œä¼šæŠ›å‡ºé”™è¯¯</li></ul></li><li><code>filter</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…è®¸æˆ‘ä»¬æ§åˆ¶å“ªäº›æ–‡ä»¶è¢«æ‹·è´ğŸ˜</li><li><code>preserveTimestamps</code> (é»˜è®¤ <code>false</code>)ï¼šå¦‚æœ <code>true</code>ï¼Œè¢«æ‹·è´åˆ° <code>destPath</code> çš„æ–‡ä»¶æˆ–ç›®å½•ä¿æŒå’Œæ¥æº <code>srcPath</code> ä¸€æ ·çš„æ—¶é—´æˆ³</li></ul><p>å®æˆ˜ğŸŒ°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-orig</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-orig/some-filex.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cpSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-orig</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-copy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">recursive</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-copy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-copy/some-file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-orig</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir-orig/some-filex.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_5-2-é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹" tabindex="-1">5.2 é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ <a class="header-anchor" href="#_5-2-é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹" aria-label="Permalink to &quot;5.2 é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹&quot;">â€‹</a></h3><p>ğŸ“’ <a href="https://nodejs.org/api/fs.html#fsrenamesyncoldpath-newpath" target="_blank" rel="noreferrer">fs.renameSync(oldPath, newPath)</a> å°† <code>oldPath</code> é‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•åˆ° <code>newPath</code>ã€‚</p><p>ğŸŒ°é‡å‘½åä¸€ä¸ªç›®å½•ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">old-dir-name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">old-dir-name/some-file-txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">renameSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">old-dir-name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">new-dir-name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// é‡å‘½åæ•ˆæœ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">new-dir-name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">new-dir-name/some-file-txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>ğŸŒ°ç§»åŠ¨æ–‡ä»¶ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">renameSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// ç§»åŠ¨æ•ˆæœ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">some-file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="_6ï¸âƒ£-ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•" tabindex="-1">6ï¸âƒ£ ç§»é™¤æ–‡ä»¶æˆ–ç›®å½• <a class="header-anchor" href="#_6ï¸âƒ£-ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•" aria-label="Permalink to &quot;6ï¸âƒ£ ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•&quot;">â€‹</a></h2><h3 id="_6-1-ç§»é™¤æ–‡ä»¶å’Œä»»æ„ç›®å½•-shell-rm-rm-r" tabindex="-1">6.1 ç§»é™¤æ–‡ä»¶å’Œä»»æ„ç›®å½•ï¼ˆshell: rm, rm -rï¼‰ <a class="header-anchor" href="#_6-1-ç§»é™¤æ–‡ä»¶å’Œä»»æ„ç›®å½•-shell-rm-rm-r" aria-label="Permalink to &quot;6.1 ç§»é™¤æ–‡ä»¶å’Œä»»æ„ç›®å½•ï¼ˆshell: rm, rm -rï¼‰&quot;">â€‹</a></h3><p>ğŸ“’ <a href="https://nodejs.org/api/fs.html#fsrmsyncpath-options" target="_blank" rel="noreferrer">fs.rmSync(thePath, options?)</a> ç§»é™¤ <code>thePath</code> å¤„çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚æœ‰è¶£çš„é…ç½®é¡¹ï¼š</p><ul><li><code>recursive</code> (é»˜è®¤ <code>false</code>)ï¼š åªæœ‰è¿™ä¸ªé…ç½®ä¸º <code>true</code> æ—¶ï¼Œç›®å½•ï¼ˆåŒ…æ‹¬ç©ºç›®å½•ï¼‰æ‰ä¼šè¢«ç§»é™¤</li><li><code>force</code> (é»˜è®¤ <code>false</code>)ï¼šå¦‚æœä¸º <code>false</code>ï¼Œå½“ <code>thePath</code> ä¸å­˜åœ¨è¯¥æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</li></ul><p>ğŸŒ°ç§»é™¤æ–‡ä»¶ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rmSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>ğŸŒ° ä½¿ç”¨ <code>fs.rmSync()</code> é€’å½’ç§»é™¤éç©ºç›®å½•ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rmSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">recursive</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// é€’å½’ç§»é™¤å­ç›®å½•åŠå…¶æ–‡ä»¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_6-2-ç§»é™¤ç©ºç›®å½•-shell-rmdir" tabindex="-1">6.2 ç§»é™¤ç©ºç›®å½•ï¼ˆshell: rmdirï¼‰ <a class="header-anchor" href="#_6-2-ç§»é™¤ç©ºç›®å½•-shell-rmdir" aria-label="Permalink to &quot;6.2 ç§»é™¤ç©ºç›®å½•ï¼ˆshell: rmdirï¼‰&quot;">â€‹</a></h3><p>ğŸ“’ <a href="https://nodejs.org/api/fs.html#fsrmdirsyncpath-options" target="_blank" rel="noreferrer">fs.rmdirSync(thePath, options?)</a> ç§»é™¤ç©ºç›®å½•ï¼ˆå¦‚æœç›®å½•ä¸ä¸ºç©ºï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚</p><p>ğŸŒ°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rmdirSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// ç§»é™¤ç©ºç›®å½•</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_6-3-æ¸…ç©ºç›®å½•" tabindex="-1">6.3 æ¸…ç©ºç›®å½• <a class="header-anchor" href="#_6-3-æ¸…ç©ºç›®å½•" aria-label="Permalink to &quot;6.3 æ¸…ç©ºç›®å½•&quot;">â€‹</a></h3><p>ä¸€ä¸ªè„šæœ¬ä¿å­˜å…¶è¾“å‡ºåˆ°ç›®å½• <code>dir</code>ï¼Œé€šå¸¸éœ€è¦åœ¨å¼€å§‹å‰å…ˆ <code>æ¸…ç©ºç›®å½•ï¼ˆclear dirï¼‰</code>ï¼šæ¸…ç©º <code>dir</code> ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œä¸‹é¢å‡½æ•°å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™ä¸€éœ€æ±‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">clearDirectory</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">dirPath</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fileName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readdirSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">dirPath</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">pathName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">dirPath</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fileName</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rmSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">pathName</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">recursive</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¿™é‡Œä½¿ç”¨åˆ°äº†2ä¸ªfså‡½æ•°ï¼š</p><ol><li><code>fs.readdirSync(dirPath)</code> è¿”å› <code>dirPath</code> ç›®å½•ä¸­æ‰€æœ‰å­å…ƒç´ çš„åå­—ã€‚å¯å‚è€ƒä¸Šé¢çš„ <code>4.1</code> èŠ‚</li><li><code>fs.rmSync(pathName, options?)</code> ç§»é™¤æ–‡ä»¶å’Œç›®å½•ï¼ˆåŒ…æ‹¬ç©ºç›®å½•ï¼‰ã€‚å¯å‚è€ƒä¸Šé¢çš„ <code>6.1</code> èŠ‚</li></ol><p>ğŸŒ°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/dir-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// ä¸‹é¢éƒ½æ˜¯&#39;dir&#39;ç›®å½•ä¸­çš„æ–‡ä»¶æˆ–å­ç›®å½•</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/subdir/subdir-file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#82AAFF;">clearDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_6-4-trashåº“" tabindex="-1">6.4 trashåº“ <a class="header-anchor" href="#_6-4-trashåº“" aria-label="Permalink to &quot;6.4 trashåº“&quot;">â€‹</a></h3><p><a href="https://github.com/sindresorhus/trash" target="_blank" rel="noreferrer">trashåº“</a> å°†æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ç§»åˆ°åƒåœ¾æ¡¶ã€‚è·¨å¹³å°ã€‚ä¾‹å­:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> trash </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">trash</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">trash</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*.png</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">!rainbow.png</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">])</span></span>
<span class="line"></span></code></pre></div><p><code>trash()</code> ç¬¬ä¸€ä¸ªå‚æ•°æ¥æ”¶å­—ç¬¦ä¸²æ•°ç»„æˆ–è€…å­—ç¬¦ä¸²ã€‚ä»»ä½•å­—ç¬¦ä¸²éƒ½å¯ä»¥æ˜¯ <code>glob</code> æ¨¡å¼ã€‚</p><h2 id="_7ï¸âƒ£-è¯»å’Œæ”¹å˜æ–‡ä»¶ç³»ç»Ÿæ¡ç›®" tabindex="-1">7ï¸âƒ£ è¯»å’Œæ”¹å˜æ–‡ä»¶ç³»ç»Ÿæ¡ç›® <a class="header-anchor" href="#_7ï¸âƒ£-è¯»å’Œæ”¹å˜æ–‡ä»¶ç³»ç»Ÿæ¡ç›®" aria-label="Permalink to &quot;7ï¸âƒ£ è¯»å’Œæ”¹å˜æ–‡ä»¶ç³»ç»Ÿæ¡ç›®&quot;">â€‹</a></h2><h3 id="_7-1-â­-æ£€æµ‹æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨" tabindex="-1">7.1 â­ æ£€æµ‹æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ <a class="header-anchor" href="#_7-1-â­-æ£€æµ‹æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨" aria-label="Permalink to &quot;7.1 â­ æ£€æµ‹æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨&quot;">â€‹</a></h3><p>ğŸ“’ <a href="https://nodejs.org/api/fs.html#fsexistssyncpath" target="_blank" rel="noreferrer">fs.existsSync(thePath)</a> æ£€æµ‹ <code>thePath</code> è·¯å¾„çš„æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">existsSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// ç›®å½•æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">existsSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">existsSync</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/non-existent-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_7-2-æ£€æµ‹æ–‡ä»¶stats-æ˜¯å¦æ˜¯è·¯å¾„-åˆ›å»ºæ—¶é—´-ç­‰" tabindex="-1">7.2 æ£€æµ‹æ–‡ä»¶statsï¼šæ˜¯å¦æ˜¯è·¯å¾„ï¼Ÿåˆ›å»ºæ—¶é—´ï¼Ÿç­‰ <a class="header-anchor" href="#_7-2-æ£€æµ‹æ–‡ä»¶stats-æ˜¯å¦æ˜¯è·¯å¾„-åˆ›å»ºæ—¶é—´-ç­‰" aria-label="Permalink to &quot;7.2 æ£€æµ‹æ–‡ä»¶statsï¼šæ˜¯å¦æ˜¯è·¯å¾„ï¼Ÿåˆ›å»ºæ—¶é—´ï¼Ÿç­‰&quot;">â€‹</a></h3><p>ğŸ“’ <a href="https://nodejs.org/api/fs.html#fsstatsyncpath-options" target="_blank" rel="noreferrer">fs.statSync(thePath, options?)</a> è¿”å›ä¸€ä¸ª <code>fs.Stats</code> å®ä¾‹ï¼ŒåŒ…å« <code>thePath</code> æ–‡ä»¶æˆ–ç›®å½•ä¿¡æ¯ã€‚</p><p>æœ‰è¶£é…ç½®ï¼š</p><ul><li><code>throwIfNoEntry</code> (é»˜è®¤ï¼š true)ï¼šå¦‚æœç»™å®šè·¯å¾„ä¸å­˜åœ¨å®ä½“ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ <ul><li><code>throwIfNoEntry: true</code> : æŠ›å‡ºå¼‚å¸¸</li><li><code>throwIfNoEntry: false</code>: è¿”å›undefined</li></ul></li><li><code>bigint</code> (é»˜è®¤ï¼š false): å¦‚æœä¸º <code>true</code>ï¼Œå‡½æ•°ä½¿ç”¨bigintsè¡¨ç¤ºæ•°å€¼ç±»å‹å€¼ï¼Œæ¯”å¦‚æ—¶é—´æˆ³ã€‚</li></ul><p><a href="https://nodejs.org/api/fs.html#class-fsstats" target="_blank" rel="noreferrer">fs.Stats</a> å®ä¾‹å±æ€§ï¼š</p><ul><li>ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿæ¡ç›®ï¼Ÿ <ul><li><code>stats.isFile()</code></li><li><code>stats.isDirectory()</code></li><li><code>stats.isSymbolicLink()</code></li></ul></li><li><code>stats.size</code> å­—èŠ‚å°ºå¯¸</li><li>æ—¶é—´æˆ³ï¼ˆ<code>Timestamps</code>ï¼‰: <ul><li>3ç§ç±»å‹æ—¶é—´æˆ³ <ul><li><code>stats.atime</code>: æœ€åè®¿é—®æ—¶é—´</li><li><code>stats.mtime</code>: æœ€åä¿®æ”¹æ—¶é—´</li><li><code>stats.birthtime</code>: åˆ›å»ºæ—¶é—´</li></ul></li><li>æ¯ä¸ªæ—¶é—´æˆ³éƒ½å¯ä»¥æŒ‡å®š3ç§ä¸åŒçš„å•ä½ - ä»¥ <code>atime</code> ä¸ºä¾‹ <ul><li><code>stats.atime</code>: <code>Date</code> å®ä¾‹</li><li><code>stats.atimeMS</code>: ms (POSIX Epochå¼€å§‹)</li><li><code>stats.atimeNs</code>: ns (POSIX Epochå¼€å§‹ï¼Œéœ€è¦å¼€å¯ <code>bigints</code> é…ç½®)</li></ul></li></ul></li></ul><p>ä¸‹é¢ç”¨ <code>fs.statSync()</code> å±æ€§ <code>isDirectory()</code> å‡½æ•°ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">isDirectory</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">thePath</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">stats</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">statSync</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">thePath</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">throwIfNoEntry</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">stats</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">undefined</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">stats</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isDirectoru</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">deepEqual</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">traverseDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">isDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">isDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dir/some-file.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">assert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">equal</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">isDirectory</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">non-existent-dir</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_7-3-æ”¹å˜æ–‡ä»¶ç‰¹æ€§-æƒé™-æ‹¥æœ‰è€…-ç»„-æ—¶é—´æˆ³" tabindex="-1">7.3 æ”¹å˜æ–‡ä»¶ç‰¹æ€§ï¼šæƒé™ï¼Œæ‹¥æœ‰è€…ï¼Œç»„ï¼Œæ—¶é—´æˆ³ <a class="header-anchor" href="#_7-3-æ”¹å˜æ–‡ä»¶ç‰¹æ€§-æƒé™-æ‹¥æœ‰è€…-ç»„-æ—¶é—´æˆ³" aria-label="Permalink to &quot;7.3 æ”¹å˜æ–‡ä»¶ç‰¹æ€§ï¼šæƒé™ï¼Œæ‹¥æœ‰è€…ï¼Œç»„ï¼Œæ—¶é—´æˆ³&quot;">â€‹</a></h3><p>ä¸‹é¢å‡½æ•°ç”¨äºæ”¹å˜æ–‡ä»¶ç‰¹æ€§ï¼š</p><ol><li><a href="https://nodejs.org/api/fs.html#fschmodsyncpath-mode" target="_blank" rel="noreferrer">fs.chmodSync(path, mode)</a> æ”¹å˜æ–‡ä»¶æƒé™ï¼ˆ<code>permission</code>ï¼‰</li><li><a href="https://nodejs.org/api/fs.html#fschownsyncpath-uid-gid" target="_blank" rel="noreferrer">fs.chownSync(path, uid, gid)</a> æ”¹å˜æ–‡ä»¶æ‹¥æœ‰è€…ï¼ˆ<code>owner</code>ï¼‰ å’Œ ç»„ï¼ˆ<code>group</code>ï¼‰</li><li><a href="https://nodejs.org/api/fs.html#fsutimessyncpath-atime-mtime" target="_blank" rel="noreferrer">fs.utimeSync(path, atime, mtime)</a> æ”¹å˜æ–‡ä»¶æ—¶é—´æˆ³ <ul><li><code>atime</code>: æœ€è¿‘ä¸€æ¬¡è®¿é—®æ—¶é—´</li><li><code>mtime</code>: æœ€è¿‘ä¸€æ¬¡ä¿®æ”¹æ—¶é—´</li></ul></li></ol><h2 id="_8ï¸âƒ£-æ“ä½œé“¾æ¥-links" tabindex="-1">8ï¸âƒ£ æ“ä½œé“¾æ¥ï¼ˆLinksï¼‰ <a class="header-anchor" href="#_8ï¸âƒ£-æ“ä½œé“¾æ¥-links" aria-label="Permalink to &quot;8ï¸âƒ£ æ“ä½œé“¾æ¥ï¼ˆLinksï¼‰&quot;">â€‹</a></h2><p>ğŸ‘©â€ğŸ«æ“ä½œç¡¬é“¾æ¥ï¼ˆ<code>hard links</code>ï¼‰çš„å‡½æ•°ï¼š</p><ul><li><a href="https://nodejs.org/api/fs.html#fslinksyncexistingpath-newpath" target="_blank" rel="noreferrer">fs.linkSync(existingPath, newPath)</a> åˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥</li><li><a href="https://nodejs.org/api/fs.html#fsunlinksyncpath" target="_blank" rel="noreferrer">fs.unlinkSync(path)</a> ç§»é™¤ç¡¬é“¾æ¥ï¼Œå¹¶å¯èƒ½æ€§çš„ç§»é™¤ç¡¬é“¾æ¥æŒ‡å‘çš„æ–‡ä»¶ï¼ˆå¦‚æœç§»é™¤çš„æ˜¯æœ€åä¸€ä¸ªæŒ‡å‘è¯¥æ–‡ä»¶çš„ç¡¬é“¾æ¥ï¼‰</li></ul><p>æ“ä½œç¬¦å·é“¾æ¥ï¼ˆ<code>symbolic links</code>ï¼‰ çš„å‡½æ•°ï¼š</p><ul><li><a href="https://nodejs.org/api/fs.html#fssymlinksynctarget-path-type" target="_blank" rel="noreferrer">fs.symlinkSync(target, path, type?)</a> åˆ›å»ºä» <code>path</code> åˆ° <code>target</code> çš„ç¬¦å·é“¾æ¥</li><li><a href="https://nodejs.org/api/fs.html#fsreadlinksyncpath-options" target="_blank" rel="noreferrer">fs.readlinkSync(path, options?)</a> è·å– <code>path</code> å¤„çš„ç›®æ ‡ç¬¦å·é“¾æ¥</li></ul><p>ä¸‹é¢å‡½æ•°ç”¨äºæ“ä½œç¬¦å·é“¾æ¥ï¼Œå¹¶ä¸”ä¸ä¼šè§£é™¤å¯¹ç¬¦å·é“¾æ¥çš„å¼•ç”¨ï¼ˆæ³¨æ„å‰ç¼€ä¸º <code>l</code> ğŸ¤©ï¼‰:</p><ul><li><a href="https://nodejs.org/api/fs.html#fslchmodsyncpath-mode" target="_blank" rel="noreferrer">fs.lchmodSync(path, mode)</a> æ”¹å˜ <code>path</code> è·¯å¾„çš„ç¬¦å·é“¾æ¥çš„æƒé™</li><li><a href="https://nodejs.org/api/fs.html#fslchownsyncpath-uid-gid" target="_blank" rel="noreferrer">fs.lchownSync(path, uid, gid)</a> æ”¹å˜å¯¹åº”è·¯å¾„ç¬¦å·é“¾æ¥çš„ç”¨æˆ·å’Œç»„</li><li><a href="https://nodejs.org/api/fs.html#fslutimessyncpath-atime-mtime" target="_blank" rel="noreferrer">fs.lutimesSync(path, atime, mtime)</a> æ”¹å˜å¯¹åº”è·¯å¾„ç¬¦å·é“¾æ¥çš„æ—¶é—´æˆ³</li><li><a href="https://nodejs.org/api/fs.html#fslstatsyncpath-options" target="_blank" rel="noreferrer">fs.lstatSync(path, options?)</a> è¿”å›å¯¹åº”è·¯å¾„ç¬¦å·é“¾æ¥çš„ç»Ÿè®¡æ•°æ®ï¼ˆæ—¶é—´æˆ³ç­‰ï¼‰</li></ul><p>å…¶å®ƒæœ‰ç”¨å‡½æ•°ï¼š</p><ul><li><a href="https://nodejs.org/api/fs.html#fsrealpathsyncpath-options" target="_blank" rel="noreferrer">fs.realpathSync(path, options?)</a> é€šè¿‡è§£æç‚¹(<code>.</code>)ã€åŒç‚¹(..)å’Œç¬¦å·é“¾æ¥è®¡ç®—è§„èŒƒè·¯å¾„å</li></ul><p>å½±å“ç¬¦å·é“¾æ¥å¤„ç†æ–¹å¼çš„å‡½æ•°ï¼š</p><ul><li><a href="https://nodejs.org/api/fs.html#fscpsyncsrc-dest-options" target="_blank" rel="noreferrer">fs.cpSync(src, dest, options?)</a>: <ul><li><code>dereference</code> (é»˜è®¤ <code>false</code>)ï¼š å¦‚æœä¸º <code>true</code>ï¼Œæ‹·è´ç¬¦å·é“¾æ¥æŒ‡å‘çš„weå¹´ï¼Œè€Œä¸æ˜¯ç¬¦å·é“¾æ¥æœ¬èº«ğŸ˜</li><li><code>verbatimSymlinks</code> (é»˜è®¤ <code>true</code>)ï¼š å¦‚æœä¸º <code>false</code>ï¼Œå¤åˆ¶çš„ç¬¦å·é“¾æ¥çš„ç›®æ ‡å°†è¢«æ›´æ–°ï¼Œä»¥ä¾¿å®ƒä»ç„¶æŒ‡å‘ç›¸åŒçš„ä½ç½®ã€‚å¦‚æœä¸º <code>true</code>ï¼Œåˆ™ä¸ä¼šæ›´æ”¹ç›®æ ‡</li></ul></li></ul><h2 id="_9ï¸âƒ£-è¿›ä¸€æ­¥é˜…è¯»" tabindex="-1">9ï¸âƒ£ è¿›ä¸€æ­¥é˜…è¯» <a class="header-anchor" href="#_9ï¸âƒ£-è¿›ä¸€æ­¥é˜…è¯»" aria-label="Permalink to &quot;9ï¸âƒ£ è¿›ä¸€æ­¥é˜…è¯»&quot;">â€‹</a></h2><ul><li><a href="https://2ality.com/2022/06/web-streams-nodejs.html" target="_blank" rel="noreferrer">Using web streams on Node.js - blog</a></li><li>å…³äºjså¼‚æ­¥ç¼–ç¨‹çš„ <code>JavaScript for impatient programmers</code>ï¼š <ul><li><a href="https://exploringjs.com/impatient-js/ch_async-js.html" target="_blank" rel="noreferrer">Foundations of asynchronous programming in javascript</a></li><li><a href="https://exploringjs.com/impatient-js/ch_promises.html" target="_blank" rel="noreferrer">Promises for asynchrous programming</a></li><li><a href="https://exploringjs.com/impatient-js/ch_async-functions.html" target="_blank" rel="noreferrer">Async functions</a></li><li><a href="https://exploringjs.com/impatient-js/ch_async-iteration.html" target="_blank" rel="noreferrer">Asynchronous iteration</a></li></ul></li></ul><p>åŸæ–‡é“¾æ¥ï¼š</p><ul><li><a href="https://2ality.com/2022/06/nodejs-file-system.html#important-classes" target="_blank" rel="noreferrer">Working with the file system on Node.js - @2ality</a></li></ul><p>2022å¹´08æœˆ14æ—¥15:01:06</p>`,213),e=[o];function t(r,c,y,D,i,F){return n(),a("div",null,e)}const d=s(p,[["render",t]]);export{C as __pageData,d as default};
