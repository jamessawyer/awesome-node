import{_ as s,c as a,o as n,V as l}from"./chunks/framework.478efc10.js";const o="/awesome-node/assets/18-1.4ad11f70.webp",p="/awesome-node/assets/18-2.4d6bfa1f.webp",e="/awesome-node/assets/18-3.562cb9e7.webp",t="/awesome-node/assets/18-4.bb22d4a6.webp",c="/awesome-node/assets/18-5.e68d084d.webp",r="/awesome-node/assets/18-6.d934f981.webp",D="/awesome-node/assets/18-7.6177717f.webp",y="/awesome-node/assets/18-8.2a2ae835.webp",F="/awesome-node/assets/18-9.f20a7327.webp",k=JSON.parse('{"title":"æè‡´åº”ç”¨æ€§èƒ½ä¼˜åŒ–æŠ€å·§","description":"","frontmatter":{"title":"æè‡´åº”ç”¨æ€§èƒ½ä¼˜åŒ–æŠ€å·§"},"headers":[],"relativePath":"book/webpack/18.md","lastUpdated":1681969587000}'),i={name:"book/webpack/18.md"},C=l(`<p>å‰é¢ç« èŠ‚æˆ‘ä»¬å·²ç»è¯¦ç»†æ¢è®¨ Webpack ä¸­å¦‚ä½•ä½¿ç”¨åˆ†åŒ…ã€ä»£ç å‹ç¼©æå‡åº”ç”¨æ‰§è¡Œæ€§èƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸å°‘æ™®é€‚ã€ç»†ç¢çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé™ä½åº”ç”¨ä½“ç§¯ï¼Œæå‡ç½‘ç»œåˆ†å‘æ€§èƒ½ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li>ä½¿ç”¨åŠ¨æ€åŠ è½½ï¼Œå‡å°‘é¦–å±èµ„æºåŠ è½½é‡ï¼›</li><li>ä½¿ç”¨ <code>externals</code>ã€Tree-Shakingã€Scope Hoisting ç‰¹æ€§ï¼Œå‡å°‘åº”ç”¨ä½“ç§¯ï¼›</li><li>æ­£ç¡®ä½¿ç”¨ <code>[hash]</code> å ä½ç¬¦ï¼Œä¼˜åŒ– HTTP èµ„æºç¼“å­˜æ•ˆç‡ï¼›</li><li>ç­‰ç­‰ã€‚</li></ol><p>ä¸‹é¢æˆ‘ä»¬ä¸€ä¸€å±•å¼€ï¼Œè§£é‡Šæ¯æ¡æœ€ä½³å®è·µä»¥åŠèƒŒåçš„é€»è¾‘ã€‚</p><h2 id="åŠ¨æ€åŠ è½½" tabindex="-1">åŠ¨æ€åŠ è½½ <a class="header-anchor" href="#åŠ¨æ€åŠ è½½" aria-label="Permalink to &quot;åŠ¨æ€åŠ è½½&quot;">â€‹</a></h2><p>Webpack é»˜è®¤ä¼šå°†åŒä¸€ä¸ª Entry ä¸‹çš„æ‰€æœ‰æ¨¡å—å…¨éƒ¨æ‰“åŒ…æˆä¸€ä¸ªäº§ç‰©æ–‡ä»¶ â€”â€” åŒ…æ‹¬é‚£äº›ä¸é¡µé¢ <a href="https://web.dev/critical-rendering-path/" target="_blank" rel="noreferrer">å…³é”®æ¸²æŸ“è·¯å¾„</a> æ— å…³çš„ä»£ç ï¼Œè¿™ä¼šå¯¼è‡´é¡µé¢åˆå§‹åŒ–æ—¶éœ€è¦èŠ±è´¹å¤šä½™æ—¶é—´å»ä¸‹è½½è¿™éƒ¨åˆ†æš‚æ—¶ç”¨ä¸ä¸Šçš„ä»£ç ï¼Œå½±å“é¦–å±æ¸²æŸ“æ€§èƒ½ï¼Œä¾‹å¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> someBigMethod </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./someBigMethod</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">someButton</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">click</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">someBigMethod</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>é€»è¾‘ä¸Šï¼Œç›´åˆ°ç‚¹å‡»é¡µé¢çš„ <code>someButton</code> æŒ‰é’®æ—¶æ‰ä¼šè°ƒç”¨ <code>someBigMethod</code> æ–¹æ³•ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä»£ç æ²¡å¿…è¦å‡ºç°åœ¨é¦–å±èµ„æºåˆ—è¡¨ä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Webpack çš„åŠ¨æ€åŠ è½½åŠŸèƒ½å°†è¯¥æ¨¡å—æ›´æ”¹ä¸ºå¼‚æ­¥å¯¼å…¥ï¼Œä¿®æ”¹ä¸Šè¿°ä»£ç ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">someButton</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">click</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">someBitMehtod</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">import</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./someBigMethod</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">someBigMethod</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>æ­¤æ—¶ï¼Œé‡æ–°æ„å»ºå°†äº§ç”Ÿé¢å¤–çš„äº§ç‰©æ–‡ä»¶ <code>src_someBigMethod_js.js</code>ï¼Œè¿™ä¸ªæ–‡ä»¶ç›´åˆ°æ‰§è¡Œ <code>import</code> è¯­å¥æ—¶ â€”â€” ä¹Ÿå°±æ˜¯ä¸Šä¾‹ <code>someButton</code> è¢«ç‚¹å‡»æ—¶æ‰è¢«åŠ è½½åˆ°æµè§ˆå™¨ï¼Œä¹Ÿå°±ä¸ä¼šå½±å“åˆ°å…³é”®æ¸²æŸ“è·¯å¾„äº†ã€‚</p><p>åŠ¨æ€åŠ è½½æ˜¯ Webpack å†…ç½®èƒ½åŠ›ä¹‹ä¸€ï¼Œæˆ‘ä»¬ä¸éœ€è¦åšä»»ä½•é¢å¤–é…ç½®å°±å¯ä»¥é€šè¿‡åŠ¨æ€å¯¼å…¥è¯­å¥(<code>import</code>ã€<code>require.ensure</code>)è½»æ˜“å®ç°ã€‚</p><p>ğŸš¨ä½†è¯·æ³¨æ„ï¼Œè¿™ä¸€ç‰¹æ€§æœ‰æ—¶å€™åè€Œä¼šå¸¦æ¥ä¸€äº›æ–°çš„æ€§èƒ½é—®é¢˜ï¼š</p><ul><li><strong>ä¸€æ˜¯è¿‡åº¦ä½¿ç”¨ä¼šä½¿äº§ç‰©å˜å¾—è¿‡åº¦ç»†ç¢ï¼Œäº§ç‰©æ–‡ä»¶è¿‡å¤šï¼Œè¿è¡Œæ—¶ HTTP é€šè®¯æ¬¡æ•°ä¹Ÿä¼šå˜å¤š</strong>ï¼Œåœ¨ HTTP 1.x ç¯å¢ƒä¸‹è¿™å¯èƒ½åè€Œä¼šé™ä½ç½‘ç»œæ€§èƒ½ï¼Œå¾—ä¸å¿å¤±ï¼›</li><li><strong>äºŒæ˜¯ä½¿ç”¨æ—¶ Webpack éœ€è¦åœ¨å®¢æˆ·ç«¯æ³¨å…¥ä¸€å¤§æ®µç”¨äºæ”¯æŒåŠ¨æ€åŠ è½½ç‰¹æ€§çš„ Runtime</strong>ï¼š</li></ul><p><img src="`+o+`" alt="webpack runtime"></p><p>è¿™æ®µä»£ç å³ä½¿ç»è¿‡å‹ç¼©ä¹Ÿé«˜è¾¾ 2.5KB å·¦å³ï¼Œå¦‚æœåŠ¨æ€å¯¼å…¥çš„ä»£ç é‡å°‘äºè¿™æ®µ Runtime ä»£ç çš„ä½“ç§¯ï¼Œé‚£å°±å®Œå…¨æ˜¯ä¸€ç¬”èµ”æœ¬ä¹°å–äº†ã€‚</p><ul><li>ğŸŒ° <a href="https://github.com/Tecvan-fe/webpack-book-samples/tree/main/perf-lazy-load" target="_blank" rel="noreferrer">perf-lazy-load - @github</a></li></ul><p>å› æ­¤ï¼Œè¯·åŠ¡å¿…æ…é‡ï¼Œå¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬æ²¡å¿…è¦ä¸ºå°æ¨¡å—ä½¿ç”¨åŠ¨æ€åŠ è½½èƒ½åŠ›ï¼<code>ç›®å‰ç¤¾åŒºæ¯”è¾ƒå¸¸è§çš„ç”¨æ³•æ˜¯é…åˆ SPA çš„å‰ç«¯è·¯ç”±èƒ½åŠ›å®ç°é¡µé¢çº§åˆ«çš„åŠ¨æ€åŠ è½½</code>ï¼Œä¾‹å¦‚åœ¨ Vue ä¸­ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createRouter</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createWebHashHistory</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vue-router</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Home </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./Home.vue</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Foo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#676E95;font-style:italic;">/* webpackChunkName: &quot;sub-pages&quot; */</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./Foo.vue</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Bar </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#676E95;font-style:italic;">/* webpackChunkName: &quot;sub-pages&quot; */</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./Bar.vue</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// åŸºç¡€é¡µé¢</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> routes </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/bar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Bar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">component</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Bar </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">component</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Foo </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Home</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">component</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Home </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> router </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createRouter</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">history</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createWebHashHistory</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  routes</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> router</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>ç¤ºä¾‹ä¸­ï¼Œ<code>Home/Foo/Bar</code> ä¸‰ä¸ªç»„ä»¶å‡é€šè¿‡ <code>import()</code> è¯­å¥åŠ¨æ€å¯¼å…¥ï¼Œè¿™ä½¿å¾—ä»…å½“é¡µé¢åˆ‡æ¢åˆ°ç›¸åº”è·¯ç”±æ—¶æ‰ä¼šåŠ è½½å¯¹åº”ç»„ä»¶ä»£ç ã€‚å¦å¤–ï¼Œ<code>Foo</code> ä¸ <code>Bar</code> ç»„ä»¶çš„å¯¼å…¥è¯­å¥æ¯”è¾ƒç‰¹æ®Šï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#676E95;font-style:italic;">/* webpackChunkName: &quot;sub-pages&quot; */</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./Bar.vue</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p><code>webpackChunkName</code> ç”¨äºæŒ‡å®šè¯¥å¼‚æ­¥æ¨¡å—çš„ Chunk åç§°ï¼Œç›¸åŒ Chunk åç§°çš„æ¨¡å—æœ€ç»ˆä¼šæ‰“åŒ…åœ¨ä¸€èµ·ï¼Œè¿™ä¸€ç‰¹æ€§èƒ½å¸®åŠ©å¼€å‘è€…å°†ä¸€äº›å…³è”åº¦è¾ƒé«˜ï¼Œæˆ–æ¯”è¾ƒç»†ç¢çš„æ¨¡å—åˆå¹¶åˆ°åŒä¸€ä¸ªäº§ç‰©æ–‡ä»¶ï¼Œèƒ½å¤Ÿç”¨äºç®¡ç†æœ€ç»ˆäº§ç‰©æ•°é‡ã€‚</p><ul><li>ğŸŒ° <a href="https://github.com/Tecvan-fe/webpack-book-samples/tree/main/perf-vue-lazy-load" target="_blank" rel="noreferrer">perf-vue-lazy-load - @github</a></li></ul><h2 id="httpç¼“å­˜ä¼˜åŒ–" tabindex="-1">HTTPç¼“å­˜ä¼˜åŒ– <a class="header-anchor" href="#httpç¼“å­˜ä¼˜åŒ–" aria-label="Permalink to &quot;HTTPç¼“å­˜ä¼˜åŒ–&quot;">â€‹</a></h2><p>æ³¨æ„ï¼ŒWebpack åªæ˜¯ä¸€ä¸ªå·¥ç¨‹åŒ–æ„å»ºå·¥å…·ï¼Œæ²¡æœ‰èƒ½åŠ›å†³å®šåº”ç”¨æœ€ç»ˆåœ¨ç½‘ç»œåˆ†å‘æ—¶çš„ç¼“å­˜è§„åˆ™ï¼Œä½†æˆ‘ä»¬å¯ä»¥è°ƒæ•´äº§ç‰©æ–‡ä»¶çš„åç§°(é€šè¿‡ Hash)ä¸å†…å®¹(é€šè¿‡ <a href="https://webpack.js.org/guides/code-splitting/" target="_blank" rel="noreferrer">Code Splitting</a>)ï¼Œä½¿å…¶æ›´é€‚é… HTTP æŒä¹…åŒ–ç¼“å­˜ç­–ç•¥ã€‚Code Splitting ç›¸å…³çŸ¥è¯†å·²ç»åœ¨ <a href="https://juejin.cn/book/7115598540721618944/section/7119035452643868672" target="_blank" rel="noreferrer">å‰é¢ç« èŠ‚</a> åšäº†è¯¦å°½ä»‹ç»ï¼Œæœ¬æ–‡æ¥ç€èŠèŠæ–‡ä»¶å Hash è§„åˆ™ã€‚</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Hash æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯æ‘˜è¦çš„å‡½æ•°ï¼Œä¸åŒæ˜æ–‡è®¡ç®—å‡ºçš„æ‘˜è¦å€¼ä¸åŒï¼Œæ‰€ä»¥å¸¸å¸¸è¢«ç”¨ä½œå†…å®¹å”¯ä¸€æ ‡è¯†ã€‚</p></div><p>ğŸ“šWebpack æä¾›äº†ä¸€ç§æ¨¡æ¿å­—ç¬¦ä¸²(<a href="https://webpack.js.org/configuration/output/#template-strings" target="_blank" rel="noreferrer">Template String</a>)èƒ½åŠ›ï¼Œç”¨äºæ ¹æ®æ„å»ºæƒ…å†µåŠ¨æ€æ‹¼æ¥äº§ç‰©æ–‡ä»¶åç§°(<a href="https://webpack.js.org/configuration/output/#outputfilename" target="_blank" rel="noreferrer">output.filename</a>)ï¼Œè§„åˆ™ç¨å¾®æœ‰ç‚¹å¤æ‚ï¼Œä½†ä»æ€§èƒ½è§’åº¦çœ‹ï¼Œæ¯”è¾ƒå€¼å¾—å…³æ³¨çš„æ˜¯å…¶ä¸­çš„å‡ ä¸ª Hash å ä½ç¬¦ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li><code>[fullhash]</code>ï¼šæ•´ä¸ªé¡¹ç›®çš„å†…å®¹ Hash å€¼ï¼Œé¡¹ç›®ä¸­ä»»æ„æ¨¡å—å˜åŒ–éƒ½ä¼šäº§ç”Ÿæ–°çš„ <code>fullhash</code>ï¼›</li><li><code>[chunkhash]</code>ï¼šäº§ç‰©å¯¹åº” Chunk çš„ Hashï¼ŒChunk ä¸­ä»»æ„æ¨¡å—å˜åŒ–éƒ½ä¼šäº§ç”Ÿæ–°çš„ <code>chunkhash</code>ï¼›</li><li><code>[contenthash]</code>ï¼šäº§ç‰©å†…å®¹ Hash å€¼ï¼Œä»…å½“äº§ç‰©å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šäº§ç”Ÿæ–°çš„ <code>contenthash</code>ï¼Œå› æ­¤å®ç”¨æ€§è¾ƒé«˜ã€‚âœ…</li></ol><p>ç”¨æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ <code>output.filename</code> å€¼ä¸­æ’å…¥ç›¸åº”å ä½ç¬¦å³å¯ï¼Œå¦‚ <code>&quot;[name]-[contenthash].js&quot;</code>ã€‚æˆ‘ä»¬æ¥çœ‹ä¸ªå®Œæ•´ä¾‹å­ï¼Œå‡è®¾å¯¹äºä¸‹è¿°æºç ç»“æ„ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-cNC_q" id="tab-NTVjcUQ" checked="checked"><label for="tab-NTVjcUQ">src/index.js</label><input type="radio" name="group-cNC_q" id="tab-1FfziIY"><label for="tab-1FfziIY">src/foo.js</label><input type="radio" name="group-cNC_q" id="tab-z_i4EMK"><label for="tab-z_i4EMK">src/index.css</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./index.css</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">body </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">font</span><span style="color:#89DDFF;">-</span><span style="color:#FFCB6B;">size</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> 14</span><span style="color:#A6ACCD;">px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><p>webpacké…ç½®</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-OSvF1" id="tab-Nh8YiMu" checked="checked"><label for="tab-Nh8YiMu">webpack.config.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> MiniCssExtractPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mini-css-extract-plugin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">type</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#89DDFF;font-style:italic;">{</span><span style="color:#FFCB6B;font-style:italic;">import(&#39;webpack&#39;).Configuration</span><span style="color:#89DDFF;font-style:italic;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">development</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">devtool</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">index</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./src/index.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">foo</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./src/foo.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">output</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">filename</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[name]-[contenthash].js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dist</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">clean</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">module</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">rules</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">\\.</span><span style="color:#C3E88D;">css</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">use</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [MiniCssExtractPlugin</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">loader</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">css-loader</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MiniCssExtractPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">filename</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[name]-[contenthash].css</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><p>ç¤ºä¾‹åŒ…å« <code>index.js</code> ä¸ <code>foo.js</code> ä¸¤ä¸ªå…¥å£ï¼Œä¸”åˆ†åˆ«åœ¨ <code>ouput.filename</code> ä¸ <code>MiniCssExtractPlugin.filename</code> ä¸­ä½¿ç”¨ <code>[contenthash]</code> å ä½ç¬¦ï¼Œæœ€ç»ˆæ„å»ºç»“æœï¼š</p><p><img src="`+p+`" alt="webpackå„ç§hash"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>ä¹Ÿå¯ä»¥é€šè¿‡å ä½ç¬¦ä¼ å…¥ Hash ä½æ•°ï¼Œå¦‚ <code>[contenthash:7]</code> ï¼Œå³å¯é™å®šç”Ÿæˆçš„ Hash é•¿åº¦ã€‚</p></div><p>å¯ä»¥çœ‹åˆ°æ¯ä¸ªäº§ç‰©æ–‡ä»¶åéƒ½ä¼šå¸¦ä¸Šä¸€æ®µç”±äº§ç‰©å†…å®¹è®¡ç®—å‡ºçš„å”¯ä¸€ Hash å€¼ï¼Œæ–‡ä»¶å†…å®¹ä¸å˜ï¼ŒHash ä¹Ÿä¸ä¼šå˜åŒ–ï¼Œè¿™å°±å¾ˆé€‚åˆç”¨ä½œ HTTP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching#expires_or_max-age" target="_blank" rel="noreferrer">æŒä¹…ç¼“å­˜</a> èµ„æºï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># HTTP Response header</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Cache-Control:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">max-age=</span><span style="color:#F78C6C;">31536000</span></span></code></pre></div><p>æ­¤æ—¶ï¼Œäº§ç‰©æ–‡ä»¶ä¸ä¼šè¢«é‡å¤ä¸‹è½½ï¼Œä¸€ç›´åˆ°æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå¼•èµ· Hash å˜åŒ–ç”Ÿæˆä¸åŒ URL è·¯å¾„ä¹‹åï¼Œæ‰éœ€è¦è¯·æ±‚æ–°çš„èµ„æºæ–‡ä»¶ï¼Œèƒ½æœ‰æ•ˆæå‡ç½‘ç»œæ€§èƒ½ï¼Œå› æ­¤ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹åº”å°½é‡ä½¿ç”¨ <code>[contenthash]</code> ç”Ÿæˆæœ‰ç‰ˆæœ¬æ„ä¹‰çš„æ–‡ä»¶åã€‚</p><ul><li>ğŸŒ° <a href="https://github.com/Tecvan-fe/webpack-book-samples/tree/main/perf-hash" target="_blank" rel="noreferrer">perf-hash - @github</a></li></ul><p>ğŸš¨Hash è§„åˆ™å¾ˆå¥½ç”¨ï¼Œä¸è¿‡æœ‰ä¸€ä¸ªè¾¹é™… Case éœ€è¦æ³¨æ„ï¼š<strong>å¼‚æ­¥æ¨¡å—å˜åŒ–ä¼šå¼•èµ·ä¸» Chunk Hash åŒæ­¥å‘ç”Ÿå˜åŒ–</strong>ï¼Œä¾‹å¦‚å¯¹äºä¸‹é¢è¿™ç§æ¨¡å—å…³ç³»ï¼š</p><p><img src="`+e+`" alt="æ¨¡å—å…³ç³»"></p><p><code>src</code> ç›®å½•ä»£ç ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-Fl83Z" id="tab-IeXdhra" checked="checked"><label for="tab-IeXdhra">index.js</label><input type="radio" name="group-Fl83Z" id="tab-yGaCgNZ"><label for="tab-yGaCgNZ">sync-a.js</label><input type="radio" name="group-Fl83Z" id="tab-3fmJ1_k"><label for="tab-3fmJ1_k">sync-b.js</label><input type="radio" name="group-Fl83Z" id="tab-NyASC7D"><label for="tab-NyASC7D">sync-c.js</label><input type="radio" name="group-Fl83Z" id="tab-Nl4c7AG"><label for="tab-Nl4c7AG">async-a.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./sync-a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// åŒæ­¥</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./sync-b</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./async-a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;font-style:italic;">// å¼‚æ­¥</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sync-a</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sync-b</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sync-c</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./sync-c</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">async-a</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div></div></div><p>æ„å»ºåå°†ç”Ÿæˆå…¥å£ <code>index.js</code> ä¸å¼‚æ­¥æ¨¡å— <code>async-a.js</code> ä¸¤ä¸ª Chunk å¯¹åº”çš„äº§ç‰©ï¼š</p><p><img src="`+t+`" alt="async chunks"></p><p>æ­¤æ—¶ï¼Œè‹¥å¼‚æ­¥æ¨¡å— <code>async-a</code> æˆ–å…¶å­æ¨¡å— <code>sync-c</code> å‘ç”Ÿå˜åŒ–</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-diff"><code><span class="line diff remove"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sync-c</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line diff add"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sync-c-diff</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span></span></code></pre></div><p>ç†è®ºä¸Šåº”è¯¥åªä¼šå½±å“ <code>src_async-a</code> çš„ Hash å€¼ï¼Œä½†å®é™…æ•ˆæœå´æ˜¯ï¼š</p><p><img src="`+c+'" alt="async chunkså˜æ›´çš„å½±å“"></p><p>çˆ¶çº§ Chunk(<code>index</code>)ä¹Ÿå—åˆ°äº†å½±å“ï¼Œç”Ÿæˆæ–°çš„ Hash å€¼ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ <code>index</code> ä¸­éœ€è¦è®°å½•å¼‚æ­¥ Chunk çš„çœŸå®è·¯å¾„ï¼š</p><p><img src="'+r+`" alt="async chunkså˜æ›´çš„å½±å“"></p><p>ğŸš€å¼‚æ­¥ Chunk çš„è·¯å¾„å˜åŒ–è‡ªç„¶ä¹Ÿå°±å¯¼è‡´äº†çˆ¶çº§ Chunk å†…å®¹å˜åŒ–ï¼Œæ­¤æ—¶å¯ä»¥ç”¨ <code>optimization.runtimeChunk</code> å°†è¿™éƒ¨åˆ†ä»£ç æŠ½å–ä¸ºå•ç‹¬çš„ Runtime Chunkï¼Œä¾‹å¦‚ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-BAEJ7" id="tab-l7Q8U5j" checked="checked"><label for="tab-l7Q8U5j">webpack.config.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-diff"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">index</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">development</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">devtool</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">output</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">filename</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">[name]-[contenthash].js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dist</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å°†è¿è¡Œæ—¶ä»£ç æŠ½å–åˆ° \`runtime\` æ–‡ä»¶ä¸­</span></span>
<span class="line diff add"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">runtimeChunk</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">runtime</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div></div></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>åç»­ç« èŠ‚ä¸­æˆ‘ä»¬ä¼šä¸“é—¨è®²è§£ Initial Chunkã€Async Chunkã€Runtime Chunk ä¸‰ç§æ¦‚å¿µã€‚</p></div><p>ä¹‹åï¼Œ<code>async-a.js</code> æ¨¡å—çš„å˜æ›´åªä¼šå½±å“ Runtime Chunk å†…å®¹ï¼Œä¸å†å½±å“ä¸» Chunkã€‚</p><p><img src="`+D+`" alt="runtime"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>ç»¼ä¸Šï¼Œå»ºè®®è‡³å°‘ä¸ºç”Ÿæˆç¯å¢ƒå¯åŠ¨ <code>[contenthash]</code> åŠŸèƒ½ï¼Œå¹¶æ­é… <code>optimization.runtimeChunk</code> å°†è¿è¡Œæ—¶ä»£ç æŠ½ç¦»ä¸ºå•ç‹¬äº§ç‰©æ–‡ä»¶ã€‚</p></div><h2 id="ä½¿ç”¨å¤–ç½®ä¾èµ–" tabindex="-1">ä½¿ç”¨å¤–ç½®ä¾èµ– <a class="header-anchor" href="#ä½¿ç”¨å¤–ç½®ä¾èµ–" aria-label="Permalink to &quot;ä½¿ç”¨å¤–ç½®ä¾èµ–&quot;">â€‹</a></h2><p>è®¾æƒ³ä¸€ä¸ªåœºæ™¯ï¼Œå‡å¦‚æˆ‘ä»¬æ‰‹å¤´ä¸Šæœ‰ 10 ä¸ªç”¨ React æ„å»ºçš„ SPA åº”ç”¨ï¼Œè¿™ 10 ä¸ªåº”ç”¨éƒ½éœ€è¦å„è‡ªå®‰è£…ã€æ‰“åŒ…ã€éƒ¨ç½²ã€åˆ†å‘åŒä¸€å¥—ç›¸ä¼¼çš„ React åŸºç¡€ä¾èµ–ï¼Œæœ€ç»ˆç”¨æˆ·åœ¨è®¿é—®è¿™äº›åº”ç”¨æ—¶ä¹Ÿéœ€è¦é‡å¤åŠ è½½ç›¸åŒåŸºç¡€åŒ…ä»£ç ï¼Œé‚£æœ‰æ²¡æœ‰åŠæ³•èŠ‚çœè¿™éƒ¨åˆ†æµé‡å‘¢ï¼Ÿæœ‰ â€”â€” ä½¿ç”¨ Webpack çš„ <code>externals</code> ç‰¹æ€§ã€‚</p><p><code>externals</code> çš„ä¸»è¦ä½œç”¨æ˜¯å°†éƒ¨åˆ†æ¨¡å—æ’é™¤åœ¨ Webpack æ‰“åŒ…ç³»ç»Ÿä¹‹å¤–ï¼Œä¾‹å¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">externals</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">lodash</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">_</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><p>ä½¿ç”¨ä¸Šè¿°é…ç½®åï¼ŒWebpack ä¼š <strong>é¢„è®¾</strong> è¿è¡Œç¯å¢ƒä¸­å·²ç»å†…ç½® Lodash åº“ â€”â€” æ— è®ºæ˜¯é€šè¿‡ CDN è¿˜æ˜¯å…¶å®ƒæ–¹å¼æ³¨å…¥ï¼Œæ‰€ä»¥ä¸éœ€è¦å†å°†è¿™äº›æ¨¡å—æ‰“åŒ…åˆ°äº§ç‰©ä¸­ï¼š</p><p><img src="`+y+`" alt="ä½¿ç”¨å’Œä¸ä½¿ç”¨externalå¯¹æ¯”"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>externals</code> ä¸ä»…é€‚ç”¨äºä¼˜åŒ–äº§ç‰©æ€§èƒ½ï¼Œåœ¨ç‰¹å®šç¯å¢ƒä¸‹è¿˜èƒ½ç”¨äºè·³è¿‡è‹¥å¹²è¿è¡Œæ—¶æ¨¡å—ï¼Œä¾‹å¦‚ Node ä¸­çš„ <code>fs/net</code> ç­‰ï¼Œé¿å…å°†è¿™éƒ¨åˆ†æºç é”™è¯¯æ‰“åŒ…è¿› Bundleï¼Œè¯¦æƒ…å¯å‚è€ƒ <a href="https://www.npmjs.com/package/webpack-node-externals" target="_blank" rel="noreferrer">webpack-node-externals</a> å·¥å…·ã€‚</p></div><p>ğŸš€æ³¨æ„ï¼Œä½¿ç”¨ <code>externals</code> æ—¶å¿…é¡»ç¡®ä¿è¿™äº›å¤–ç½®ä¾èµ–ä»£ç å·²ç»è¢«æ­£ç¡®æ³¨å…¥åˆ°ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œè¿™åœ¨ Web åº”ç”¨ä¸­é€šå¸¸å¯ä»¥é€šè¿‡ CDN æ–¹å¼å®ç°ï¼Œä¾‹å¦‚ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-SkuRp" id="tab-qXMJOMq" checked="checked"><label for="tab-qXMJOMq">webpack.config.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HtmlWebpackPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">html-webpack-plugin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">type</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#89DDFF;font-style:italic;">{</span><span style="color:#FFCB6B;font-style:italic;">import(&#39;webpack&#39;).Configuration</span><span style="color:#89DDFF;font-style:italic;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">development</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">devtool</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">index</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./src/index.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">output</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">filename</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[name]-[contenthash].js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dist2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">clean</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">externals</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">react</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">React</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">lodash</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">_</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">HtmlWebpackPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">templateContent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;!DOCTYPE html&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;html lang=&quot;en&quot;&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;head&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;title&gt;External demo&lt;/title&gt;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">        &lt;script defer crossorigin src=&quot;https://www.unpkg.com/react@18.2.0/umd/react.production.min.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line highlighted"><span style="color:#C3E88D;">        &lt;script defer crossorigin src=&quot;https://unpkg.com/browse/lodash@4.17.21/lodash.min.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;/head&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;body&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">        &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;/body&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;/html&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><p>ç¤ºä¾‹ä¸­ï¼Œ<code>externals</code> å£°æ˜äº† <code>react</code> ä¸ <code>lodash</code> ä¸¤ä¸ªå¤–ç½®ä¾èµ–ï¼Œå¹¶åœ¨åç»­çš„ <code>html-webpack-plugin</code> æ¨¡æ¿ä¸­æ³¨å…¥è¿™ä¸¤ä¸ªæ¨¡å—çš„ CDN å¼•ç”¨ï¼Œä»¥æ­¤æ„æˆå®Œæ•´ Web åº”ç”¨ã€‚</p><p>è™½ç„¶ç»“æœä¸Šçœ‹æµè§ˆå™¨è¿˜æ˜¯å¾—æ¶ˆè€—è¿™éƒ¨åˆ†æµé‡ï¼Œä½†ç»“åˆ CDN ç³»ç»Ÿç‰¹æ€§:</p><ol><li>ä¸€æ˜¯èƒ½å¤Ÿå°±è¿‘è·å–èµ„æºï¼Œç¼©çŸ­ç½‘ç»œé€šè®¯é“¾è·¯ï¼›</li><li>äºŒæ˜¯èƒ½å¤Ÿå°†èµ„æºåˆ†å‘ä»»åŠ¡å‰ç½®åˆ°èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œå‡è½»åŸæœåŠ¡å™¨ QPS è´Ÿæ‹…ï¼›</li><li>ä¸‰æ˜¯ç”¨æˆ·è®¿é—®ä¸åŒç«™ç‚¹èƒ½å…±äº«åŒä¸€ä»½ CDN èµ„æºå‰¯æœ¬ã€‚æ‰€ä»¥ç½‘ç»œæ€§èƒ½æ•ˆæœå¾€å¾€ä¼šæ¯”é‡å¤æ‰“åŒ…å¥½å¾ˆå¤šã€‚</li></ol><h2 id="ä½¿ç”¨tree-shakingåˆ é™¤å¤šä½™æ¨¡å—å¯¼å‡º" tabindex="-1">ä½¿ç”¨Tree-Shakingåˆ é™¤å¤šä½™æ¨¡å—å¯¼å‡º <a class="header-anchor" href="#ä½¿ç”¨tree-shakingåˆ é™¤å¤šä½™æ¨¡å—å¯¼å‡º" aria-label="Permalink to &quot;ä½¿ç”¨Tree-Shakingåˆ é™¤å¤šä½™æ¨¡å—å¯¼å‡º&quot;">â€‹</a></h2><p>Tree-Shaking è¾ƒæ—©å‰ç”± <a href="https://github.com/Rich-Harris" target="_blank" rel="noreferrer">Rich Harris</a> åœ¨ Rollup ä¸­ç‡å…ˆå®ç°ï¼ŒWebpack è‡ª 2.0 ç‰ˆæœ¬å¼€å§‹æ¥å…¥ï¼Œæ˜¯ä¸€ç§åŸºäº ES Module è§„èŒƒçš„ Dead Code Elimination æŠ€æœ¯ï¼Œå®ƒä¼šåœ¨è¿è¡Œè¿‡ç¨‹ä¸­é™æ€åˆ†ææ¨¡å—ä¹‹é—´çš„å¯¼å…¥å¯¼å‡ºï¼Œåˆ¤æ–­å“ªäº›æ¨¡å—å¯¼å‡ºå€¼æ²¡æœ‰è¢«å…¶å®ƒæ¨¡å—ä½¿ç”¨ â€”â€” ç›¸å½“äºæ¨¡å—å±‚é¢çš„ Dead Codeï¼Œå¹¶å°†å…¶åˆ é™¤ã€‚</p><p>åœ¨ Webpack ä¸­ï¼Œå¯åŠ¨ Tree Shaking åŠŸèƒ½å¿…é¡»åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ol><li>é…ç½® <code>optimization.usedExports</code> ä¸º <code>true</code>ï¼Œæ ‡è®°æ¨¡å—å¯¼å…¥å¯¼å‡ºåˆ—è¡¨ï¼›</li><li>å¯åŠ¨ä»£ç ä¼˜åŒ–åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å®ç°ï¼š <ol><li>é…ç½® <code>mode = production</code></li><li>é…ç½® <code>optimization.minimize = true</code></li><li>æä¾› <code>optimization.minimizer</code> æ•°ç»„</li></ol></li></ol><p>ä¾‹å¦‚ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-uYWH0" id="tab-nvwBvsc" checked="checked"><label for="tab-nvwBvsc">webpack.config.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">usedExports</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><p>ä¹‹åï¼ŒWebpack ä¼šå¯¹æ‰€æœ‰ä½¿ç”¨ ESM æ–¹æ¡ˆçš„æ¨¡å—å¯åŠ¨ Tree-Shakingï¼Œä¾‹å¦‚å¯¹äºä¸‹é¢çš„ä»£ç ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-JlCZI" id="tab-UZIj9MJ" checked="checked"><label for="tab-UZIj9MJ">index.js</label><input type="radio" name="group-JlCZI" id="tab-VdB9Kpv"><label for="tab-VdB9Kpv">bar.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">bar</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./bar</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(bar)</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> bar </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">bar</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> foo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span></code></pre></div></div></div><p><code>bar.js</code> æ¨¡å—å¯¼å‡ºäº† <code>bar</code> ã€<code>foo</code> ï¼Œä½†åªæœ‰ <code>bar</code> å€¼è¢« <code>index</code> æ¨¡å—ä½¿ç”¨ï¼Œç»è¿‡ Tree Shaking å¤„ç†åï¼Œ<code>foo</code> å˜é‡ä¼šè¢«è§†ä½œæ— ç”¨ä»£ç åˆ é™¤ï¼Œæœ€ç»ˆæœ‰æ•ˆçš„ä»£ç ç»“æ„ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-uPhPI" id="tab-tWoTijG" checked="checked"><label for="tab-tWoTijG">bar.js</label><input type="radio" name="group-uPhPI" id="tab-ruwDike"><label for="tab-ruwDike">index.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-diff"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> bar </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">bar</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line diff remove"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> foo </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">bar</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./bar</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(bar)</span></span></code></pre></div></div></div><p>åœ¨åé¢ç« èŠ‚ä¸­æˆ‘ä»¬ä¼šå±•å¼€è®²è§£ Tree-Shaking çš„å®ç°ç»†èŠ‚åŠæ³¨æ„äº‹é¡¹ï¼Œæ­¤å¤„å…ˆç•¥è¿‡ã€‚</p><h2 id="ä½¿ç”¨scope-hoistingåˆå¹¶æ¨¡å—" tabindex="-1">ä½¿ç”¨Scope Hoistingåˆå¹¶æ¨¡å— <a class="header-anchor" href="#ä½¿ç”¨scope-hoistingåˆå¹¶æ¨¡å—" aria-label="Permalink to &quot;ä½¿ç”¨Scope Hoistingåˆå¹¶æ¨¡å—&quot;">â€‹</a></h2><p>é»˜è®¤æƒ…å†µä¸‹ Webpack ä¼šå°†æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// common.js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">common</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// index.js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> common </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./common</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(common)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>ç»è¿‡ Webpack æ‰“åŒ…åä¼šç”Ÿæˆï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/common.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  (</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">__unused_webpack_module</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">__webpack_exports__</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">__webpack_require__</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">__WEBPACK_DEFAULT_EXPORT__</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">common</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">__webpack_require__</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">d</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">__webpack_exports__</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#676E95;font-style:italic;">/* harmony export */</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">default</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">__WEBPACK_DEFAULT_EXPORT__</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#676E95;font-style:italic;">/* harmony export */</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  (</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">__unused_webpack_module</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">__webpack_exports__</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">__webpack_require__</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">_common__WEBPACK_IMPORTED_MODULE_0__</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">__webpack_require__</span><span style="color:#F07178;">( </span><span style="color:#676E95;font-style:italic;">/*! ./common */</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/common.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">_common__WEBPACK_IMPORTED_MODULE_0__</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>è¿™ç§å¤„ç†æ–¹å¼éœ€è¦å°†æ¯ä¸€ä¸ªæ¨¡å—éƒ½åŒ…è£¹è¿›ä¸€æ®µç›¸ä¼¼çš„å‡½æ•°æ¨¡æ¿ä»£ç ä¸­ï¼Œå¥½çœ‹æ˜¯å¥½çœ‹ï¼Œä½†æµªè´¹ç½‘ç»œæµé‡å•Šã€‚ä¸ºæ­¤ï¼ŒWebpack æä¾›äº† <code>Scope Hoisting</code> åŠŸèƒ½ï¼Œç”¨äº <strong>å°†ç¬¦åˆæ¡ä»¶çš„å¤šä¸ªæ¨¡å—åˆå¹¶åˆ°åŒä¸€ä¸ªå‡½æ•°ç©ºé—´</strong> ä¸­ï¼Œä»è€Œå‡å°‘äº§ç‰©ä½“ç§¯ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚ä¾‹å¦‚ä¸Šè¿°ç¤ºä¾‹ç»è¿‡ Scope Hoisting ä¼˜åŒ–åï¼Œç”Ÿæˆä»£ç ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">__unused_webpack_module</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">__webpack_exports__</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">__webpack_require__</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;">// CONCATENATED MODULE: ./src/common.js</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#676E95;font-style:italic;">/* harmony default export */</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">common</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">common</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;">// CONCATENATED MODULE: ./src/index.js</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">common</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>Webpack æä¾›äº†ä¸‰ç§å¼€å¯ Scope Hoisting çš„æ–¹æ³•ï¼š</p><ol><li>ä½¿ç”¨ <code>mode = &#39;production&#39;</code> å¼€å¯ç”Ÿäº§æ¨¡å¼ï¼›</li><li>ä½¿ç”¨ <code>optimization.concatenateModules</code> é…ç½®é¡¹ï¼›</li><li>ç›´æ¥ä½¿ç”¨ <code>ModuleConcatenationPlugin</code> æ’ä»¶ã€‚</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ModuleConcatenationPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">webpack/lib/optimize/ModuleConcatenationPlugin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 1ï¸âƒ£ æ–¹æ³•1ï¼š å°† \`mode\` è®¾ç½®ä¸º productionï¼Œå³å¯å¼€å¯</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">production</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 2ï¸âƒ£ æ–¹æ³•2ï¼š å°† \`optimization.concatenateModules\` è®¾ç½®ä¸º true</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">optimization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">concatenateModules</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">usedExports</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">providedExports</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 3ï¸âƒ£ æ–¹æ³•3ï¼š ç›´æ¥ä½¿ç”¨ \`ModuleConcatenationPlugin\` æ’ä»¶</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ModuleConcatenationPlugin</span><span style="color:#A6ACCD;">()]</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><p>ä¸‰ç§æ–¹æ³•æœ€ç»ˆéƒ½ä¼šè°ƒç”¨ <code>ModuleConcatenationPlugin</code> å®Œæˆæ¨¡å—åˆ†æä¸åˆå¹¶æ“ä½œã€‚</p><p>ä¸ Tree-Shaking ç±»ä¼¼ï¼ŒScope Hoisting åº•å±‚åŸºäº ES Module æ–¹æ¡ˆçš„ <a href="https://stackoverflow.com/questions/52965907/what-is-the-meaning-of-static-import-in-es6" target="_blank" rel="noreferrer">é™æ€ç‰¹æ€§</a>ï¼Œæ¨æ–­æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¹¶è¿›ä¸€æ­¥åˆ¤æ–­æ¨¡å—ä¸æ¨¡å—èƒ½å¦åˆå¹¶ï¼Œå› æ­¤åœ¨ä»¥ä¸‹åœºæ™¯ä¸‹ä¼šå¤±æ•ˆï¼š</p><blockquote><p>1ï¸âƒ£ <strong>é ESM æ¨¡å—</strong></p></blockquote><p>é‡åˆ° AMDã€CMD ä¸€ç±»æ¨¡å—æ—¶ï¼Œç”±äºå¯¼å…¥å¯¼å‡ºå†…å®¹çš„åŠ¨æ€æ€§ï¼ŒWebpack æ— æ³•ç¡®ä¿æ¨¡å—åˆå¹¶åä¸ä¼šäº§ç”Ÿæ„æ–™ä¹‹å¤–çš„å‰¯ä½œç”¨ï¼Œå› æ­¤ä¼šå…³é—­ Scope Hoisting åŠŸèƒ½ã€‚è¿™ä¸€é—®é¢˜åœ¨å¯¼å…¥ NPM åŒ…å°¤å…¶å¸¸è§ï¼Œè®¸å¤šæ¡†æ¶éƒ½ä¼šè‡ªè¡Œæ‰“åŒ…åå†ä¸Šä¼ åˆ° NPMï¼Œå¹¶ä¸”é»˜è®¤å¯¼å‡ºçš„æ˜¯å…¼å®¹æ€§æ›´ä½³çš„ CommonJS åŒ…ï¼Œå› è€Œæ— æ³•ä½¿ç”¨ Scope Hoisting åŠŸèƒ½ï¼Œæ­¤æ—¶å¯é€šè¿‡ <code>mainFileds</code> å±æ€§å°è¯•å¼•å…¥æ¡†æ¶çš„ ESM ç‰ˆæœ¬ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">resolve</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä¼˜å…ˆä½¿ç”¨ jsnext:main ä¸­æŒ‡å‘çš„ ES6 æ¨¡å—åŒ–è¯­æ³•çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">mainFields</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">jsnext:main</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">browser</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">main</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><blockquote><p>2ï¸âƒ£ <strong>æ¨¡å—è¢«å¤šä¸ª Chunk å¼•ç”¨</strong></p></blockquote><p>å¦‚æœä¸€ä¸ªæ¨¡å—è¢«å¤šä¸ª Chunk åŒæ—¶å¼•ç”¨ï¼Œä¸ºé¿å…é‡å¤æ‰“åŒ…ï¼ŒScope Hoisting åŒæ ·ä¼šå¤±æ•ˆï¼Œä¾‹å¦‚ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// common.js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">common</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// async.js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> common </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./common</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// index.js </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> common </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./common</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./async</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>ç¤ºä¾‹ä¸­ï¼Œå…¥å£ <code>index.js</code> ä¸å¼‚æ­¥æ¨¡å— <code>async.js</code> åŒæ—¶ä¾èµ– <code>common.js</code> æ–‡ä»¶ï¼Œ<code>common.js</code> æ— æ³•è¢«åˆå¹¶å…¥ä»»ä¸€ Chunkï¼Œè€Œæ˜¯ä½œä¸ºç”Ÿæˆä¸ºå•ç‹¬çš„ä½œç”¨åŸŸï¼Œæœ€ç»ˆæ‰“åŒ…ç»“æœï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/common.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  (</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">__WEBPACK_DEFAULT_EXPORT__</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">common</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  (</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">_common__WEBPACK_IMPORTED_MODULE_0__</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">__webpack_require__</span><span style="color:#F07178;">( </span><span style="color:#676E95;font-style:italic;">/*! ./common */</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/common.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">__webpack_require__</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">e</span><span style="color:#F07178;">( </span><span style="color:#676E95;font-style:italic;">/*! import() */</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">src_async_js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">__webpack_require__</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">bind</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">__webpack_require__</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">/*! ./async */</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/async.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span></code></pre></div><h2 id="ç›‘æ§äº§ç‰©ä½“ç§¯" tabindex="-1">ç›‘æ§äº§ç‰©ä½“ç§¯ <a class="header-anchor" href="#ç›‘æ§äº§ç‰©ä½“ç§¯" aria-label="Permalink to &quot;ç›‘æ§äº§ç‰©ä½“ç§¯&quot;">â€‹</a></h2><p>ç»¼åˆæœ€è¿‘å‡ ç« è®¨è®ºçš„ Code Splittingã€å‹ç¼©ã€ç¼“å­˜ä¼˜åŒ–ã€Tree-Shaking ç­‰æŠ€æœ¯ï¼Œä¸éš¾çœ‹å‡ºæ‰€è°“çš„åº”ç”¨æ€§èƒ½ä¼˜åŒ–å‡ ä¹éƒ½ä¸ç½‘ç»œæœ‰å…³ï¼Œè¿™æ˜¯å› ä¸ºç°ä»£è®¡ç®—æœºç½‘ç»œç¯å¢ƒéå¸¸å¤æ‚ã€ä¸ç¨³å®šï¼Œè™½ç„¶æœ‰å ªæ¯”æœ¬åœ°ç£ç›˜ååé€Ÿåº¦çš„ 5G ç½‘ç»œï¼Œä½†ä¹Ÿè¿˜å­˜åœ¨å¤§é‡ä½é€Ÿ 2Gã€3G ç½‘ç»œç”¨æˆ·ï¼Œæ•´ä½“è€Œè¨€é€šè¿‡ç½‘ç»œå®ç°å¼‚åœ°æ•°æ®äº¤æ¢ä¾ç„¶æ˜¯ä¸€ç§ç›¸å¯¹ä½æ•ˆçš„ IO æ‰‹æ®µï¼Œæœ‰å¯èƒ½æˆä¸º Web åº”ç”¨æ‰§è¡Œé“¾æ¡ä¸­æœ€å¤§çš„æ€§èƒ½ç“¶é¢ˆã€‚</p><p>å› æ­¤ï¼Œç«™åœ¨ç”Ÿäº§è€…è§’åº¦æˆ‘ä»¬æœ‰å¿…è¦å°½å¯èƒ½ä¼˜åŒ–ä»£ç åœ¨ç½‘ç»œä¸Šåˆ†å‘çš„æ•ˆç‡ï¼Œç”¨å°½å¯èƒ½å°‘çš„ç½‘ç»œæµé‡äº¤ä»˜åº”ç”¨åŠŸèƒ½ã€‚æ‰€å¹¸ Webpack ä¸“é—¨ä¸ºæ­¤æä¾›äº†ä¸€å¥— <a href="https://github.com/webpack/webpack/issues/3216" target="_blank" rel="noreferrer">æ€§èƒ½ç›‘æ§æ–¹æ¡ˆ</a>ï¼Œå½“æ„å»ºç”Ÿæˆçš„äº§ç‰©ä½“ç§¯è¶…è¿‡é˜ˆå€¼æ—¶æŠ›å‡ºå¼‚å¸¸è­¦å‘Šï¼Œä»¥æ­¤å¸®åŠ©æˆ‘ä»¬æ—¶åˆ»å…³æ³¨èµ„æºä½“ç§¯ï¼Œé¿å…å› é¡¹ç›®è¿­ä»£å¢é•¿å¸¦æ¥è¿‡å¤§çš„ç½‘ç»œä¼ è¾“ï¼Œç”¨æ³•ï¼š</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-C1R_u" id="tab-AUlRDeR" checked="checked"><label for="tab-AUlRDeR">webpack.config.js</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">performance</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è®¾ç½®æ‰€æœ‰äº§ç‰©ä½“ç§¯é˜ˆå€¼</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">maxAssetSize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">172</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è®¾ç½® entry äº§ç‰©ä½“ç§¯é˜ˆå€¼</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">maxEntrypointSize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">244</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æŠ¥é”™æ–¹å¼ï¼Œæ”¯æŒ \`error\` | \`warning\` | false</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">hints</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è¿‡æ»¤éœ€è¦ç›‘æ§çš„æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">assetFilter</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">assetFilename</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">assetFilename</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">endsWith</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></div></div><p>ğŸŒ° <a href="https://github1s.com/Tecvan-fe/webpack-book-samples/blob/main/perf-budget/webpack.config.js" target="_blank" rel="noreferrer">perf-budget - @github</a></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight has-focused-lines"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node:path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HtmlWebpackPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">html-webpack-plugin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">type</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#89DDFF;font-style:italic;">{</span><span style="color:#FFCB6B;font-style:italic;">import(&#39;webpack&#39;).Configuration</span><span style="color:#89DDFF;font-style:italic;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">development</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">devtool</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">index</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./src/index.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">output</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">filename</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[name]-[contenthash].js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dist</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">clean</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line has-focus"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">performance</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span></span>
<span class="line has-focus"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">maxAssetSize</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">172</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line has-focus"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">hints</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">error</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line has-focus"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ä»£ç ï¼š</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// ./src/index.js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> _ </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lodash</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(_</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>è‹¥æ­¤æ—¶äº§ç‰©ä½“ç§¯è¶…è¿‡ <code>172KB</code>ï¼Œåˆ™æŠ¥é”™ï¼š</p><p><img src="`+F+'" alt="performance hints"></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>è¿™é‡Œçš„æŠ¥é”™ä¸ä¼šé˜»æ–­æ„å»ºåŠŸèƒ½ï¼Œ ä¾ç„¶èƒ½æ­£å¸¸æ‰“åŒ…å‡ºåº”ç”¨äº§ç‰©ã€‚</p></div><p>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥è®¾ç½®å¤šå¤§çš„é˜ˆå€¼å‘¢ï¼Ÿè¿™å–å†³äºé¡¹ç›®å…·ä½“åœºæ™¯ï¼Œä¸è¿‡ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„ <a href="https://web.dev/your-first-performance-budget/#budget-for-quantity-based-metrics" target="_blank" rel="noreferrer">ç»éªŒæ³•åˆ™</a> æ˜¯ç¡®ä¿ <a href="https://web.dev/critical-rendering-path/" target="_blank" rel="noreferrer">å…³é”®è·¯å¾„</a> èµ„æºä½“ç§¯å§‹ç»ˆå°äº <code>170KB</code>ï¼Œè¶…è¿‡è¿™ä¸ªä½“ç§¯å°±åº”è¯¥ä½¿ç”¨ä¸Šé¢ä»‹ç»çš„è‹¥å¹²æ–¹æ³•åšå¥½è£å‰ªä¼˜åŒ–ã€‚</p><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><p>å‹ç¼©ã€Tree-Shakingã€Scope Hoisting éƒ½åœ¨å‡å°‘äº§ç‰©ä½“ç§¯ï¼›Code Splittingã€å¤–ç½®ä¾èµ–ã€<code>[hash]</code> åˆ™æœ‰åŠ©äºæå‡ HTTP ç¼“å­˜æ•ˆç‡ï¼›åŠ¨æ€åŠ è½½åˆ™èƒ½å¤Ÿç¡®ä¿å…³é”®è·¯å¾„æœ€å°èµ„æºä¾èµ–ã€‚ç§ç§æªæ–½å„è‡ªä»ä¸åŒè§’åº¦åŠªåŠ›ä¼˜åŒ–åº”ç”¨ä»£ç åœ¨ç½‘ç»œä¸Šçš„åˆ†å‘æ•ˆç‡ï¼Œæ¯•ç«Ÿç½‘ç»œé€šè®¯æœ‰æ—¶å€™çœŸçš„å¾ˆè´µï¼</p><p>ä¸è¿‡è½¯ä»¶ä¸–ç•Œæ²¡æœ‰é“¶å¼¹ï¼Œè¿‡åº¦çš„ä¼˜åŒ–æœ‰æ—¶å€™å¯èƒ½å¸¦æ¥åæ•ˆæœï¼Œå»ºè®®å¤§å®¶å‚è€ƒ <a href="https://web.dev/vitals/" target="_blank" rel="noreferrer">Web Vitals</a> æ¨¡å‹ï¼Œå§‹ç»ˆå…³æ³¨ã€å¯¹æ¯”åº”ç”¨çš„çº¿ä¸Šè¡¨ç°ï¼Œç¡®ä¿æœ€ä½³ç”¨æˆ·ä½“éªŒã€‚</p><h2 id="æ€è€ƒé¢˜" tabindex="-1">æ€è€ƒé¢˜ <a class="header-anchor" href="#æ€è€ƒé¢˜" aria-label="Permalink to &quot;æ€è€ƒé¢˜&quot;">â€‹</a></h2><p>ä¸ºä½• Tree-Shaking å¼ºä¾èµ–äº ESM æ¨¡å—æ–¹æ¡ˆï¼ŸESM ä¸å…¶å®ƒæ–¹æ¡ˆå¦‚ AMDã€CMD ç­‰ï¼Œæœ‰ä½•åŒºåˆ«ï¼Ÿ</p><details class="details custom-block"><summary>chatgptå›ç­”</summary><blockquote><p>1ï¸âƒ£ ä¸ºä½• Tree-Shaking å¼ºä¾èµ–äº ESM æ¨¡å—æ–¹æ¡ˆï¼Ÿ</p></blockquote><p>JavaScript Tree-Shaking æ˜¯æŒ‡é€šè¿‡<strong>é™æ€åˆ†æ</strong>ï¼Œå»é™¤æœªè¢«ä½¿ç”¨çš„ä»£ç ï¼ˆé€šå¸¸æ˜¯å‡½æ•°æˆ–å˜é‡ï¼‰ï¼Œä»¥å‡å°‘ç”Ÿæˆçš„JavaScriptä»£ç é‡ã€‚</p><p>ESM (ES Modules) æ˜¯ä¸€ç§ECMAScriptè§„èŒƒï¼Œç”¨äºç»„ç»‡å’ŒåŠ è½½JavaScriptæ¨¡å—ã€‚ESMä¸­å®šä¹‰äº†â€œé™æ€è§£æâ€è§„åˆ™ï¼Œå³åœ¨ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼Œè€Œä¸”è¿™äº›ä¾èµ–å…³ç³»ä¸ä¼šåœ¨è¿è¡Œæ—¶æ”¹å˜ã€‚è¿™ä½¿å¾—ESMå¯ä»¥åœ¨ç¼–è¯‘æ—¶å¯¹æ¨¡å—è¿›è¡Œé™æ€åˆ†æï¼Œæ‰¾å‡ºæœªè¢«ä½¿ç”¨çš„ä»£ç ï¼Œå¹¶å°†å…¶å‰”é™¤æ‰ã€‚</p><p>å› æ­¤ï¼ŒJavaScript Tree-Shakingå¼ºä¾èµ–äºESMæ¨¡å—æ–¹æ¡ˆï¼Œæ˜¯å› ä¸ºåªæœ‰ ESM æ‰èƒ½æä¾›é™æ€è§£æçš„ç‰¹æ€§ï¼Œæ‰èƒ½è®© Tree-Shaking èƒ½å¤Ÿæ­£ç¡®åœ°æ‰¾å‡ºæœªè¢«ä½¿ç”¨çš„ä»£ç å¹¶æ¶ˆé™¤å®ƒä»¬ã€‚è€Œ CommonJS å’Œ AMD ç­‰æ¨¡å—æ–¹æ¡ˆåˆ™æ— æ³•æä¾›è¿™æ ·çš„ç‰¹æ€§ï¼Œå› ä¸ºå®ƒä»¬å…è®¸åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ¨¡å—ï¼Œå¯¼è‡´æ— æ³•åœ¨ç¼–è¯‘æ—¶ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä¹Ÿå°±éš¾ä»¥è¿›è¡Œé™æ€åˆ†æå’Œ Tree-Shakingã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶éæ‰€æœ‰çš„ ESM å®ç°éƒ½èƒ½æ”¯æŒ Tree-Shakingã€‚ä¾‹å¦‚ï¼Œåœ¨ TypeScript ä¸­ä½¿ç”¨ ESM æ—¶ï¼Œå°±éœ€è¦å¼€å¯ &quot;module&quot;: &quot;esnext&quot; é€‰é¡¹ï¼Œä»¥ç¡®ä¿ç¼–è¯‘å™¨èƒ½å¤Ÿæ­£ç¡®åœ°è¿›è¡Œé™æ€åˆ†æå’Œ Tree-ShakingğŸ’¡ã€‚</p><blockquote><p>2ï¸âƒ£ESM ä¸å…¶å®ƒæ–¹æ¡ˆå¦‚ AMDã€CMD ç­‰ï¼Œæœ‰ä½•åŒºåˆ«ï¼Ÿ</p></blockquote><p>ESM (ES Modules)ã€AMDï¼ˆAsynchronous Module Definitionï¼‰å’Œ CMD ï¼ˆCommon Module Definitionï¼‰éƒ½æ˜¯ç”¨äºç»„ç»‡å’ŒåŠ è½½JavaScriptæ¨¡å—çš„æ–¹æ¡ˆã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¸»è¦åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol><li>è¯­æ³•</li></ol><p>ESM çš„è¯­æ³•ä½¿ç”¨ <code>import</code> å’Œ <code>export</code> å…³é”®å­—æ¥å®šä¹‰æ¨¡å—ï¼Œè€Œ AMD å’Œ CMD åˆ™åˆ†åˆ«ä½¿ç”¨ <code>define</code> å’Œ <code>require</code> å‡½æ•°æ¥å®šä¹‰æ¨¡å—å’ŒåŠ è½½æ¨¡å—ã€‚</p><ol start="2"><li>ä¾èµ–å…³ç³»</li></ol><p>ESM å®šä¹‰çš„ä¾èµ–å…³ç³»æ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼Œè€Œä¸”è¿™äº›ä¾èµ–å…³ç³»ä¸ä¼šåœ¨è¿è¡Œæ—¶æ”¹å˜ã€‚è€Œ AMD å’Œ CMD åˆ™å…è®¸åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ¨¡å—ï¼Œå¯¼è‡´æ— æ³•åœ¨ç¼–è¯‘æ—¶ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ã€‚</p><ol start="3"><li>åŠ è½½æ–¹å¼</li></ol><p>ESM çš„åŠ è½½æ–¹å¼æ˜¯åŒæ­¥çš„ï¼Œå³é‡åˆ° <code>import</code> è¯­å¥æ—¶ä¼šç«‹å³åŠ è½½ä¾èµ–çš„æ¨¡å—ï¼Œè€Œ AMD å’Œ CMD åˆ™æ˜¯å¼‚æ­¥åŠ è½½æ¨¡å—ã€‚</p><ol start="4"><li>å…¼å®¹æ€§</li></ol><p>ESM æ˜¯ ECMAScript è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ç°ä»£æµè§ˆå™¨ä¸­å¾—åˆ°äº†å¹¿æ³›æ”¯æŒã€‚è€Œ AMD å’Œ CMD åˆ™éœ€è¦é€šè¿‡åº“æˆ–æ¡†æ¶çš„æ”¯æŒæ‰èƒ½è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒESM ç›¸æ¯”äº AMD å’Œ CMDï¼Œå…·æœ‰æ›´ä¸ºç®€æ´çš„è¯­æ³•ã€æ›´ä¸ºæ˜ç¡®çš„ä¾èµ–å…³ç³»å’Œæ›´ä¸ºé«˜æ•ˆçš„åŠ è½½æ–¹å¼ã€‚åŒæ—¶ï¼ŒESM è¿˜å¯ä»¥è¿›è¡Œé™æ€åˆ†æå’Œ Tree-Shaking ä¼˜åŒ–ï¼Œè¿™ä½¿å¾— ESM æˆä¸ºäº†ç›®å‰æœ€ä¸ºæµè¡Œçš„ JavaScript æ¨¡å—æ–¹æ¡ˆä¹‹ä¸€ã€‚</p></details><p>2023å¹´04æœˆ13æ—¥14:34:20</p>',117),A=[C];function d(u,h,m,g,b,f){return n(),a("div",null,A)}const v=s(i,[["render",d]]);export{k as __pageData,v as default};
